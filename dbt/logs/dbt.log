[0m00:00:26.141869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342aa263d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3429935a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34271c8c70>]}


============================== 00:00:26.168885 | f1525514-64b7-404a-8684-557e2afe88b4 ==============================
[0m00:00:26.168885 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:00:26.171237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:00:26.173480 [info ] [MainThread]: dbt version: 1.7.11
[0m00:00:26.176263 [info ] [MainThread]: python version: 3.9.18
[0m00:00:26.178716 [info ] [MainThread]: python path: /usr/local/bin/python
[0m00:00:26.181300 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m00:00:26.535933 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m00:00:26.538258 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m00:00:26.540786 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m00:00:26.937970 [info ] [MainThread]: Configuration:
[0m00:00:26.941049 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:00:26.944053 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:00:26.948062 [info ] [MainThread]: Required dependencies:
[0m00:00:26.951711 [debug] [MainThread]: Executing "git --help"
[0m00:00:27.041129 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:00:27.046002 [debug] [MainThread]: STDERR: "b''"
[0m00:00:27.048798 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:00:27.052515 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:00:27.057018 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:00:27.061187 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "bitcoin_etl", target "dev" invalid: Runtime Error
        schema: default 
        database: bitcoin 
        cluster: None 
    On Clickhouse, database must be omitted or have the same value as schema.


[0m00:00:27.067961 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.100752, "process_user_time": 14.373313, "process_kernel_time": 0.500463, "process_mem_max_rss": "101324", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m00:00:27.074326 [debug] [MainThread]: Command `dbt debug` failed at 00:00:27.071966 after 1.11 seconds
[0m00:00:27.079339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342aa263d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34270c29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34270d9be0>]}
[0m00:00:27.082925 [debug] [MainThread]: Flushing usage events
[0m00:03:01.088799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dedddc790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9debb779d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9debb77820>]}


============================== 00:03:01.114130 | e63c24e1-a890-41d2-9a9e-5243b9446767 ==============================
[0m00:03:01.114130 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:03:01.117180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m00:03:01.120062 [info ] [MainThread]: dbt version: 1.7.11
[0m00:03:01.122080 [info ] [MainThread]: python version: 3.9.18
[0m00:03:01.124950 [info ] [MainThread]: python path: /usr/local/bin/python
[0m00:03:01.127580 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m00:03:01.676569 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m00:03:01.679641 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m00:03:01.683781 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m00:03:01.691664 [info ] [MainThread]: adapter type: clickhouse
[0m00:03:01.694906 [info ] [MainThread]: adapter version: 1.7.0
[0m00:03:02.127071 [info ] [MainThread]: Configuration:
[0m00:03:02.130873 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:03:02.134807 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:03:02.140198 [info ] [MainThread]: Required dependencies:
[0m00:03:02.143858 [debug] [MainThread]: Executing "git --help"
[0m00:03:02.170967 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:03:02.176220 [debug] [MainThread]: STDERR: "b''"
[0m00:03:02.179263 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:03:02.185173 [info ] [MainThread]: Connection:
[0m00:03:02.190200 [info ] [MainThread]:   driver: None
[0m00:03:02.193655 [info ] [MainThread]:   host: clickhouse
[0m00:03:02.203702 [info ] [MainThread]:   port: 8123
[0m00:03:02.208681 [info ] [MainThread]:   user: admin
[0m00:03:02.212034 [info ] [MainThread]:   schema: bitcoin
[0m00:03:02.216291 [info ] [MainThread]:   retries: 1
[0m00:03:02.223387 [info ] [MainThread]:   database_engine: None
[0m00:03:02.232098 [info ] [MainThread]:   cluster_mode: False
[0m00:03:02.238077 [info ] [MainThread]:   secure: False
[0m00:03:02.244208 [info ] [MainThread]:   verify: True
[0m00:03:02.249481 [info ] [MainThread]:   connect_timeout: 10
[0m00:03:02.256566 [info ] [MainThread]:   send_receive_timeout: 300
[0m00:03:02.260312 [info ] [MainThread]:   sync_request_timeout: 5
[0m00:03:02.264681 [info ] [MainThread]:   compress_block_size: 1048576
[0m00:03:02.269114 [info ] [MainThread]:   compression: 
[0m00:03:02.272438 [info ] [MainThread]:   check_exchange: True
[0m00:03:02.278195 [info ] [MainThread]:   custom_settings: None
[0m00:03:02.281297 [info ] [MainThread]:   use_lw_deletes: False
[0m00:03:02.286904 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m00:03:02.293186 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m00:03:02.303194 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m00:03:02.306933 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:05.230614 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m00:03:05.243854 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:03:05.249581 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:03:05.254332 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:03:05.262514 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.4283714, "process_user_time": 15.190731, "process_kernel_time": 1.696862, "process_mem_max_rss": "190612", "process_in_blocks": "120", "process_out_blocks": "24"}
[0m00:03:05.267318 [debug] [MainThread]: Command `dbt debug` succeeded at 00:03:05.266079 after 4.43 seconds
[0m00:03:05.270899 [debug] [MainThread]: Connection 'debug' was left open.
[0m00:03:05.275465 [debug] [MainThread]: On debug: Close
[0m00:03:05.280445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dedddc790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9debb72a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9debad5a30>]}
[0m00:03:05.284741 [debug] [MainThread]: Flushing usage events
[0m00:06:02.867024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a7f50790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a8446a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a5d62fa0>]}


============================== 00:06:02.886658 | 24c3a512-aa26-4f2c-a06a-d404d38f28a9 ==============================
[0m00:06:02.886658 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:06:02.888820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:06:04.052088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24c3a512-aa26-4f2c-a06a-d404d38f28a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a8446a60>]}
[0m00:06:04.467748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24c3a512-aa26-4f2c-a06a-d404d38f28a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a5b45670>]}
[0m00:06:04.470801 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m00:06:04.515288 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:06:04.518213 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:06:04.520125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24c3a512-aa26-4f2c-a06a-d404d38f28a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a5b56130>]}
[0m00:06:09.011010 [error] [MainThread]: Encountered an error:
Compilation Error in model example (models/bitcoin/example.sql)
  expected token ',', got '='
    line 4
      --     materialized='view'  # Lightweight test
[0m00:06:09.016338 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.3285494, "process_user_time": 15.684295, "process_kernel_time": 0.718821, "process_mem_max_rss": "110196", "process_in_blocks": "640", "process_out_blocks": "16", "command_success": false}
[0m00:06:09.021519 [debug] [MainThread]: Command `dbt run` failed at 00:06:09.019472 after 6.33 seconds
[0m00:06:09.025235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a7f50790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a41c6f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93a41c6fa0>]}
[0m00:06:09.028435 [debug] [MainThread]: Flushing usage events
[0m00:12:17.839742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7121845790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7121d3ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711f656fa0>]}


============================== 00:12:17.863929 | bf44ded3-a1d1-456d-9f3a-6d4bcda75999 ==============================
[0m00:12:17.863929 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:12:17.867111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:12:18.751722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf44ded3-a1d1-456d-9f3a-6d4bcda75999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7121d3ca60>]}
[0m00:12:19.099402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf44ded3-a1d1-456d-9f3a-6d4bcda75999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711f439670>]}
[0m00:12:19.101849 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m00:12:19.134941 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:12:19.137249 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:12:19.139200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf44ded3-a1d1-456d-9f3a-6d4bcda75999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711f448130>]}
[0m00:12:24.133705 [error] [MainThread]: Encountered an error:
Compilation Error in model example (models/bitcoin/example.sql)
  unexpected char '#' at 38
    line 3
      materialized='view'  # or 'ephemeral' for lightweight testing
[0m00:12:24.137395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.5333266, "process_user_time": 15.067353, "process_kernel_time": 0.400195, "process_mem_max_rss": "108008", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m00:12:24.139598 [debug] [MainThread]: Command `dbt run` failed at 00:12:24.139064 after 6.54 seconds
[0m00:12:24.141343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7121845790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711d8b9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711d8c1070>]}
[0m00:12:24.143128 [debug] [MainThread]: Flushing usage events
[0m00:14:02.498972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c74f40370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c75409a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c72d07c10>]}


============================== 00:14:02.524640 | 46defba1-5319-44b9-afd6-8a2e92452351 ==============================
[0m00:14:02.524640 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:14:02.527256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:14:03.520981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46defba1-5319-44b9-afd6-8a2e92452351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c75409a90>]}
[0m00:14:04.047342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46defba1-5319-44b9-afd6-8a2e92452351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c729e8040>]}
[0m00:14:04.050480 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m00:14:04.095767 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:14:04.099150 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:14:04.101777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '46defba1-5319-44b9-afd6-8a2e92452351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c72a46760>]}
[0m00:14:10.709445 [error] [MainThread]: Encountered an error:
Compilation Error in model example (models/bitcoin/example.sql)
  unexpected '*'
    line 3
      materialized='view'  /* Use 'view' or 'ephemeral' */
[0m00:14:10.712299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.437357, "process_user_time": 20.427628, "process_kernel_time": 0.579932, "process_mem_max_rss": "108124", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m00:14:10.714378 [debug] [MainThread]: Command `dbt run` failed at 00:14:10.713859 after 8.44 seconds
[0m00:14:10.716064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c74f40370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c70f6bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c70f710a0>]}
[0m00:14:10.717906 [debug] [MainThread]: Flushing usage events
[0m00:16:01.080898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f058c06b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f058c530a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0589e2ec10>]}


============================== 00:16:01.113733 | d35390e6-7974-4c47-a860-71e9ec5f2e00 ==============================
[0m00:16:01.113733 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:16:01.117641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:16:02.353320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd35390e6-7974-4c47-a860-71e9ec5f2e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f058c530a90>]}
[0m00:16:02.775641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd35390e6-7974-4c47-a860-71e9ec5f2e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0589b0f040>]}
[0m00:16:02.778316 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m00:16:02.810322 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:16:02.813322 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:16:02.816029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd35390e6-7974-4c47-a860-71e9ec5f2e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0589b6e760>]}
[0m00:16:10.860944 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bitcoin_etl.raw_transactions' (models/bitcoin/raw_transactions.sql) depends on a source named 'raw.transactions' which was not found
[0m00:16:10.864700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.086013, "process_user_time": 22.20938, "process_kernel_time": 0.479986, "process_mem_max_rss": "111180", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m00:16:10.867276 [debug] [MainThread]: Command `dbt run` failed at 00:16:10.866706 after 10.09 seconds
[0m00:16:10.869156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f058c06b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0589c92b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05880894f0>]}
[0m00:16:10.871096 [debug] [MainThread]: Flushing usage events
[0m00:22:21.064273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8632462790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8632958a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8630274fa0>]}


============================== 00:22:21.105391 | 956faaa7-8af6-477b-9d8d-8ebc82ed3c86 ==============================
[0m00:22:21.105391 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:22:21.108826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:22:22.393338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '956faaa7-8af6-477b-9d8d-8ebc82ed3c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8632958a60>]}
[0m00:22:22.911337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '956faaa7-8af6-477b-9d8d-8ebc82ed3c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8630055670>]}
[0m00:22:22.915348 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m00:22:22.982054 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:22:22.986300 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:22:22.989752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '956faaa7-8af6-477b-9d8d-8ebc82ed3c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8630066130>]}
[0m00:22:33.364029 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bitcoin_etl.example' (models/bitcoin/example.sql) depends on a source named 'bitcoin.swaps_latest' which was not found
[0m00:22:33.369277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.626376, "process_user_time": 27.385876, "process_kernel_time": 0.630595, "process_mem_max_rss": "111980", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m00:22:33.374171 [debug] [MainThread]: Command `dbt run` failed at 00:22:33.372925 after 12.63 seconds
[0m00:22:33.377973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8632462790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862e48c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862e4742e0>]}
[0m00:22:33.382492 [debug] [MainThread]: Flushing usage events
[0m00:24:30.565961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f151c396370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f151c890a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f151a18fc10>]}


============================== 00:24:30.590749 | 9f18c71d-cb31-4dc1-a6ed-524c9498318a ==============================
[0m00:24:30.590749 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:24:30.593399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:24:32.091603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f18c71d-cb31-4dc1-a6ed-524c9498318a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f151c890a90>]}
[0m00:24:32.927843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f18c71d-cb31-4dc1-a6ed-524c9498318a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1519e70040>]}
[0m00:24:32.931553 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m00:24:32.993823 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:24:32.998539 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:24:33.001432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f18c71d-cb31-4dc1-a6ed-524c9498318a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1519ecf760>]}
[0m00:24:41.547491 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bitcoin_etl.example' (models/bitcoin/example.sql) depends on a source named 'bitcoin.swaps_latest' which was not found
[0m00:24:41.551404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.203106, "process_user_time": 21.953972, "process_kernel_time": 0.429881, "process_mem_max_rss": "111800", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m00:24:41.553861 [debug] [MainThread]: Command `dbt run` failed at 00:24:41.553239 after 11.21 seconds
[0m00:24:41.555717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f151c396370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15183b7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1518383250>]}
[0m00:24:41.557599 [debug] [MainThread]: Flushing usage events
[0m00:26:46.083644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7dca30790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7dcf25a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7da826fa0>]}


============================== 00:26:46.113206 | 5ca81c76-fcab-481c-b46c-8c670a006c9e ==============================
[0m00:26:46.113206 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:26:46.116663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:26:47.256109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ca81c76-fcab-481c-b46c-8c670a006c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7dcf25a60>]}
[0m00:26:47.676868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ca81c76-fcab-481c-b46c-8c670a006c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7da609670>]}
[0m00:26:47.679380 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m00:26:47.716621 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:26:47.718763 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:26:47.721655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ca81c76-fcab-481c-b46c-8c670a006c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7da618130>]}
[0m00:26:56.480060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ca81c76-fcab-481c-b46c-8c670a006c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7da4b4370>]}
[0m00:26:56.540055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ca81c76-fcab-481c-b46c-8c670a006c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7da4b41f0>]}
[0m00:26:56.542174 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m00:26:56.544306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ca81c76-fcab-481c-b46c-8c670a006c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7da5c8b80>]}
[0m00:26:56.552022 [info ] [MainThread]: 
[0m00:26:56.557353 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m00:26:56.568431 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m00:26:56.622185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:58.138781 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m00:26:58.149573 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:26:58.166036 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m00:26:58.175486 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:26:58.182879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__bitcoin_default)
[0m00:26:58.187805 [debug] [ThreadPool]: Creating schema "schema: "bitcoin_default"
"
[0m00:26:58.225742 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "create__bitcoin_default"} */
create database if not exists `bitcoin_default`
        
  
        
  ...
[0m00:26:58.249988 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m00:26:58.261502 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__bitcoin_default'
[0m00:26:58.301633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:58.464275 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m00:26:58.583061 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.12 seconds
[0m00:26:58.590909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_default, now list__bitcoin)
[0m00:26:58.605672 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m00:26:58.656740 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m00:26:58.684827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ca81c76-fcab-481c-b46c-8c670a006c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d882c670>]}
[0m00:26:58.691022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:26:58.694297 [info ] [MainThread]: 
[0m00:26:58.734751 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.example
[0m00:26:58.739794 [info ] [Thread-1  ]: 1 of 4 START sql view model `bitcoin`.`example` ................................ [RUN]
[0m00:26:58.746099 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin, now model.bitcoin_etl.example)
[0m00:26:58.754803 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.example
[0m00:26:58.851404 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.example"
[0m00:26:58.863676 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.example (compile): 00:26:58.758075 => 00:26:58.861247
[0m00:26:58.867942 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.example
[0m00:26:59.077087 [debug] [Thread-1  ]: Creating new relation example
[0m00:26:59.136887 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.example"
[0m00:26:59.148290 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.example: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.example"} */


  create view `bitcoin`.`example` 
  
    
    
  as (
    

SELECT 
    tx_hash,
    block_number,
    from_address,
    to_address,
    amount_usd as value,
    block_timestamp as timestamp
FROM `bitcoin`.`swaps_latest`
  )...
[0m00:26:59.181943 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.example"} */


  create view `bitcoin`.`example` 
  
    
    
  as (
    

SELECT 
    tx_hash,
    block_number,
    from_address,
    to_address,
    amount_usd as value,
    block_timestamp as timestamp
FROM `bitcoin`.`swaps_latest`
  )
[0m00:26:59.185866 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.example (execute): 00:26:58.870963 => 00:26:59.184075
[0m00:26:59.240417 [debug] [Thread-1  ]: Database Error in model example (models/bitcoin/example.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Unknown expression identifier `tx_hash` in scope SELECT tx_hash, block_number, from_address, to_address, amount_usd AS value, block_timestamp AS timestamp FROM bitcoin.swaps_latest. (UNKNOWN_IDENTIFIER) (version 25.3.2.39 (official build))
  compiled Code at target/run/bitcoin_etl/models/bitcoin/example.sql
[0m00:26:59.244975 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ca81c76-fcab-481c-b46c-8c670a006c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77d7313a0>]}
[0m00:26:59.250004 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model `bitcoin`.`example` ....................... [[31mERROR[0m in 0.50s]
[0m00:26:59.256979 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.example
[0m00:26:59.260434 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.raw_transactions
[0m00:26:59.265859 [info ] [Thread-1  ]: 2 of 4 START sql view model `bitcoin`.`raw_transactions` ....................... [RUN]
[0m00:26:59.272072 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.example, now model.bitcoin_etl.raw_transactions)
[0m00:26:59.276224 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.raw_transactions
[0m00:26:59.300306 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.raw_transactions"
[0m00:26:59.306046 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.raw_transactions (compile): 00:26:59.278893 => 00:26:59.304060
[0m00:26:59.309823 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.raw_transactions
[0m00:26:59.330300 [debug] [Thread-1  ]: Creating new relation raw_transactions
[0m00:26:59.342629 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.raw_transactions"
[0m00:26:59.349773 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.raw_transactions: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.raw_transactions"} */


  create view `bitcoin`.`raw_transactions` 
  
    
    
  as (
    

-- Using existing swaps data as example
SELECT 
    tx_hash,
    block_number,
    from_address,
    to_address,
    amount_usd as value,
    block_timestamp as timestamp
FROM bitcoin.swaps_latest
LIMIT 1000
  )...
[0m00:26:59.370653 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.raw_transactions"} */


  create view `bitcoin`.`raw_transactions` 
  
    
    
  as (
    

-- Using existing swaps data as example
SELECT 
    tx_hash,
    block_number,
    from_address,
    to_address,
    amount_usd as value,
    block_timestamp as timestamp
FROM bitcoin.swaps_latest
LIMIT 1000
  )
[0m00:26:59.377623 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.raw_transactions (execute): 00:26:59.311883 => 00:26:59.375208
[0m00:26:59.386144 [debug] [Thread-1  ]: Database Error in model raw_transactions (models/bitcoin/raw_transactions.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Unknown expression identifier `tx_hash` in scope SELECT tx_hash, block_number, from_address, to_address, amount_usd AS value, block_timestamp AS timestamp FROM bitcoin.swaps_latest LIMIT 1000. (UNKNOWN_IDENTIFIER) (version 25.3.2.39 (official build))
  compiled Code at target/run/bitcoin_etl/models/bitcoin/raw_transactions.sql
[0m00:26:59.390437 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ca81c76-fcab-481c-b46c-8c670a006c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77c5f70a0>]}
[0m00:26:59.395508 [error] [Thread-1  ]: 2 of 4 ERROR creating sql view model `bitcoin`.`raw_transactions` .............. [[31mERROR[0m in 0.12s]
[0m00:26:59.401044 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.raw_transactions
[0m00:26:59.405048 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.test
[0m00:26:59.410294 [info ] [Thread-1  ]: 3 of 4 START sql view model `bitcoin`.`test` ................................... [RUN]
[0m00:26:59.415955 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.raw_transactions, now model.bitcoin_etl.test)
[0m00:26:59.420404 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.test
[0m00:26:59.436959 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.test"
[0m00:26:59.441757 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test (compile): 00:26:59.423554 => 00:26:59.439991
[0m00:26:59.444652 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.test
[0m00:26:59.459047 [debug] [Thread-1  ]: Creating new relation test
[0m00:26:59.466067 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.test"
[0m00:26:59.469368 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */


  create view `bitcoin`.`test` 
  
    
    
  as (
    SELECT 1 as test_value
  )...
[0m00:26:59.501191 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m00:26:59.630512 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test (execute): 00:26:59.446248 => 00:26:59.628861
[0m00:26:59.636250 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ca81c76-fcab-481c-b46c-8c670a006c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77c5a4d60>]}
[0m00:26:59.640912 [info ] [Thread-1  ]: 3 of 4 OK created sql view model `bitcoin`.`test` .............................. [[32mOK[0m in 0.22s]
[0m00:26:59.647565 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.test
[0m00:26:59.651911 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.test_connection
[0m00:26:59.656031 [info ] [Thread-1  ]: 4 of 4 START sql view model `bitcoin_default`.`test_connection` ................ [RUN]
[0m00:26:59.663540 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.test, now model.bitcoin_etl.test_connection)
[0m00:26:59.667660 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.test_connection
[0m00:26:59.687572 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.test_connection"
[0m00:26:59.694204 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test_connection (compile): 00:26:59.669800 => 00:26:59.690763
[0m00:26:59.698206 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.test_connection
[0m00:26:59.720368 [debug] [Thread-1  ]: Creating new relation test_connection
[0m00:26:59.731472 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.test_connection"
[0m00:26:59.738239 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */


  create view `bitcoin_default`.`test_connection` 
  
    
    
  as (
    -- models/test_connection.sql


SELECT 'swaps_latest' AS table_name, 
       count() AS row_count 
FROM bitcoin.swaps_latest
  )...
[0m00:26:59.774117 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m00:26:59.786088 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test_connection (execute): 00:26:59.700397 => 00:26:59.784243
[0m00:26:59.789757 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ca81c76-fcab-481c-b46c-8c670a006c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77c57c8e0>]}
[0m00:26:59.792684 [info ] [Thread-1  ]: 4 of 4 OK created sql view model `bitcoin_default`.`test_connection` ........... [[32mOK[0m in 0.13s]
[0m00:26:59.795973 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.test_connection
[0m00:26:59.806384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:26:59.809611 [debug] [MainThread]: Connection 'create__bitcoin_default' was left open.
[0m00:26:59.812723 [debug] [MainThread]: On create__bitcoin_default: Close
[0m00:26:59.816472 [debug] [MainThread]: Connection 'model.bitcoin_etl.test_connection' was left open.
[0m00:26:59.819587 [debug] [MainThread]: On model.bitcoin_etl.test_connection: Close
[0m00:26:59.823602 [info ] [MainThread]: 
[0m00:26:59.827372 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m00:26:59.839270 [debug] [MainThread]: Command end result
[0m00:26:59.895520 [info ] [MainThread]: 
[0m00:26:59.898853 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:26:59.903601 [info ] [MainThread]: 
[0m00:26:59.908219 [error] [MainThread]:   Database Error in model example (models/bitcoin/example.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Unknown expression identifier `tx_hash` in scope SELECT tx_hash, block_number, from_address, to_address, amount_usd AS value, block_timestamp AS timestamp FROM bitcoin.swaps_latest. (UNKNOWN_IDENTIFIER) (version 25.3.2.39 (official build))
  compiled Code at target/run/bitcoin_etl/models/bitcoin/example.sql
[0m00:26:59.912043 [info ] [MainThread]: 
[0m00:26:59.915353 [error] [MainThread]:   Database Error in model raw_transactions (models/bitcoin/raw_transactions.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Unknown expression identifier `tx_hash` in scope SELECT tx_hash, block_number, from_address, to_address, amount_usd AS value, block_timestamp AS timestamp FROM bitcoin.swaps_latest LIMIT 1000. (UNKNOWN_IDENTIFIER) (version 25.3.2.39 (official build))
  compiled Code at target/run/bitcoin_etl/models/bitcoin/raw_transactions.sql
[0m00:26:59.919309 [info ] [MainThread]: 
[0m00:26:59.926384 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m00:26:59.931556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.078656, "process_user_time": 27.55458, "process_kernel_time": 1.623215, "process_mem_max_rss": "216816", "process_in_blocks": "968", "process_out_blocks": "2736", "command_success": false}
[0m00:26:59.935528 [debug] [MainThread]: Command `dbt run` failed at 00:26:59.934681 after 14.08 seconds
[0m00:26:59.938913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7dca30790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d882c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7dcf25a60>]}
[0m00:26:59.942729 [debug] [MainThread]: Flushing usage events
[0m00:30:00.268001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc789b7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78eafa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc767b0130>]}


============================== 00:30:00.307011 | 647e0d83-990b-42b3-91bf-4f8cf4016092 ==============================
[0m00:30:00.307011 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:30:00.311754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:30:02.143652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '647e0d83-990b-42b3-91bf-4f8cf4016092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78eafa00>]}
[0m00:30:02.795103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '647e0d83-990b-42b3-91bf-4f8cf4016092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc764e8610>]}
[0m00:30:02.799570 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m00:30:02.859505 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:30:03.033313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:30:03.038316 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/raw_transactions.sql
[0m00:30:03.042673 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/example.sql
[0m00:30:04.837607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '647e0d83-990b-42b3-91bf-4f8cf4016092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc747850d0>]}
[0m00:30:04.904055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '647e0d83-990b-42b3-91bf-4f8cf4016092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc764d58e0>]}
[0m00:30:04.907358 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m00:30:04.910705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '647e0d83-990b-42b3-91bf-4f8cf4016092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc76312af0>]}
[0m00:30:04.917593 [info ] [MainThread]: 
[0m00:30:04.923086 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m00:30:04.934727 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m00:30:04.991404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:06.414358 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m00:30:06.423480 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:30:06.439063 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m00:30:06.447937 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:30:06.456529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__bitcoin)
[0m00:30:06.480209 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m00:30:06.514608 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m00:30:06.522695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin, now list__bitcoin_default)
[0m00:30:06.542286 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m00:30:06.570926 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m00:30:06.577944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '647e0d83-990b-42b3-91bf-4f8cf4016092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc76493dc0>]}
[0m00:30:06.580854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:30:06.582462 [info ] [MainThread]: 
[0m00:30:06.605488 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.example
[0m00:30:06.608811 [info ] [Thread-1  ]: 1 of 4 START sql view model `bitcoin`.`example` ................................ [RUN]
[0m00:30:06.611668 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin_default, now model.bitcoin_etl.example)
[0m00:30:06.613347 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.example
[0m00:30:06.650607 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.example"
[0m00:30:06.653695 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.example (compile): 00:30:06.614794 => 00:30:06.652524
[0m00:30:06.655918 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.example
[0m00:30:06.746903 [debug] [Thread-1  ]: Creating new relation example
[0m00:30:06.781521 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.example"
[0m00:30:06.784005 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.example: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.example"} */


  create view `bitcoin`.`example` 
  
    
    
  as (
    

SELECT 
    transaction_id AS tx_hash,
    transaction_timestamp AS timestamp,
    pair_token0_symbol,
    pair_token1_symbol,
    amount_u_s_d AS value_usd,
    amount0_in,
    amount1_in,
    amount0_out,
    amount1_out
FROM `bitcoin`.`swaps_latest`
  )...
[0m00:30:06.804372 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m00:30:06.886830 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.example (execute): 00:30:06.657455 => 00:30:06.886010
[0m00:30:06.889926 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647e0d83-990b-42b3-91bf-4f8cf4016092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc19642bb0>]}
[0m00:30:06.892537 [info ] [Thread-1  ]: 1 of 4 OK created sql view model `bitcoin`.`example` ........................... [[32mOK[0m in 0.28s]
[0m00:30:06.895901 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.example
[0m00:30:06.899211 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.raw_transactions
[0m00:30:06.903138 [info ] [Thread-1  ]: 2 of 4 START sql view model `bitcoin`.`raw_transactions` ....................... [RUN]
[0m00:30:06.908796 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.example, now model.bitcoin_etl.raw_transactions)
[0m00:30:06.912175 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.raw_transactions
[0m00:30:06.932861 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.raw_transactions"
[0m00:30:06.940626 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.raw_transactions (compile): 00:30:06.914722 => 00:30:06.937461
[0m00:30:06.944625 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.raw_transactions
[0m00:30:06.965450 [debug] [Thread-1  ]: Creating new relation raw_transactions
[0m00:30:06.975175 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.raw_transactions"
[0m00:30:06.980514 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.raw_transactions: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.raw_transactions"} */


  create view `bitcoin`.`raw_transactions` 
  
    
    
  as (
    

SELECT 
    transaction_id AS tx_hash,
    transaction_timestamp AS timestamp,
    amount_u_s_d AS value_usd,
    pair_token0_symbol || '/' || pair_token1_symbol AS trading_pair
FROM `bitcoin`.`swaps_latest`
LIMIT 1000
  )...
[0m00:30:07.008959 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m00:30:07.024764 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.raw_transactions (execute): 00:30:06.947022 => 00:30:07.022905
[0m00:30:07.028919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647e0d83-990b-42b3-91bf-4f8cf4016092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc19652310>]}
[0m00:30:07.031556 [info ] [Thread-1  ]: 2 of 4 OK created sql view model `bitcoin`.`raw_transactions` .................. [[32mOK[0m in 0.12s]
[0m00:30:07.034948 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.raw_transactions
[0m00:30:07.037918 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.test
[0m00:30:07.041980 [info ] [Thread-1  ]: 3 of 4 START sql view model `bitcoin`.`test` ................................... [RUN]
[0m00:30:07.047888 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.raw_transactions, now model.bitcoin_etl.test)
[0m00:30:07.052535 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.test
[0m00:30:07.068104 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.test"
[0m00:30:07.075351 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test (compile): 00:30:07.057820 => 00:30:07.073495
[0m00:30:07.078813 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.test
[0m00:30:07.168819 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.test"
[0m00:30:07.172832 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */


  create view `bitcoin`.`test__dbt_tmp` 
  
    
    
  as (
    SELECT 1 as test_value
  )...
[0m00:30:07.194215 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m00:30:07.244371 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */

    drop table if exists `bitcoin`.`test__dbt_backup` 
  
  ...
[0m00:30:07.253420 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:30:07.259404 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */

    rename table `bitcoin`.`test` to `bitcoin`.`test__dbt_backup` 
  
  ...
[0m00:30:07.273482 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:30:07.296235 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */

    drop table if exists `bitcoin`.`test` 
  
  ...
[0m00:30:07.310547 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:30:07.322487 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */

    rename table `bitcoin`.`test__dbt_tmp` to `bitcoin`.`test` 
  
  ...
[0m00:30:07.336051 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:30:07.395515 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */

    drop table if exists `bitcoin`.`test__dbt_backup` 
  ...
[0m00:30:07.404868 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:30:07.416336 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test (execute): 00:30:07.081112 => 00:30:07.415048
[0m00:30:07.419813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647e0d83-990b-42b3-91bf-4f8cf4016092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1962c070>]}
[0m00:30:07.424123 [info ] [Thread-1  ]: 3 of 4 OK created sql view model `bitcoin`.`test` .............................. [[32mOK[0m in 0.37s]
[0m00:30:07.429785 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.test
[0m00:30:07.434875 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.test_connection
[0m00:30:07.442694 [info ] [Thread-1  ]: 4 of 4 START sql view model `bitcoin_default`.`test_connection` ................ [RUN]
[0m00:30:07.450941 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.test, now model.bitcoin_etl.test_connection)
[0m00:30:07.454438 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.test_connection
[0m00:30:07.478983 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.test_connection"
[0m00:30:07.485170 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test_connection (compile): 00:30:07.456665 => 00:30:07.482839
[0m00:30:07.487948 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.test_connection
[0m00:30:07.523887 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.test_connection"
[0m00:30:07.528770 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */


  create view `bitcoin_default`.`test_connection__dbt_tmp` 
  
    
    
  as (
    -- models/test_connection.sql


SELECT 'swaps_latest' AS table_name, 
       count() AS row_count 
FROM bitcoin.swaps_latest
  )...
[0m00:30:07.552236 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m00:30:07.572379 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */

    drop table if exists `bitcoin_default`.`test_connection__dbt_backup` 
  
  ...
[0m00:30:07.581736 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:30:07.593406 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */

    rename table `bitcoin_default`.`test_connection` to `bitcoin_default`.`test_connection__dbt_backup` 
  
  ...
[0m00:30:07.605578 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:30:07.625899 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */

    drop table if exists `bitcoin_default`.`test_connection` 
  
  ...
[0m00:30:07.633509 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:30:07.639082 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */

    rename table `bitcoin_default`.`test_connection__dbt_tmp` to `bitcoin_default`.`test_connection` 
  
  ...
[0m00:30:07.647365 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:30:07.673091 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */

    drop table if exists `bitcoin_default`.`test_connection__dbt_backup` 
  ...
[0m00:30:07.682945 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:30:07.692242 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test_connection (execute): 00:30:07.490250 => 00:30:07.690744
[0m00:30:07.697117 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647e0d83-990b-42b3-91bf-4f8cf4016092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc19627cd0>]}
[0m00:30:07.701192 [info ] [Thread-1  ]: 4 of 4 OK created sql view model `bitcoin_default`.`test_connection` ........... [[32mOK[0m in 0.25s]
[0m00:30:07.705605 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.test_connection
[0m00:30:07.714464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:07.716634 [debug] [MainThread]: Connection 'model.bitcoin_etl.test_connection' was left open.
[0m00:30:07.719024 [debug] [MainThread]: On model.bitcoin_etl.test_connection: Close
[0m00:30:07.721412 [info ] [MainThread]: 
[0m00:30:07.725004 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m00:30:07.734831 [debug] [MainThread]: Command end result
[0m00:30:07.780270 [info ] [MainThread]: 
[0m00:30:07.783224 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:30:07.786672 [info ] [MainThread]: 
[0m00:30:07.792323 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:30:07.797706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8063073, "process_user_time": 19.71582, "process_kernel_time": 1.317715, "process_mem_max_rss": "224144", "process_out_blocks": "2736", "process_in_blocks": "0"}
[0m00:30:07.802423 [debug] [MainThread]: Command `dbt run` succeeded at 00:30:07.800813 after 7.81 seconds
[0m00:30:07.806167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc789b7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7651e550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc764d58e0>]}
[0m00:30:07.809708 [debug] [MainThread]: Flushing usage events
[0m00:59:52.636415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb943d26250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb942ab1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb942e31970>]}


============================== 00:59:52.725805 | 77b37039-39fa-404d-a970-3e6c74ca5936 ==============================
[0m00:59:52.725805 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:59:52.729165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:59:52.732139 [info ] [MainThread]: dbt version: 1.7.11
[0m00:59:52.733538 [info ] [MainThread]: python version: 3.9.18
[0m00:59:52.734969 [info ] [MainThread]: python path: /usr/local/bin/python
[0m00:59:52.736460 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m00:59:53.097594 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m00:59:53.099122 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m00:59:53.100488 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m00:59:53.102761 [info ] [MainThread]: adapter type: clickhouse
[0m00:59:53.105020 [info ] [MainThread]: adapter version: 1.7.0
[0m00:59:53.383994 [info ] [MainThread]: Configuration:
[0m00:59:53.385723 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:59:53.387089 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:59:53.388549 [info ] [MainThread]: Required dependencies:
[0m00:59:53.389913 [debug] [MainThread]: Executing "git --help"
[0m00:59:53.411724 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:59:53.414516 [debug] [MainThread]: STDERR: "b''"
[0m00:59:53.415931 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:59:53.417390 [info ] [MainThread]: Connection:
[0m00:59:53.418927 [info ] [MainThread]:   driver: None
[0m00:59:53.420243 [info ] [MainThread]:   host: clickhouse
[0m00:59:53.421553 [info ] [MainThread]:   port: 8123
[0m00:59:53.422815 [info ] [MainThread]:   user: admin
[0m00:59:53.424109 [info ] [MainThread]:   schema: bitcoin
[0m00:59:53.425431 [info ] [MainThread]:   retries: 1
[0m00:59:53.426649 [info ] [MainThread]:   database_engine: None
[0m00:59:53.427871 [info ] [MainThread]:   cluster_mode: False
[0m00:59:53.429463 [info ] [MainThread]:   secure: False
[0m00:59:53.430783 [info ] [MainThread]:   verify: True
[0m00:59:53.432118 [info ] [MainThread]:   connect_timeout: 10
[0m00:59:53.433377 [info ] [MainThread]:   send_receive_timeout: 300
[0m00:59:53.434677 [info ] [MainThread]:   sync_request_timeout: 5
[0m00:59:53.436051 [info ] [MainThread]:   compress_block_size: 1048576
[0m00:59:53.437355 [info ] [MainThread]:   compression: 
[0m00:59:53.438618 [info ] [MainThread]:   check_exchange: True
[0m00:59:53.439833 [info ] [MainThread]:   custom_settings: None
[0m00:59:53.441101 [info ] [MainThread]:   use_lw_deletes: False
[0m00:59:53.442423 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m00:59:53.444142 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m00:59:53.446530 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m00:59:53.447893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:59:54.685016 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m00:59:54.692147 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:59:54.695353 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:59:54.696877 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:59:54.699335 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.285067, "process_user_time": 11.901262, "process_kernel_time": 2.255793, "process_mem_max_rss": "214040", "process_out_blocks": "3096", "process_in_blocks": "0"}
[0m00:59:54.701205 [debug] [MainThread]: Command `dbt debug` succeeded at 00:59:54.700771 after 2.29 seconds
[0m00:59:54.702489 [debug] [MainThread]: Connection 'debug' was left open.
[0m00:59:54.703717 [debug] [MainThread]: On debug: Close
[0m00:59:54.705191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb943d26250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9417223a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9417b10d0>]}
[0m00:59:54.706562 [debug] [MainThread]: Flushing usage events
[0m01:00:05.773905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e4a540d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e4f56af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e27e7490>]}


============================== 01:00:05.796923 | 2b074d29-19b3-47c2-81c0-7aadf024ecfe ==============================
[0m01:00:05.796923 [info ] [MainThread]: Running with dbt=1.7.11
[0m01:00:05.799694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:00:06.787690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b074d29-19b3-47c2-81c0-7aadf024ecfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e2857e80>]}
[0m01:00:07.222352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b074d29-19b3-47c2-81c0-7aadf024ecfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e26d2490>]}
[0m01:00:07.226741 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m01:00:07.276945 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m01:00:07.621694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:07.624273 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:07.654871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b074d29-19b3-47c2-81c0-7aadf024ecfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e238e0d0>]}
[0m01:00:07.778237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b074d29-19b3-47c2-81c0-7aadf024ecfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e249fbb0>]}
[0m01:00:07.780468 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m01:00:07.783884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b074d29-19b3-47c2-81c0-7aadf024ecfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e249fca0>]}
[0m01:00:07.794212 [info ] [MainThread]: 
[0m01:00:07.797548 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m01:00:07.803963 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m01:00:07.849809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:09.535879 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m01:00:09.550531 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m01:00:09.568483 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m01:00:09.576203 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m01:00:09.584129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__bitcoin_default)
[0m01:00:09.587902 [debug] [ThreadPool]: Creating schema "schema: "bitcoin_default"
"
[0m01:00:09.622320 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "create__bitcoin_default"} */
create database if not exists `bitcoin_default`
        
  
        
  ...
[0m01:00:09.640180 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m01:00:09.650247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__bitcoin_default, now list__bitcoin_default)
[0m01:00:09.681136 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m01:00:09.726691 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m01:00:09.733931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_default, now list__bitcoin)
[0m01:00:09.745096 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m01:00:09.786416 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m01:00:09.805395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b074d29-19b3-47c2-81c0-7aadf024ecfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e25b7580>]}
[0m01:00:09.808429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:00:09.810026 [info ] [MainThread]: 
[0m01:00:09.828401 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.example
[0m01:00:09.830337 [info ] [Thread-1  ]: 1 of 4 START sql view model `bitcoin`.`example` ................................ [RUN]
[0m01:00:09.833361 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin, now model.bitcoin_etl.example)
[0m01:00:09.835256 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.example
[0m01:00:09.862114 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.example"
[0m01:00:09.864977 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.example (compile): 01:00:09.836221 => 01:00:09.863857
[0m01:00:09.866615 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.example
[0m01:00:09.953373 [debug] [Thread-1  ]: Creating new relation example
[0m01:00:09.981945 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.example"
[0m01:00:09.985127 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.example: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.example"} */


  create view `bitcoin`.`example` 
  
    
    
  as (
    

SELECT 
    transaction_id AS tx_hash,
    transaction_timestamp AS timestamp,
    pair_token0_symbol,
    pair_token1_symbol,
    amount_u_s_d AS value_usd,
    amount0_in,
    amount1_in,
    amount0_out,
    amount1_out
FROM `bitcoin`.`swaps_latest`
  )...
[0m01:00:10.008686 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m01:00:10.086143 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.example (execute): 01:00:09.867624 => 01:00:10.085204
[0m01:00:10.088792 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b074d29-19b3-47c2-81c0-7aadf024ecfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63b3193c40>]}
[0m01:00:10.091348 [info ] [Thread-1  ]: 1 of 4 OK created sql view model `bitcoin`.`example` ........................... [[32mOK[0m in 0.26s]
[0m01:00:10.093679 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.example
[0m01:00:10.095655 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.raw_transactions
[0m01:00:10.098458 [info ] [Thread-1  ]: 2 of 4 START sql view model `bitcoin`.`raw_transactions` ....................... [RUN]
[0m01:00:10.102716 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.example, now model.bitcoin_etl.raw_transactions)
[0m01:00:10.105392 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.raw_transactions
[0m01:00:10.122057 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.raw_transactions"
[0m01:00:10.125599 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.raw_transactions (compile): 01:00:10.107019 => 01:00:10.124636
[0m01:00:10.127362 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.raw_transactions
[0m01:00:10.136582 [debug] [Thread-1  ]: Creating new relation raw_transactions
[0m01:00:10.141981 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.raw_transactions"
[0m01:00:10.144327 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.raw_transactions: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.raw_transactions"} */


  create view `bitcoin`.`raw_transactions` 
  
    
    
  as (
    

SELECT 
    transaction_id AS tx_hash,
    transaction_timestamp AS timestamp,
    amount_u_s_d AS value_usd,
    pair_token0_symbol || '/' || pair_token1_symbol AS trading_pair
FROM `bitcoin`.`swaps_latest`
LIMIT 1000
  )...
[0m01:00:10.165841 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m01:00:10.179278 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.raw_transactions (execute): 01:00:10.128536 => 01:00:10.177733
[0m01:00:10.184045 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b074d29-19b3-47c2-81c0-7aadf024ecfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e25b7580>]}
[0m01:00:10.187313 [info ] [Thread-1  ]: 2 of 4 OK created sql view model `bitcoin`.`raw_transactions` .................. [[32mOK[0m in 0.08s]
[0m01:00:10.190738 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.raw_transactions
[0m01:00:10.193338 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.test
[0m01:00:10.196085 [info ] [Thread-1  ]: 3 of 4 START sql view model `bitcoin`.`test` ................................... [RUN]
[0m01:00:10.198857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.raw_transactions, now model.bitcoin_etl.test)
[0m01:00:10.201604 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.test
[0m01:00:10.209173 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.test"
[0m01:00:10.211532 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test (compile): 01:00:10.203332 => 01:00:10.210707
[0m01:00:10.213156 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.test
[0m01:00:10.230440 [debug] [Thread-1  ]: Creating new relation test
[0m01:00:10.235598 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.test"
[0m01:00:10.237857 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */


  create view `bitcoin`.`test` 
  
    
    
  as (
    SELECT 1 as test_value
  )...
[0m01:00:10.256961 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m01:00:10.271075 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test (execute): 01:00:10.214214 => 01:00:10.270021
[0m01:00:10.274762 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b074d29-19b3-47c2-81c0-7aadf024ecfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e275b220>]}
[0m01:00:10.278221 [info ] [Thread-1  ]: 3 of 4 OK created sql view model `bitcoin`.`test` .............................. [[32mOK[0m in 0.08s]
[0m01:00:10.282005 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.test
[0m01:00:10.284903 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.test_connection
[0m01:00:10.288325 [info ] [Thread-1  ]: 4 of 4 START sql view model `bitcoin_default`.`test_connection` ................ [RUN]
[0m01:00:10.291622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.test, now model.bitcoin_etl.test_connection)
[0m01:00:10.293506 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.test_connection
[0m01:00:10.306279 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.test_connection"
[0m01:00:10.310808 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test_connection (compile): 01:00:10.294712 => 01:00:10.309367
[0m01:00:10.313634 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.test_connection
[0m01:00:10.331226 [debug] [Thread-1  ]: Creating new relation test_connection
[0m01:00:10.339221 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.test_connection"
[0m01:00:10.344047 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */


  create view `bitcoin_default`.`test_connection` 
  
    
    
  as (
    -- models/test_connection.sql


SELECT 'swaps_latest' AS table_name, 
       count() AS row_count 
FROM bitcoin.swaps_latest
  )...
[0m01:00:10.370394 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m01:00:10.386188 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test_connection (execute): 01:00:10.315379 => 01:00:10.383806
[0m01:00:10.392184 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b074d29-19b3-47c2-81c0-7aadf024ecfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e2619040>]}
[0m01:00:10.402144 [info ] [Thread-1  ]: 4 of 4 OK created sql view model `bitcoin_default`.`test_connection` ........... [[32mOK[0m in 0.10s]
[0m01:00:10.406847 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.test_connection
[0m01:00:10.415136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:10.418070 [debug] [MainThread]: Connection 'model.bitcoin_etl.test_connection' was left open.
[0m01:00:10.423194 [debug] [MainThread]: On model.bitcoin_etl.test_connection: Close
[0m01:00:10.428563 [info ] [MainThread]: 
[0m01:00:10.432191 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m01:00:10.442481 [debug] [MainThread]: Command end result
[0m01:00:10.490407 [info ] [MainThread]: 
[0m01:00:10.492979 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:00:10.495936 [info ] [MainThread]: 
[0m01:00:10.498970 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:00:10.503169 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.9195137, "process_user_time": 13.423509, "process_kernel_time": 1.298972, "process_mem_max_rss": "214056", "process_out_blocks": "1872", "process_in_blocks": "0"}
[0m01:00:10.506183 [debug] [MainThread]: Command `dbt run` succeeded at 01:00:10.505598 after 4.92 seconds
[0m01:00:10.508069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e4a540d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e2284fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e26d2490>]}
[0m01:00:10.509931 [debug] [MainThread]: Flushing usage events
[0m10:34:21.934298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64bdfd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6499e01f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6499e0940>]}


============================== 10:34:21.983704 | 75b66e3f-94b6-431c-b35c-0adab05df43a ==============================
[0m10:34:21.983704 [info ] [MainThread]: Running with dbt=1.7.11
[0m10:34:21.985896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:34:21.988010 [info ] [MainThread]: dbt version: 1.7.11
[0m10:34:21.989517 [info ] [MainThread]: python version: 3.9.18
[0m10:34:21.990954 [info ] [MainThread]: python path: /usr/local/bin/python
[0m10:34:21.992465 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m10:34:22.378780 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m10:34:22.380477 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m10:34:22.381893 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m10:34:22.383791 [info ] [MainThread]: adapter type: clickhouse
[0m10:34:22.385250 [info ] [MainThread]: adapter version: 1.7.0
[0m10:34:22.648321 [info ] [MainThread]: Configuration:
[0m10:34:22.649979 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:34:22.651442 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:34:22.652840 [info ] [MainThread]: Required dependencies:
[0m10:34:22.654514 [debug] [MainThread]: Executing "git --help"
[0m10:34:22.722831 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:34:22.725648 [debug] [MainThread]: STDERR: "b''"
[0m10:34:22.727126 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:34:22.728921 [info ] [MainThread]: Connection:
[0m10:34:22.730687 [info ] [MainThread]:   driver: None
[0m10:34:22.732637 [info ] [MainThread]:   host: clickhouse
[0m10:34:22.734090 [info ] [MainThread]:   port: 8123
[0m10:34:22.735694 [info ] [MainThread]:   user: admin
[0m10:34:22.737160 [info ] [MainThread]:   schema: bitcoin
[0m10:34:22.738551 [info ] [MainThread]:   retries: 1
[0m10:34:22.739897 [info ] [MainThread]:   database_engine: None
[0m10:34:22.741306 [info ] [MainThread]:   cluster_mode: False
[0m10:34:22.742654 [info ] [MainThread]:   secure: False
[0m10:34:22.743981 [info ] [MainThread]:   verify: True
[0m10:34:22.745579 [info ] [MainThread]:   connect_timeout: 10
[0m10:34:22.747805 [info ] [MainThread]:   send_receive_timeout: 300
[0m10:34:22.749875 [info ] [MainThread]:   sync_request_timeout: 5
[0m10:34:22.751940 [info ] [MainThread]:   compress_block_size: 1048576
[0m10:34:22.753981 [info ] [MainThread]:   compression: 
[0m10:34:22.756075 [info ] [MainThread]:   check_exchange: True
[0m10:34:22.758086 [info ] [MainThread]:   custom_settings: None
[0m10:34:22.760130 [info ] [MainThread]:   use_lw_deletes: False
[0m10:34:22.762198 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m10:34:22.764368 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m10:34:22.767674 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m10:34:22.769197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:24.296157 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m10:34:24.305738 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:24.309617 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:34:24.311809 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:34:24.316315 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.626852, "process_user_time": 16.372171, "process_kernel_time": 4.74803, "process_mem_max_rss": "211588", "process_in_blocks": "30504", "process_out_blocks": "3096"}
[0m10:34:24.319124 [debug] [MainThread]: Command `dbt debug` succeeded at 10:34:24.318441 after 2.63 seconds
[0m10:34:24.321024 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:34:24.322776 [debug] [MainThread]: On debug: Close
[0m10:34:24.325042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64bdfd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6498b7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6498b7e20>]}
[0m10:34:24.327160 [debug] [MainThread]: Flushing usage events
[0m10:34:38.032876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc2a1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc7efb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36da0b6940>]}


============================== 10:34:38.052934 | 83f04ee2-0727-4007-b65e-3375a634f354 ==============================
[0m10:34:38.052934 [info ] [MainThread]: Running with dbt=1.7.11
[0m10:34:38.055476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:34:39.635589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83f04ee2-0727-4007-b65e-3375a634f354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc7efb20>]}
[0m10:34:40.230109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83f04ee2-0727-4007-b65e-3375a634f354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d9e6dcd0>]}
[0m10:34:40.234312 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m10:34:40.288526 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m10:34:40.631549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:34:40.637892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:34:40.701798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83f04ee2-0727-4007-b65e-3375a634f354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d9c5c0d0>]}
[0m10:34:40.824284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83f04ee2-0727-4007-b65e-3375a634f354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d9d56c70>]}
[0m10:34:40.835187 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m10:34:40.840198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83f04ee2-0727-4007-b65e-3375a634f354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d9d56d60>]}
[0m10:34:40.862141 [info ] [MainThread]: 
[0m10:34:40.869876 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:34:40.882169 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m10:34:40.979805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:43.566869 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:34:43.582683 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.607283 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:34:43.624327 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.641156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__bitcoin_default)
[0m10:34:43.651290 [debug] [ThreadPool]: Creating schema "schema: "bitcoin_default"
"
[0m10:34:43.794836 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "create__bitcoin_default"} */
create database if not exists `bitcoin_default`
        
  
        
  ...
[0m10:34:44.209129 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m10:34:44.235126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__bitcoin_default, now list__bitcoin_default)
[0m10:34:44.294316 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m10:34:44.829406 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.53 seconds
[0m10:34:44.844256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_default, now list__bitcoin)
[0m10:34:44.869363 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m10:34:45.046335 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.17 seconds
[0m10:34:45.109817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83f04ee2-0727-4007-b65e-3375a634f354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d9d56040>]}
[0m10:34:45.122817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:34:45.126854 [info ] [MainThread]: 
[0m10:34:45.187448 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.example
[0m10:34:45.193615 [info ] [Thread-1  ]: 1 of 4 START sql view model `bitcoin`.`example` ................................ [RUN]
[0m10:34:45.202621 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin, now model.bitcoin_etl.example)
[0m10:34:45.207796 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.example
[0m10:34:45.314170 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.example"
[0m10:34:45.326633 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.example (compile): 10:34:45.215102 => 10:34:45.324045
[0m10:34:45.331910 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.example
[0m10:34:45.558837 [debug] [Thread-1  ]: Creating new relation example
[0m10:34:45.630824 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.example"
[0m10:34:45.637554 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.example: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.example"} */


  create view `bitcoin`.`example` 
  
    
    
  as (
    

SELECT 
    transaction_id AS tx_hash,
    transaction_timestamp AS timestamp,
    pair_token0_symbol,
    pair_token1_symbol,
    amount_u_s_d AS value_usd,
    amount0_in,
    amount1_in,
    amount0_out,
    amount1_out
FROM `bitcoin`.`swaps_latest`
  )...
[0m10:34:45.684329 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:34:45.906775 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.example (execute): 10:34:45.334724 => 10:34:45.904907
[0m10:34:45.914802 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f04ee2-0727-4007-b65e-3375a634f354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36aaa49910>]}
[0m10:34:45.919810 [info ] [Thread-1  ]: 1 of 4 OK created sql view model `bitcoin`.`example` ........................... [[32mOK[0m in 0.71s]
[0m10:34:45.927119 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.example
[0m10:34:45.931873 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.raw_transactions
[0m10:34:45.938266 [info ] [Thread-1  ]: 2 of 4 START sql view model `bitcoin`.`raw_transactions` ....................... [RUN]
[0m10:34:45.951103 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.example, now model.bitcoin_etl.raw_transactions)
[0m10:34:45.957516 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.raw_transactions
[0m10:34:45.987200 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.raw_transactions"
[0m10:34:45.996476 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.raw_transactions (compile): 10:34:45.963111 => 10:34:45.994763
[0m10:34:45.999379 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.raw_transactions
[0m10:34:46.025040 [debug] [Thread-1  ]: Creating new relation raw_transactions
[0m10:34:46.035397 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.raw_transactions"
[0m10:34:46.039835 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.raw_transactions: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.raw_transactions"} */


  create view `bitcoin`.`raw_transactions` 
  
    
    
  as (
    

SELECT 
    transaction_id AS tx_hash,
    transaction_timestamp AS timestamp,
    amount_u_s_d AS value_usd,
    pair_token0_symbol || '/' || pair_token1_symbol AS trading_pair
FROM `bitcoin`.`swaps_latest`
LIMIT 1000
  )...
[0m10:34:46.095819 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:34:46.112815 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.raw_transactions (execute): 10:34:46.002195 => 10:34:46.110733
[0m10:34:46.118412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f04ee2-0727-4007-b65e-3375a634f354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36aaa3e730>]}
[0m10:34:46.125772 [info ] [Thread-1  ]: 2 of 4 OK created sql view model `bitcoin`.`raw_transactions` .................. [[32mOK[0m in 0.17s]
[0m10:34:46.131976 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.raw_transactions
[0m10:34:46.135795 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.test
[0m10:34:46.141405 [info ] [Thread-1  ]: 3 of 4 START sql view model `bitcoin`.`test` ................................... [RUN]
[0m10:34:46.151643 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.raw_transactions, now model.bitcoin_etl.test)
[0m10:34:46.155485 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.test
[0m10:34:46.180960 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.test"
[0m10:34:46.187686 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test (compile): 10:34:46.160379 => 10:34:46.185243
[0m10:34:46.193039 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.test
[0m10:34:46.214765 [debug] [Thread-1  ]: Creating new relation test
[0m10:34:46.222632 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.test"
[0m10:34:46.227334 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */


  create view `bitcoin`.`test` 
  
    
    
  as (
    SELECT 1 as test_value
  )...
[0m10:34:46.256905 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m10:34:46.273874 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test (execute): 10:34:46.196477 => 10:34:46.271332
[0m10:34:46.279847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f04ee2-0727-4007-b65e-3375a634f354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36a91a66d0>]}
[0m10:34:46.285904 [info ] [Thread-1  ]: 3 of 4 OK created sql view model `bitcoin`.`test` .............................. [[32mOK[0m in 0.13s]
[0m10:34:46.296586 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.test
[0m10:34:46.303532 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.test_connection
[0m10:34:46.310357 [info ] [Thread-1  ]: 4 of 4 START sql view model `bitcoin_default`.`test_connection` ................ [RUN]
[0m10:34:46.317790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.test, now model.bitcoin_etl.test_connection)
[0m10:34:46.323453 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.test_connection
[0m10:34:46.351251 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.test_connection"
[0m10:34:46.362447 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test_connection (compile): 10:34:46.325912 => 10:34:46.358256
[0m10:34:46.366233 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.test_connection
[0m10:34:46.384967 [debug] [Thread-1  ]: Creating new relation test_connection
[0m10:34:46.392698 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.test_connection"
[0m10:34:46.396959 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */


  create view `bitcoin_default`.`test_connection` 
  
    
    
  as (
    -- models/test_connection.sql


SELECT 'swaps_latest' AS table_name, 
       count() AS row_count 
FROM bitcoin.swaps_latest
  )...
[0m10:34:46.441581 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:34:46.463990 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test_connection (execute): 10:34:46.368419 => 10:34:46.462103
[0m10:34:46.470051 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f04ee2-0727-4007-b65e-3375a634f354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36aa9ebc70>]}
[0m10:34:46.474958 [info ] [Thread-1  ]: 4 of 4 OK created sql view model `bitcoin_default`.`test_connection` ........... [[32mOK[0m in 0.16s]
[0m10:34:46.481069 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.test_connection
[0m10:34:46.493164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:46.496406 [debug] [MainThread]: Connection 'model.bitcoin_etl.test_connection' was left open.
[0m10:34:46.498548 [debug] [MainThread]: On model.bitcoin_etl.test_connection: Close
[0m10:34:46.501341 [info ] [MainThread]: 
[0m10:34:46.505634 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.63 seconds (5.63s).
[0m10:34:46.515935 [debug] [MainThread]: Command end result
[0m10:34:46.665767 [info ] [MainThread]: 
[0m10:34:46.670322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:34:46.681287 [info ] [MainThread]: 
[0m10:34:46.684803 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:34:46.699306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.801092, "process_user_time": 16.670214, "process_kernel_time": 2.025166, "process_mem_max_rss": "211604", "process_in_blocks": "2640", "process_out_blocks": "1864"}
[0m10:34:46.704187 [debug] [MainThread]: Command `dbt run` succeeded at 10:34:46.702914 after 8.81 seconds
[0m10:34:46.709916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc2a1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d9b6f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d9e6dcd0>]}
[0m10:34:46.717258 [debug] [MainThread]: Flushing usage events
[0m14:33:45.967877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f706a01e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7067dea5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7067dea460>]}


============================== 14:33:46.000881 | 14a8ac2d-413b-482d-8aed-cd6863c5d2fe ==============================
[0m14:33:46.000881 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:33:46.004607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models top_10_movers_by_volume', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:47.917077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14a8ac2d-413b-482d-8aed-cd6863c5d2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70695a2a30>]}
[0m14:33:48.520907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14a8ac2d-413b-482d-8aed-cd6863c5d2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7067d2eca0>]}
[0m14:33:48.525429 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m14:33:48.604124 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:33:49.020581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:33:49.023396 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/top_10_movers_by_volume.sql
[0m14:33:49.758791 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bitcoin_etl.top_10_movers_by_volume' (models/bitcoin/top_10_movers_by_volume.sql) depends on a node named 'your_source_table' which was not found
[0m14:33:49.772447 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.238988, "process_user_time": 14.485627, "process_kernel_time": 3.81148, "process_mem_max_rss": "108152", "process_in_blocks": "20464", "process_out_blocks": "1688", "command_success": false}
[0m14:33:49.775312 [debug] [MainThread]: Command `dbt run` failed at 14:33:49.774540 after 4.24 seconds
[0m14:33:49.777915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f706a01e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7067989160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7067e52550>]}
[0m14:33:49.781233 [debug] [MainThread]: Flushing usage events
[0m14:36:25.276283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f204f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68efed1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68efed14c0>]}


============================== 14:36:25.305088 | 2851a5d6-336a-463b-9f2f-2632f34364dc ==============================
[0m14:36:25.305088 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:36:25.308098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models top_10_movers_by_volume', 'send_anonymous_usage_stats': 'True'}
[0m14:36:26.783002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2851a5d6-336a-463b-9f2f-2632f34364dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68efe69370>]}
[0m14:36:27.380989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2851a5d6-336a-463b-9f2f-2632f34364dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68efd16160>]}
[0m14:36:27.385004 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m14:36:27.452185 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:36:27.903798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:36:27.909831 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/top_10_movers_by_volume.sql
[0m14:36:29.151030 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bitcoin_etl.top_10_movers_by_volume' (models/bitcoin/top_10_movers_by_volume.sql) depends on a node named 'erc20_transfers_wbtc' which was not found
[0m14:36:29.162621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.066816, "process_user_time": 13.567165, "process_kernel_time": 1.149759, "process_mem_max_rss": "108060", "process_in_blocks": "584", "process_out_blocks": "16", "command_success": false}
[0m14:36:29.166688 [debug] [MainThread]: Command `dbt run` failed at 14:36:29.165600 after 4.07 seconds
[0m14:36:29.171588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f204f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ef999850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68efa07130>]}
[0m14:36:29.178023 [debug] [MainThread]: Flushing usage events
[0m14:49:25.583706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c22e2340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c0165f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c0165c70>]}


============================== 14:49:25.731239 | 750e6d22-9cfb-469c-a234-8266e559fa5d ==============================
[0m14:49:25.731239 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:49:25.748602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models top_10_movers_by_volume', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:49:29.374384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '750e6d22-9cfb-469c-a234-8266e559fa5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c2830b80>]}
[0m14:49:30.400504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '750e6d22-9cfb-469c-a234-8266e559fa5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bff085e0>]}
[0m14:49:30.408151 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m14:49:30.534181 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:49:30.794443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:49:30.800235 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/top_10_movers_by_volume.sql
[0m14:49:30.806041 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/schema.yml
[0m14:49:32.928030 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "bitcoin_swaps_latest".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("bitcoin", "swaps_latest").
  
  To fix this, change the name of one of these resources:
  - source.bitcoin_etl.bitcoin.swaps_latest (models/bitcoin/schema.yml)
  - source.bitcoin_etl.bitcoin.swaps_latest (models/bitcoin/sources.yml)
[0m14:49:32.936770 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.175945, "process_user_time": 24.011316, "process_kernel_time": 0.813688, "process_mem_max_rss": "110232", "process_in_blocks": "992", "process_out_blocks": "16", "command_success": false}
[0m14:49:32.948579 [debug] [MainThread]: Command `dbt run` failed at 14:49:32.947291 after 8.19 seconds
[0m14:49:32.952064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c22e2340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bfc3e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70bfe6ebe0>]}
[0m14:49:32.955979 [debug] [MainThread]: Flushing usage events
[0m14:56:51.516543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff314225340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3120a7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3120a7550>]}


============================== 14:56:51.558446 | 6c9a0738-0f57-46e2-b584-b997dc9d1378 ==============================
[0m14:56:51.558446 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:56:51.566076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models top_10_movers_by_volume', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:56:52.608978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c9a0738-0f57-46e2-b584-b997dc9d1378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff314773b80>]}
[0m14:56:53.056123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c9a0738-0f57-46e2-b584-b997dc9d1378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff312063e80>]}
[0m14:56:53.059184 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m14:56:53.101406 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:56:53.229980 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:56:53.233477 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/top_10_movers_by_volume.sql
[0m14:56:53.930173 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bitcoin_etl.top_10_movers_by_volume' (models/bitcoin/top_10_movers_by_volume.sql) depends on a source named 'bitcoin.erc20_transfers_wbtc' which was not found
[0m14:56:53.934653 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6678178, "process_user_time": 13.468321, "process_kernel_time": 0.469941, "process_mem_max_rss": "108104", "process_in_blocks": "376", "process_out_blocks": "8", "command_success": false}
[0m14:56:53.937219 [debug] [MainThread]: Command `dbt run` failed at 14:56:53.936640 after 2.67 seconds
[0m14:56:53.939756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff314225340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff311bd2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff311b0c1c0>]}
[0m14:56:53.942720 [debug] [MainThread]: Flushing usage events
[0m14:59:58.539869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca7123640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca555fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca4f3a9a0>]}


============================== 14:59:58.561606 | 026681de-bb53-4f89-9adc-a68fea15ca85 ==============================
[0m14:59:58.561606 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:59:58.563908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models top_10_movers_by_volume', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:59:59.783024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '026681de-bb53-4f89-9adc-a68fea15ca85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca555fd30>]}
[0m15:00:00.752996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '026681de-bb53-4f89-9adc-a68fea15ca85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca4deaa00>]}
[0m15:00:00.759201 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m15:00:00.836849 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:00:01.186525 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m15:00:01.190839 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/top_10_movers_by_volume.sql
[0m15:00:02.348934 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bitcoin_etl.top_10_movers_by_volume' (models/bitcoin/top_10_movers_by_volume.sql) depends on a source named 'bitcoin.erc20_transfers_wbtc' which was not found
[0m15:00:02.354629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9763007, "process_user_time": 13.442435, "process_kernel_time": 0.450081, "process_mem_max_rss": "110280", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m15:00:02.360433 [debug] [MainThread]: Command `dbt run` failed at 15:00:02.359190 after 3.98 seconds
[0m15:00:02.364158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca7123640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca4ddbd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca4cc12e0>]}
[0m15:00:02.367787 [debug] [MainThread]: Flushing usage events
[0m15:00:41.031348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0987bac0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0985f8b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0985977b80>]}


============================== 15:00:41.067188 | 38c06dd6-d1ee-4d8d-ad1b-66d108c518d2 ==============================
[0m15:00:41.067188 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:00:41.070531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models top_10_movers_by_volume', 'send_anonymous_usage_stats': 'True'}
[0m15:00:42.133538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38c06dd6-d1ee-4d8d-ad1b-66d108c518d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0985f8b6d0>]}
[0m15:00:42.627889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38c06dd6-d1ee-4d8d-ad1b-66d108c518d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098572dcd0>]}
[0m15:00:42.630732 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m15:00:42.686440 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:00:42.879586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:00:42.883963 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/top_10_movers_by_volume.sql
[0m15:00:42.888518 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/schema.yml
[0m15:00:43.988259 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "bitcoin_swaps_latest".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("bitcoin", "swaps_latest").
  
  To fix this, change the name of one of these resources:
  - source.bitcoin_etl.bitcoin.swaps_latest (models/bitcoin/schema.yml)
  - source.bitcoin_etl.bitcoin.swaps_latest (models/bitcoin/sources.yml)
[0m15:00:43.993332 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2022848, "process_user_time": 17.182117, "process_kernel_time": 0.951224, "process_mem_max_rss": "112124", "process_in_blocks": "136", "process_out_blocks": "16", "command_success": false}
[0m15:00:43.996273 [debug] [MainThread]: Command `dbt run` failed at 15:00:43.995594 after 3.21 seconds
[0m15:00:43.999350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0987bac0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098414e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098414e940>]}
[0m15:00:44.004252 [debug] [MainThread]: Flushing usage events
[0m15:07:15.765174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38df629ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38dd45f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38dd45f460>]}


============================== 15:07:15.793887 | 5d94a203-7344-48bb-be5c-1104dd765ef9 ==============================
[0m15:07:15.793887 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:07:15.798136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models top_10_movers_by_volume', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:07:16.752226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d94a203-7344-48bb-be5c-1104dd765ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38dd3f73a0>]}
[0m15:07:17.196414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d94a203-7344-48bb-be5c-1104dd765ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38dd2455b0>]}
[0m15:07:17.199094 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m15:07:17.245259 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:07:17.391215 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m15:07:17.394437 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/top_10_movers_by_volume.sql
[0m15:07:17.398074 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/schema.yml
[0m15:07:19.252872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d94a203-7344-48bb-be5c-1104dd765ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c73b30d0>]}
[0m15:07:19.354305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d94a203-7344-48bb-be5c-1104dd765ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38dd271520>]}
[0m15:07:19.357849 [info ] [MainThread]: Found 5 models, 1 test, 2 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m15:07:19.361643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d94a203-7344-48bb-be5c-1104dd765ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38dd2af5e0>]}
[0m15:07:19.368188 [info ] [MainThread]: 
[0m15:07:19.373663 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:07:19.379147 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:07:19.442038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:22.838976 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:07:22.847858 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:07:22.859555 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__bitcoin'
[0m15:07:22.879808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:22.995061 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m15:07:23.100823 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.10 seconds
[0m15:07:23.107292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin, now list__bitcoin_default)
[0m15:07:23.124006 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m15:07:23.165634 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m15:07:23.179526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d94a203-7344-48bb-be5c-1104dd765ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c7286670>]}
[0m15:07:23.183536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:23.189491 [info ] [MainThread]: 
[0m15:07:23.213996 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.top_10_movers_by_volume
[0m15:07:23.218253 [info ] [Thread-1  ]: 1 of 1 START sql view model `bitcoin`.`top_10_movers_by_volume` ................ [RUN]
[0m15:07:23.222964 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin_default, now model.bitcoin_etl.top_10_movers_by_volume)
[0m15:07:23.225211 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.top_10_movers_by_volume
[0m15:07:23.265086 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.top_10_movers_by_volume"
[0m15:07:23.269740 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_10_movers_by_volume (compile): 15:07:23.227272 => 15:07:23.267564
[0m15:07:23.273793 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.top_10_movers_by_volume
[0m15:07:23.418133 [debug] [Thread-1  ]: Creating new relation top_10_movers_by_volume
[0m15:07:23.467549 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.top_10_movers_by_volume"
[0m15:07:23.470493 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */


  create view `bitcoin`.`top_10_movers_by_volume` 
  
    
    
  as (
    

WITH volume_calculations AS (
  SELECT
    from_address AS address,
    -wbtc_amount AS volume -- Negative for outflows
  FROM `bitcoin`.`erc20_transfers_wbtc`
  
  UNION ALL
  
  SELECT
    to_address AS address,
    wbtc_amount AS volume -- Positive for inflows
  FROM `bitcoin`.`erc20_transfers_wbtc`
),

net_volume AS (
  SELECT
    address,
    SUM(volume) AS net_volume,
    SUM(CASE WHEN volume > 0 THEN volume ELSE 0 END) AS total_inflow,
    SUM(CASE WHEN volume < 0 THEN ABS(volume) ELSE 0 END) AS total_outflow,
    COUNT(*) AS transaction_count
  FROM volume_calculations
  GROUP BY address
)

SELECT
  address,
  net_volume,
  total_inflow,
  total_outflow,
  transaction_count,
  RANK() OVER (ORDER BY ABS(net_volume) DESC) AS volume_rank
FROM net_volume
WHERE volume_rank <= 10
ORDER BY volume_rank
  )...
[0m15:07:23.563614 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */


  create view `bitcoin`.`top_10_movers_by_volume` 
  
    
    
  as (
    

WITH volume_calculations AS (
  SELECT
    from_address AS address,
    -wbtc_amount AS volume -- Negative for outflows
  FROM `bitcoin`.`erc20_transfers_wbtc`
  
  UNION ALL
  
  SELECT
    to_address AS address,
    wbtc_amount AS volume -- Positive for inflows
  FROM `bitcoin`.`erc20_transfers_wbtc`
),

net_volume AS (
  SELECT
    address,
    SUM(volume) AS net_volume,
    SUM(CASE WHEN volume > 0 THEN volume ELSE 0 END) AS total_inflow,
    SUM(CASE WHEN volume < 0 THEN ABS(volume) ELSE 0 END) AS total_outflow,
    COUNT(*) AS transaction_count
  FROM volume_calculations
  GROUP BY address
)

SELECT
  address,
  net_volume,
  total_inflow,
  total_outflow,
  transaction_count,
  RANK() OVER (ORDER BY ABS(net_volume) DESC) AS volume_rank
FROM net_volume
WHERE volume_rank <= 10
ORDER BY volume_rank
  )
[0m15:07:23.569233 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_10_movers_by_volume (execute): 15:07:23.276604 => 15:07:23.566997
[0m15:07:23.593819 [debug] [Thread-1  ]: Database Error in model top_10_movers_by_volume (models/bitcoin/top_10_movers_by_volume.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 184
   Code: 184. DB::Exception: Window function rank() OVER (ORDER BY ABS(net_volume) DESC) AS volume_rank is found in WHERE in query. (ILLEGAL_AGGREGATION) (version 25.3.2.39 (official build))
  compiled Code at target/run/bitcoin_etl/models/bitcoin/top_10_movers_by_volume.sql
[0m15:07:23.597289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d94a203-7344-48bb-be5c-1104dd765ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38801cefa0>]}
[0m15:07:23.602201 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model `bitcoin`.`top_10_movers_by_volume` ....... [[31mERROR[0m in 0.38s]
[0m15:07:23.607582 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.top_10_movers_by_volume
[0m15:07:23.616433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:23.618238 [debug] [MainThread]: Connection 'list_' was left open.
[0m15:07:23.620048 [debug] [MainThread]: On list_: Close
[0m15:07:23.621945 [debug] [MainThread]: Connection 'model.bitcoin_etl.top_10_movers_by_volume' was left open.
[0m15:07:23.623563 [debug] [MainThread]: On model.bitcoin_etl.top_10_movers_by_volume: Close
[0m15:07:23.625656 [info ] [MainThread]: 
[0m15:07:23.628853 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m15:07:23.635427 [debug] [MainThread]: Command end result
[0m15:07:23.673049 [info ] [MainThread]: 
[0m15:07:23.675773 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:07:23.678275 [info ] [MainThread]: 
[0m15:07:23.680358 [error] [MainThread]:   Database Error in model top_10_movers_by_volume (models/bitcoin/top_10_movers_by_volume.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 184
   Code: 184. DB::Exception: Window function rank() OVER (ORDER BY ABS(net_volume) DESC) AS volume_rank is found in WHERE in query. (ILLEGAL_AGGREGATION) (version 25.3.2.39 (official build))
  compiled Code at target/run/bitcoin_etl/models/bitcoin/top_10_movers_by_volume.sql
[0m15:07:23.683016 [info ] [MainThread]: 
[0m15:07:23.689020 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:07:23.694636 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.141469, "process_user_time": 18.134699, "process_kernel_time": 1.938364, "process_mem_max_rss": "202576", "process_in_blocks": "8176", "process_out_blocks": "2688", "command_success": false}
[0m15:07:23.698384 [debug] [MainThread]: Command `dbt run` failed at 15:07:23.697617 after 8.15 seconds
[0m15:07:23.700923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38df629ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38dd1d34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38dd1591f0>]}
[0m15:07:23.704749 [debug] [MainThread]: Flushing usage events
[0m15:08:57.926947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68779a6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6875e1c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68757bd9a0>]}


============================== 15:08:57.955390 | 4beb948f-6f55-4067-8ac4-a9115cc823ff ==============================
[0m15:08:57.955390 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:08:57.959588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models top_10_movers_by_volume', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:08:59.733860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4beb948f-6f55-4067-8ac4-a9115cc823ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6875e1c130>]}
[0m15:09:00.542984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4beb948f-6f55-4067-8ac4-a9115cc823ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687566da00>]}
[0m15:09:00.547417 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m15:09:00.622688 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:09:00.783578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:09:00.787721 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/top_10_movers_by_volume.sql
[0m15:09:01.522576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4beb948f-6f55-4067-8ac4-a9115cc823ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686f9daf40>]}
[0m15:09:01.593898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4beb948f-6f55-4067-8ac4-a9115cc823ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68754155b0>]}
[0m15:09:01.596357 [info ] [MainThread]: Found 5 models, 1 test, 2 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m15:09:01.598998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4beb948f-6f55-4067-8ac4-a9115cc823ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6875415490>]}
[0m15:09:01.605812 [info ] [MainThread]: 
[0m15:09:01.610877 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:09:01.618333 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:09:01.674971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:03.146906 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:09:03.156358 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:09:03.167346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__bitcoin_default)
[0m15:09:03.198246 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m15:09:03.240740 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m15:09:03.247980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_default, now list__bitcoin)
[0m15:09:03.259503 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m15:09:03.295345 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m15:09:03.313478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4beb948f-6f55-4067-8ac4-a9115cc823ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687559ce50>]}
[0m15:09:03.317336 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:09:03.319545 [info ] [MainThread]: 
[0m15:09:03.343835 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.top_10_movers_by_volume
[0m15:09:03.347063 [info ] [Thread-1  ]: 1 of 1 START sql view model `bitcoin`.`top_10_movers_by_volume` ................ [RUN]
[0m15:09:03.353439 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin, now model.bitcoin_etl.top_10_movers_by_volume)
[0m15:09:03.356139 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.top_10_movers_by_volume
[0m15:09:03.399573 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.top_10_movers_by_volume"
[0m15:09:03.403028 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_10_movers_by_volume (compile): 15:09:03.358215 => 15:09:03.401804
[0m15:09:03.405374 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.top_10_movers_by_volume
[0m15:09:03.502439 [debug] [Thread-1  ]: Creating new relation top_10_movers_by_volume
[0m15:09:03.549871 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.top_10_movers_by_volume"
[0m15:09:03.553029 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */


  create view `bitcoin`.`top_10_movers_by_volume` 
  
    
    
  as (
    

WITH volume_calculations AS (
  SELECT
    from_address AS address,
    -wbtc_amount AS volume -- Negative for outflows
  FROM `bitcoin`.`erc20_transfers_wbtc`
  
  UNION ALL
  
  SELECT
    to_address AS address,
    wbtc_amount AS volume -- Positive for inflows
  FROM `bitcoin`.`erc20_transfers_wbtc`
),

net_volume AS (
  SELECT
    address,
    SUM(volume) AS net_volume,
    SUM(CASE WHEN volume > 0 THEN volume ELSE 0 END) AS total_inflow,
    SUM(CASE WHEN volume < 0 THEN ABS(volume) ELSE 0 END) AS total_outflow,
    COUNT(*) AS transaction_count
  FROM volume_calculations
  GROUP BY address
),

ranked_volumes AS (
  SELECT
    address,
    net_volume,
    total_inflow,
    total_outflow,
    transaction_count,
    RANK() OVER (ORDER BY ABS(net_volume) DESC) AS volume_rank
  FROM net_volume
)

SELECT
  address,
  net_volume,
  total_inflow,
  total_outflow,
  transaction_count,
  volume_rank
FROM ranked_volumes
WHERE volume_rank <= 10
ORDER BY volume_rank
  )...
[0m15:09:03.591810 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m15:09:03.681258 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_10_movers_by_volume (execute): 15:09:03.406664 => 15:09:03.679976
[0m15:09:03.686033 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4beb948f-6f55-4067-8ac4-a9115cc823ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68187e85b0>]}
[0m15:09:03.689733 [info ] [Thread-1  ]: 1 of 1 OK created sql view model `bitcoin`.`top_10_movers_by_volume` ........... [[32mOK[0m in 0.33s]
[0m15:09:03.693677 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.top_10_movers_by_volume
[0m15:09:03.704611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:03.707350 [debug] [MainThread]: Connection 'model.bitcoin_etl.top_10_movers_by_volume' was left open.
[0m15:09:03.709834 [debug] [MainThread]: On model.bitcoin_etl.top_10_movers_by_volume: Close
[0m15:09:03.712906 [info ] [MainThread]: 
[0m15:09:03.716845 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m15:09:03.721557 [debug] [MainThread]: Command end result
[0m15:09:03.771521 [info ] [MainThread]: 
[0m15:09:03.774724 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:03.778175 [info ] [MainThread]: 
[0m15:09:03.782550 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:09:03.788176 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.137157, "process_user_time": 17.45807, "process_kernel_time": 1.248431, "process_mem_max_rss": "188384", "process_out_blocks": "2696", "process_in_blocks": "0"}
[0m15:09:03.792470 [debug] [MainThread]: Command `dbt run` succeeded at 15:09:03.790754 after 6.14 seconds
[0m15:09:03.796731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68779a6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f687566da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f686f8c5cd0>]}
[0m15:09:03.799951 [debug] [MainThread]: Flushing usage events
[0m17:35:23.519958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afc5e0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afa462f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afa462550>]}


============================== 17:35:23.549592 | b496ea54-b717-41aa-b3c2-54f8387ddb09 ==============================
[0m17:35:23.549592 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:35:23.552098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models pool_concentration.sql', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:25.200173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b496ea54-b717-41aa-b3c2-54f8387ddb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afcb2db80>]}
[0m17:35:25.658804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b496ea54-b717-41aa-b3c2-54f8387ddb09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afa419e80>]}
[0m17:35:25.662841 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m17:35:25.711710 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:35:25.920268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m17:35:25.923626 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/pool_concentration.sql
[0m17:35:25.926139 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/top_liquidity_providers.sql
[0m17:35:26.515769 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bitcoin_etl.pool_concentration' (models/bitcoin/pool_concentration.sql) depends on a source named 'view.liquidity_positions_largest' which was not found
[0m17:35:26.526253 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2931733, "process_user_time": 18.752466, "process_kernel_time": 3.170158, "process_mem_max_rss": "108168", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m17:35:26.530042 [debug] [MainThread]: Command `dbt run` failed at 17:35:26.529344 after 3.30 seconds
[0m17:35:26.531940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afc5e0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af9f2c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af9f38fd0>]}
[0m17:35:26.533755 [debug] [MainThread]: Flushing usage events
[0m17:39:19.369074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad4aba1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad4b0a2bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad4896c5e0>]}


============================== 17:39:19.386922 | 20c74763-cb58-401d-95e1-fa6e637a8979 ==============================
[0m17:39:19.386922 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:39:19.389667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models pool_concentration.sql', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:39:20.289996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20c74763-cb58-401d-95e1-fa6e637a8979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad4d6301c0>]}
[0m17:39:20.701418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20c74763-cb58-401d-95e1-fa6e637a8979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad488629a0>]}
[0m17:39:20.703906 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m17:39:20.747828 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:39:20.842811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m17:39:20.844480 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/pool_concentration.sql
[0m17:39:20.846040 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/top_liquidity_providers.sql
[0m17:39:20.848511 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/schema.yml
[0m17:39:22.495227 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bitcoin_etl.pool_concentration' (models/bitcoin/pool_concentration.sql) depends on a source named 'view.liquidity_positions_largest' which was not found
[0m17:39:22.499483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2425513, "process_user_time": 9.860071, "process_kernel_time": 0.259738, "process_mem_max_rss": "113632", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m17:39:22.502493 [debug] [MainThread]: Command `dbt run` failed at 17:39:22.501749 after 3.25 seconds
[0m17:39:22.504760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad4aba1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad4870d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad469e1be0>]}
[0m17:39:22.507617 [debug] [MainThread]: Flushing usage events
[0m17:44:13.469200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b1c34340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91afab6f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91afab6550>]}


============================== 17:44:13.495800 | 5d47adbe-b7b4-4ff7-80e5-97d7c4ddafb7 ==============================
[0m17:44:13.495800 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:44:13.498814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models top_10_movers_by_volume', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:44:14.829789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d47adbe-b7b4-4ff7-80e5-97d7c4ddafb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b2181b80>]}
[0m17:44:15.376932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d47adbe-b7b4-4ff7-80e5-97d7c4ddafb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91afa6de80>]}
[0m17:44:15.382065 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m17:44:15.432024 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:44:15.579285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m17:44:15.582089 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/pool_concentration.sql
[0m17:44:15.584821 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/top_liquidity_providers.sql
[0m17:44:15.590931 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/schema.yml
[0m17:44:18.018782 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.bitcoin_etl.source_relationships_bitcoin_liquidity_positions_largest_pair_id__pair_id__ref_pool_metrics_.cb63e0cbb0' (models/bitcoin/schema.yml) depends on a node named 'pool_metrics' in package '' which was not found
[0m17:44:18.108890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d47adbe-b7b4-4ff7-80e5-97d7c4ddafb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ad9400d0>]}
[0m17:44:18.214364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d47adbe-b7b4-4ff7-80e5-97d7c4ddafb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ad9c2b80>]}
[0m17:44:18.216489 [info ] [MainThread]: Found 7 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m17:44:18.218871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d47adbe-b7b4-4ff7-80e5-97d7c4ddafb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ad9c6040>]}
[0m17:44:18.223724 [info ] [MainThread]: 
[0m17:44:18.229390 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:44:18.233747 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:44:18.287433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:23.091119 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:44:23.100294 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m17:44:23.110631 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__bitcoin_default'
[0m17:44:23.132058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:23.296518 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m17:44:23.596816 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.30 seconds
[0m17:44:23.606218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_default, now list__bitcoin)
[0m17:44:23.630704 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m17:44:24.144389 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.51 seconds
[0m17:44:24.168044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d47adbe-b7b4-4ff7-80e5-97d7c4ddafb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91af7d2d90>]}
[0m17:44:24.172404 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:24.174565 [info ] [MainThread]: 
[0m17:44:24.263590 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.top_10_movers_by_volume
[0m17:44:24.267257 [info ] [Thread-1  ]: 1 of 1 START sql view model `bitcoin`.`top_10_movers_by_volume` ................ [RUN]
[0m17:44:24.272085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin, now model.bitcoin_etl.top_10_movers_by_volume)
[0m17:44:24.274985 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.top_10_movers_by_volume
[0m17:44:24.337263 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.top_10_movers_by_volume"
[0m17:44:24.342865 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_10_movers_by_volume (compile): 17:44:24.277057 => 17:44:24.341045
[0m17:44:24.345956 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.top_10_movers_by_volume
[0m17:44:24.596612 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.top_10_movers_by_volume"
[0m17:44:24.601090 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */


  create view `bitcoin`.`top_10_movers_by_volume__dbt_tmp` 
  
    
    
  as (
    

WITH volume_calculations AS (
  SELECT
    from_address AS address,
    -wbtc_amount AS volume -- Negative for outflows
  FROM `bitcoin`.`erc20_transfers_wbtc`
  
  UNION ALL
  
  SELECT
    to_address AS address,
    wbtc_amount AS volume -- Positive for inflows
  FROM `bitcoin`.`erc20_transfers_wbtc`
),

net_volume AS (
  SELECT
    address,
    SUM(volume) AS net_volume,
    SUM(CASE WHEN volume > 0 THEN volume ELSE 0 END) AS total_inflow,
    SUM(CASE WHEN volume < 0 THEN ABS(volume) ELSE 0 END) AS total_outflow,
    COUNT(*) AS transaction_count
  FROM volume_calculations
  GROUP BY address
),

ranked_volumes AS (
  SELECT
    address,
    net_volume,
    total_inflow,
    total_outflow,
    transaction_count,
    RANK() OVER (ORDER BY ABS(net_volume) DESC) AS volume_rank
  FROM net_volume
)

SELECT
  address,
  net_volume,
  total_inflow,
  total_outflow,
  transaction_count,
  volume_rank
FROM ranked_volumes
WHERE volume_rank <= 10
ORDER BY volume_rank
  )...
[0m17:44:24.669872 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m17:44:24.705133 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */

    drop table if exists `bitcoin`.`top_10_movers_by_volume__dbt_backup` 
  
  ...
[0m17:44:24.714534 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m17:44:24.720068 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */

    rename table `bitcoin`.`top_10_movers_by_volume` to `bitcoin`.`top_10_movers_by_volume__dbt_backup` 
  
  ...
[0m17:44:24.728779 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m17:44:24.746497 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */

    drop table if exists `bitcoin`.`top_10_movers_by_volume` 
  
  ...
[0m17:44:24.758182 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m17:44:24.765331 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */

    rename table `bitcoin`.`top_10_movers_by_volume__dbt_tmp` to `bitcoin`.`top_10_movers_by_volume` 
  
  ...
[0m17:44:24.774414 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m17:44:24.925237 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */

    drop table if exists `bitcoin`.`top_10_movers_by_volume__dbt_backup` 
  ...
[0m17:44:24.932942 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m17:44:24.941023 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_10_movers_by_volume (execute): 17:44:24.348110 => 17:44:24.939693
[0m17:44:24.945598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d47adbe-b7b4-4ff7-80e5-97d7c4ddafb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ad975be0>]}
[0m17:44:24.949371 [info ] [Thread-1  ]: 1 of 1 OK created sql view model `bitcoin`.`top_10_movers_by_volume` ........... [[32mOK[0m in 0.67s]
[0m17:44:24.955138 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.top_10_movers_by_volume
[0m17:44:24.965215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:24.968031 [debug] [MainThread]: Connection 'list_' was left open.
[0m17:44:24.970669 [debug] [MainThread]: On list_: Close
[0m17:44:24.973176 [debug] [MainThread]: Connection 'model.bitcoin_etl.top_10_movers_by_volume' was left open.
[0m17:44:24.975127 [debug] [MainThread]: On model.bitcoin_etl.top_10_movers_by_volume: Close
[0m17:44:24.978056 [info ] [MainThread]: 
[0m17:44:24.981200 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.75 seconds (6.75s).
[0m17:44:24.988767 [debug] [MainThread]: Command end result
[0m17:44:25.043655 [info ] [MainThread]: 
[0m17:44:25.048760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:25.052274 [info ] [MainThread]: 
[0m17:44:25.055593 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:44:25.060042 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.769105, "process_user_time": 19.211359, "process_kernel_time": 2.466594, "process_mem_max_rss": "193764", "process_in_blocks": "152", "process_out_blocks": "2888"}
[0m17:44:25.063976 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:25.062679 after 11.77 seconds
[0m17:44:25.067379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b1c34340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91af8fb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b2181b80>]}
[0m17:44:25.070148 [debug] [MainThread]: Flushing usage events
[0m17:44:41.482282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd29bf8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd2a0f9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd279c35e0>]}


============================== 17:44:41.560720 | 187652b8-2003-49ec-af5d-58162ff82c94 ==============================
[0m17:44:41.560720 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:44:41.588332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models bitcoin.pool_concentration', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:44:42.699217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '187652b8-2003-49ec-af5d-58162ff82c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd2c6871c0>]}
[0m17:44:42.988067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '187652b8-2003-49ec-af5d-58162ff82c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd278b99a0>]}
[0m17:44:42.990131 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m17:44:43.011879 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:44:43.095594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:43.097611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:43.126577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '187652b8-2003-49ec-af5d-58162ff82c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd27519fd0>]}
[0m17:44:43.193475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '187652b8-2003-49ec-af5d-58162ff82c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd27632ca0>]}
[0m17:44:43.196227 [info ] [MainThread]: Found 7 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m17:44:43.199190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '187652b8-2003-49ec-af5d-58162ff82c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd276328b0>]}
[0m17:44:43.206071 [info ] [MainThread]: 
[0m17:44:43.210265 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:44:43.215349 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:44:43.254222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:44.558996 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:44:44.570648 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m17:44:44.582637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__bitcoin_default)
[0m17:44:44.625205 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m17:44:44.682096 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:44:44.691843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_default, now list__bitcoin)
[0m17:44:44.704717 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m17:44:44.747700 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:44:44.768455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '187652b8-2003-49ec-af5d-58162ff82c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd27407dc0>]}
[0m17:44:44.772138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:44.775412 [info ] [MainThread]: 
[0m17:44:44.801301 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.pool_concentration
[0m17:44:44.803862 [info ] [Thread-1  ]: 1 of 1 START sql view model `bitcoin`.`pool_concentration` ..................... [RUN]
[0m17:44:44.809066 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin, now model.bitcoin_etl.pool_concentration)
[0m17:44:44.812324 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.pool_concentration
[0m17:44:44.847781 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.pool_concentration"
[0m17:44:44.850957 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pool_concentration (compile): 17:44:44.813990 => 17:44:44.849901
[0m17:44:44.852864 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.pool_concentration
[0m17:44:44.939859 [debug] [Thread-1  ]: Creating new relation pool_concentration
[0m17:44:44.973302 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.pool_concentration"
[0m17:44:44.976006 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pool_concentration: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pool_concentration"} */


  create view `bitcoin`.`pool_concentration` 
  
    
    
  as (
    

SELECT
  pair_token0_symbol || '-' || pair_token1_symbol AS pair_name,
  liquidity_token_balance,
  liquidity_token_balance / SUM(liquidity_token_balance) OVER () AS overall_share_pct,
  CASE
    WHEN liquidity_token_balance > 1000 THEN 'Whale'
    WHEN liquidity_token_balance > 100 THEN 'Dolphin'
    ELSE 'Minnow'
  END AS provider_size
FROM `bitcoin`.`liquidity_positions_largest`
ORDER BY liquidity_token_balance DESC
  )...
[0m17:44:45.015406 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:44:45.108928 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pool_concentration (execute): 17:44:44.854162 => 17:44:45.107560
[0m17:44:45.112896 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '187652b8-2003-49ec-af5d-58162ff82c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfc317430>]}
[0m17:44:45.115413 [info ] [Thread-1  ]: 1 of 1 OK created sql view model `bitcoin`.`pool_concentration` ................ [[32mOK[0m in 0.31s]
[0m17:44:45.118026 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.pool_concentration
[0m17:44:45.124350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:45.127328 [debug] [MainThread]: Connection 'model.bitcoin_etl.pool_concentration' was left open.
[0m17:44:45.129940 [debug] [MainThread]: On model.bitcoin_etl.pool_concentration: Close
[0m17:44:45.132659 [info ] [MainThread]: 
[0m17:44:45.135319 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m17:44:45.139565 [debug] [MainThread]: Command end result
[0m17:44:45.196326 [info ] [MainThread]: 
[0m17:44:45.199511 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:45.202549 [info ] [MainThread]: 
[0m17:44:45.205651 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:44:45.214597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.010516, "process_user_time": 13.276309, "process_kernel_time": 1.254375, "process_mem_max_rss": "206352", "process_in_blocks": "8", "process_out_blocks": "1968"}
[0m17:44:45.219112 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:45.218002 after 4.02 seconds
[0m17:44:45.222446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd29bf8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd279c67c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd27430fd0>]}
[0m17:44:45.226045 [debug] [MainThread]: Flushing usage events
[0m17:48:47.368340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9940e3b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993f2b1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ec529a0>]}


============================== 17:48:47.395133 | f939348e-276c-4a72-94d0-d7bd986ac4aa ==============================
[0m17:48:47.395133 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:48:47.399191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models bitcoin.top_liquidity_providers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:48:48.617705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f939348e-276c-4a72-94d0-d7bd986ac4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993f2b1130>]}
[0m17:48:49.182179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f939348e-276c-4a72-94d0-d7bd986ac4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993eb02a00>]}
[0m17:48:49.185385 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m17:48:49.242588 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:48:49.384085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:49.386351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:49.421159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f939348e-276c-4a72-94d0-d7bd986ac4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993e7a8f40>]}
[0m17:48:49.488784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f939348e-276c-4a72-94d0-d7bd986ac4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993e8c4c10>]}
[0m17:48:49.491062 [info ] [MainThread]: Found 7 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m17:48:49.493654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f939348e-276c-4a72-94d0-d7bd986ac4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993e8c4880>]}
[0m17:48:49.502575 [info ] [MainThread]: 
[0m17:48:49.508310 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:48:49.515745 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:48:49.599697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:51.583269 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:48:51.599610 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m17:48:51.618119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__bitcoin_default)
[0m17:48:51.669346 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m17:48:51.741267 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m17:48:51.753350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_default, now list__bitcoin)
[0m17:48:51.773307 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m17:48:51.842076 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m17:48:51.869264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f939348e-276c-4a72-94d0-d7bd986ac4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993e696d30>]}
[0m17:48:51.873288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:48:51.876093 [info ] [MainThread]: 
[0m17:48:51.907345 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.top_liquidity_providers
[0m17:48:51.912102 [info ] [Thread-1  ]: 1 of 1 START sql view model `bitcoin`.`top_liquidity_providers` ................ [RUN]
[0m17:48:51.918495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin, now model.bitcoin_etl.top_liquidity_providers)
[0m17:48:51.922274 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.top_liquidity_providers
[0m17:48:51.979917 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.top_liquidity_providers"
[0m17:48:51.985152 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_liquidity_providers (compile): 17:48:51.924815 => 17:48:51.983645
[0m17:48:51.987637 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.top_liquidity_providers
[0m17:48:52.124502 [debug] [Thread-1  ]: Creating new relation top_liquidity_providers
[0m17:48:52.181855 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.top_liquidity_providers"
[0m17:48:52.186875 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_liquidity_providers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_liquidity_providers"} */


  create view `bitcoin`.`top_liquidity_providers` 
  
    
    
  as (
    

WITH pool_stats AS (
  SELECT
    pair_id,
    pair_token0_symbol || '-' || pair_token1_symbol AS pair_name,
    COUNT(DISTINCT user_id) AS unique_providers,
    SUM(liquidity_token_balance) AS total_liquidity
  FROM `bitcoin`.`liquidity_positions_largest`
  GROUP BY 1, 2
),

provider_rankings AS (
  SELECT
    user_id,
    pair_id,
    pair_token0_symbol || '-' || pair_token1_symbol AS pair_name,
    liquidity_token_balance,
    liquidity_token_balance / SUM(liquidity_token_balance) OVER (PARTITION BY pair_id) AS pool_share_pct,
    RANK() OVER (PARTITION BY pair_id ORDER BY liquidity_token_balance DESC) AS provider_rank
  FROM `bitcoin`.`liquidity_positions_largest`
)

SELECT
  p.user_id,
  p.pair_id,
  p.pair_name,
  p.liquidity_token_balance,
  p.pool_share_pct,
  p.provider_rank,
  s.total_liquidity,
  s.unique_providers
FROM provider_rankings p
JOIN pool_stats s ON p.pair_id = s.pair_id
WHERE p.provider_rank <= 10  -- Top 10 providers per pool
ORDER BY p.pair_id, p.provider_rank
  )...
[0m17:48:52.222308 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m17:48:52.341733 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_liquidity_providers (execute): 17:48:51.989356 => 17:48:52.340618
[0m17:48:52.345610 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f939348e-276c-4a72-94d0-d7bd986ac4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f990f5a8310>]}
[0m17:48:52.348988 [info ] [Thread-1  ]: 1 of 1 OK created sql view model `bitcoin`.`top_liquidity_providers` ........... [[32mOK[0m in 0.43s]
[0m17:48:52.354572 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.top_liquidity_providers
[0m17:48:52.367368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:52.369690 [debug] [MainThread]: Connection 'model.bitcoin_etl.top_liquidity_providers' was left open.
[0m17:48:52.372585 [debug] [MainThread]: On model.bitcoin_etl.top_liquidity_providers: Close
[0m17:48:52.375893 [info ] [MainThread]: 
[0m17:48:52.379413 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m17:48:52.389088 [debug] [MainThread]: Command end result
[0m17:48:52.451714 [info ] [MainThread]: 
[0m17:48:52.456269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:48:52.459051 [info ] [MainThread]: 
[0m17:48:52.462207 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:48:52.468610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.333592, "process_user_time": 17.76067, "process_kernel_time": 1.784085, "process_mem_max_rss": "190608", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m17:48:52.473861 [debug] [MainThread]: Command `dbt run` succeeded at 17:48:52.472392 after 5.34 seconds
[0m17:48:52.477166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9940e3b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ea508e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993f2b1130>]}
[0m17:48:52.480546 [debug] [MainThread]: Flushing usage events
[0m17:56:33.900120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ab1d2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a9054d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a90544c0>]}


============================== 17:56:33.947837 | 66567faf-3be5-40aa-b5f3-653563f46bd4 ==============================
[0m17:56:33.947837 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:56:33.954355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models bitcoin.new_pairs_analysis', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:56:35.537008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66567faf-3be5-40aa-b5f3-653563f46bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a8fec370>]}
[0m17:56:36.040149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66567faf-3be5-40aa-b5f3-653563f46bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a8e99160>]}
[0m17:56:36.043256 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m17:56:36.087693 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:56:36.228473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:56:36.231357 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/new_pairs_analysis.sql
[0m17:56:36.236706 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/schema.yml
[0m17:56:37.509222 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'pairs_recently_created' in the 'models' section of file 'models/bitcoin/schema.yml'
[0m17:56:38.671951 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.bitcoin_etl.not_null_pairs_recently_created_id.b4b1a6b38e' (models/bitcoin/schema.yml) depends on a node named 'pairs_recently_created' in package '' which was not found
[0m17:56:38.675310 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.bitcoin_etl.unique_pairs_recently_created_id.745bbb2b80' (models/bitcoin/schema.yml) depends on a node named 'pairs_recently_created' in package '' which was not found
[0m17:56:38.678309 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.bitcoin_etl.not_null_pairs_recently_created_created_at_timestamp.cd7aef976a' (models/bitcoin/schema.yml) depends on a node named 'pairs_recently_created' in package '' which was not found
[0m17:56:38.681799 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.bitcoin_etl.not_negative_pairs_recently_created_reserve_u_s_d.3b136542a5' (models/bitcoin/schema.yml) depends on a node named 'pairs_recently_created' in package '' which was not found
[0m17:56:38.687384 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.bitcoin_etl.not_negative_pairs_recently_created_reserve_e_t_h.6f401b784d' (models/bitcoin/schema.yml) depends on a node named 'pairs_recently_created' in package '' which was not found
[0m17:56:38.692065 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.bitcoin_etl.source_relationships_bitcoin_liquidity_positions_largest_pair_id__pair_id__ref_pool_metrics_.cb63e0cbb0' (models/bitcoin/schema.yml) depends on a node named 'pool_metrics' in package '' which was not found
[0m17:56:38.786103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66567faf-3be5-40aa-b5f3-653563f46bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769af650d0>]}
[0m17:56:38.861896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66567faf-3be5-40aa-b5f3-653563f46bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a8b80f10>]}
[0m17:56:38.865181 [info ] [MainThread]: Found 8 models, 11 tests, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m17:56:38.868187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66567faf-3be5-40aa-b5f3-653563f46bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a8ec5a90>]}
[0m17:56:38.877223 [info ] [MainThread]: 
[0m17:56:38.882707 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:56:38.890212 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:56:38.953948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:40.374668 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:56:40.384313 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m17:56:40.395659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__bitcoin)
[0m17:56:40.427080 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m17:56:40.506284 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m17:56:40.523571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin, now list__bitcoin_default)
[0m17:56:40.562746 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m17:56:40.632459 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:56:40.642583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66567faf-3be5-40aa-b5f3-653563f46bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a8e22fa0>]}
[0m17:56:40.647260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:56:40.650527 [info ] [MainThread]: 
[0m17:56:40.678231 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.new_pairs_analysis
[0m17:56:40.681852 [info ] [Thread-1  ]: 1 of 1 START sql view model `bitcoin`.`new_pairs_analysis` ..................... [RUN]
[0m17:56:40.690009 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin_default, now model.bitcoin_etl.new_pairs_analysis)
[0m17:56:40.693725 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.new_pairs_analysis
[0m17:56:40.754085 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.new_pairs_analysis"
[0m17:56:40.758422 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.new_pairs_analysis (compile): 17:56:40.698166 => 17:56:40.756799
[0m17:56:40.761407 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.new_pairs_analysis
[0m17:56:40.900193 [debug] [Thread-1  ]: Creating new relation new_pairs_analysis
[0m17:56:40.964658 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.new_pairs_analysis"
[0m17:56:40.969430 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.new_pairs_analysis: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.new_pairs_analysis"} */


  create view `bitcoin`.`new_pairs_analysis` 
  
    
    
  as (
    

WITH pair_metrics AS (
  SELECT
    id AS pair_address,
    token0_symbol || '-' || token1_symbol AS pair_name,
    parseDateTimeBestEffort(created_at_timestamp) AS creation_time,
    created_at_block_number,
    token0_id,
    token1_id,
    reserve_u_s_d,
    reserve_e_t_h,
    reserve_u_s_d / NULLIF(reserve_e_t_h, 0) AS usd_per_eth_price,
    -- Calculate hourly age of the pair
    dateDiff('hour', creation_time, now()) AS hours_since_creation
  FROM `bitcoin`.`pairs_recently_created`
)

SELECT
  pair_address,
  pair_name,
  creation_time,
  hours_since_creation,
  reserve_u_s_d AS total_liquidity_usd,
  reserve_e_t_h AS total_liquidity_eth,
  usd_per_eth_price,
  CASE
    WHEN reserve_u_s_d > 1000000 THEN 'Large'
    WHEN reserve_u_s_d > 100000 THEN 'Medium'
    ELSE 'Small'
  END AS liquidity_size,
  -- Normalize by pair age
  reserve_u_s_d / NULLIF(hours_since_creation, 0) AS hourly_liquidity_growth_usd
FROM pair_metrics
ORDER BY creation_time DESC
  )...
[0m17:56:41.014121 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:56:41.183950 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.new_pairs_analysis (execute): 17:56:40.763391 => 17:56:41.182775
[0m17:56:41.188018 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66567faf-3be5-40aa-b5f3-653563f46bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7647e48880>]}
[0m17:56:41.192227 [info ] [Thread-1  ]: 1 of 1 OK created sql view model `bitcoin`.`new_pairs_analysis` ................ [[32mOK[0m in 0.50s]
[0m17:56:41.197155 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.new_pairs_analysis
[0m17:56:41.208216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:41.211391 [debug] [MainThread]: Connection 'model.bitcoin_etl.new_pairs_analysis' was left open.
[0m17:56:41.214198 [debug] [MainThread]: On model.bitcoin_etl.new_pairs_analysis: Close
[0m17:56:41.217533 [info ] [MainThread]: 
[0m17:56:41.220520 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m17:56:41.226373 [debug] [MainThread]: Command end result
[0m17:56:41.285265 [info ] [MainThread]: 
[0m17:56:41.290229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:41.294713 [info ] [MainThread]: 
[0m17:56:41.301628 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:56:41.308285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.680271, "process_user_time": 21.516357, "process_kernel_time": 1.398874, "process_mem_max_rss": "197668", "process_out_blocks": "3032", "process_in_blocks": "0"}
[0m17:56:41.314453 [debug] [MainThread]: Command `dbt run` succeeded at 17:56:41.313033 after 7.69 seconds
[0m17:56:41.318144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ab1d2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a8f5a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f769ae3e040>]}
[0m17:56:41.321298 [debug] [MainThread]: Flushing usage events
[0m18:16:19.169225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e7c2a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e60086d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e59f5b80>]}


============================== 18:16:19.196705 | 9a2c0ba1-5b00-4621-87ef-30d695916ed8 ==============================
[0m18:16:19.196705 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:16:19.200214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models bitcoin.pairs_recently_created', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:16:20.612935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a2c0ba1-5b00-4621-87ef-30d695916ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e60086d0>]}
[0m18:16:21.169028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a2c0ba1-5b00-4621-87ef-30d695916ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e57abcd0>]}
[0m18:16:21.174594 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m18:16:21.243228 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:16:21.405911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:16:21.409573 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/pairs_recently_created.sql
[0m18:16:21.416818 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/schema.yml
[0m18:16:23.891610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a2c0ba1-5b00-4621-87ef-30d695916ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bf9330d0>]}
[0m18:16:24.027244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a2c0ba1-5b00-4621-87ef-30d695916ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e565c670>]}
[0m18:16:24.031405 [info ] [MainThread]: Found 9 models, 16 tests, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m18:16:24.036818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a2c0ba1-5b00-4621-87ef-30d695916ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e565c2e0>]}
[0m18:16:24.048212 [info ] [MainThread]: 
[0m18:16:24.053969 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:16:24.061185 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:16:24.138535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:26.472301 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:16:26.484086 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:16:26.496984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__bitcoin)
[0m18:16:26.531680 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m18:16:26.588463 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m18:16:26.603771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin, now list__bitcoin_default)
[0m18:16:26.630793 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m18:16:26.683720 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m18:16:26.694745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a2c0ba1-5b00-4621-87ef-30d695916ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e585adc0>]}
[0m18:16:26.698623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:26.700715 [info ] [MainThread]: 
[0m18:16:26.745139 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.pairs_recently_created
[0m18:16:26.752645 [info ] [Thread-1  ]: 1 of 1 START sql view model `bitcoin`.`pairs_recently_created` ................. [RUN]
[0m18:16:26.760571 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin_default, now model.bitcoin_etl.pairs_recently_created)
[0m18:16:26.767005 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.pairs_recently_created
[0m18:16:26.833108 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.pairs_recently_created"
[0m18:16:26.838338 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pairs_recently_created (compile): 18:16:26.770204 => 18:16:26.836440
[0m18:16:26.841805 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.pairs_recently_created
[0m18:16:27.047566 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.pairs_recently_created"
[0m18:16:27.051637 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */


  create view `bitcoin`.`pairs_recently_created__dbt_backup` 
  
    
    
  as (
    

SELECT
    net_id as pair_id,
    parseDateTimeBestEffort(created_at_timestamp) as created_at_timestamp,
    created_at_block_number,
    token0_symbol,
    token0_id,
    token1_symbol,
    token1_id,
    reserve_u_s_d,
    reserve_e_t_h,
    -- Calculate derived metrics
    reserve_u_s_d as total_liquidity_usd,
    reserve_e_t_h as total_liquidity_eth,
    -- Add pair identifier
    concat(token0_symbol, '-', token1_symbol) as pair_symbol
FROM `bitcoin`.`pairs_recently_created`
  )...
[0m18:16:27.099130 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */


  create view `bitcoin`.`pairs_recently_created__dbt_backup` 
  
    
    
  as (
    

SELECT
    net_id as pair_id,
    parseDateTimeBestEffort(created_at_timestamp) as created_at_timestamp,
    created_at_block_number,
    token0_symbol,
    token0_id,
    token1_symbol,
    token1_id,
    reserve_u_s_d,
    reserve_e_t_h,
    -- Calculate derived metrics
    reserve_u_s_d as total_liquidity_usd,
    reserve_e_t_h as total_liquidity_eth,
    -- Add pair identifier
    concat(token0_symbol, '-', token1_symbol) as pair_symbol
FROM `bitcoin`.`pairs_recently_created`
  )
[0m18:16:27.102189 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pairs_recently_created (execute): 18:16:26.844391 => 18:16:27.101024
[0m18:16:27.129701 [debug] [Thread-1  ]: Database Error in model pairs_recently_created (models/bitcoin/pairs_recently_created.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Unknown expression identifier `net_id` in scope SELECT net_id AS pair_id, parseDateTimeBestEffort(created_at_timestamp) AS created_at_timestamp, created_at_block_number, token0_symbol, token0_id, token1_symbol, token1_id, reserve_u_s_d, reserve_e_t_h, reserve_u_s_d AS total_liquidity_usd, reserve_e_t_h AS total_liquidity_eth, concat(token0_symbol, '-', token1_symbol) AS pair_symbol FROM bitcoin.pairs_recently_created. (UNKNOWN_IDENTIFIER) (version 25.3.2.39 (official build))
  compiled Code at target/run/bitcoin_etl/models/bitcoin/pairs_recently_created.sql
[0m18:16:27.132620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a2c0ba1-5b00-4621-87ef-30d695916ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0888849190>]}
[0m18:16:27.135987 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model `bitcoin`.`pairs_recently_created` ........ [[31mERROR[0m in 0.38s]
[0m18:16:27.141214 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.pairs_recently_created
[0m18:16:27.153676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:27.157574 [debug] [MainThread]: Connection 'model.bitcoin_etl.pairs_recently_created' was left open.
[0m18:16:27.161186 [debug] [MainThread]: On model.bitcoin_etl.pairs_recently_created: Close
[0m18:16:27.164102 [info ] [MainThread]: 
[0m18:16:27.167228 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m18:16:27.178207 [debug] [MainThread]: Command end result
[0m18:16:27.233331 [info ] [MainThread]: 
[0m18:16:27.236382 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:16:27.240697 [info ] [MainThread]: 
[0m18:16:27.245619 [error] [MainThread]:   Database Error in model pairs_recently_created (models/bitcoin/pairs_recently_created.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Unknown expression identifier `net_id` in scope SELECT net_id AS pair_id, parseDateTimeBestEffort(created_at_timestamp) AS created_at_timestamp, created_at_block_number, token0_symbol, token0_id, token1_symbol, token1_id, reserve_u_s_d, reserve_e_t_h, reserve_u_s_d AS total_liquidity_usd, reserve_e_t_h AS total_liquidity_eth, concat(token0_symbol, '-', token1_symbol) AS pair_symbol FROM bitcoin.pairs_recently_created. (UNKNOWN_IDENTIFIER) (version 25.3.2.39 (official build))
  compiled Code at target/run/bitcoin_etl/models/bitcoin/pairs_recently_created.sql
[0m18:16:27.249545 [info ] [MainThread]: 
[0m18:16:27.253586 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:16:27.260135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.419066, "process_user_time": 18.95315, "process_kernel_time": 1.373852, "process_mem_max_rss": "193360", "process_in_blocks": "24", "process_out_blocks": "3056", "command_success": false}
[0m18:16:27.264448 [debug] [MainThread]: Command `dbt run` failed at 18:16:27.263637 after 8.42 seconds
[0m18:16:27.267775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e7c2a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e57ab700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e60086d0>]}
[0m18:16:27.272079 [debug] [MainThread]: Flushing usage events
[0m18:21:18.379166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2a6d6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb28558f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb28558550>]}


============================== 18:21:18.415633 | 0ca266fd-adca-40ba-919b-6b52a73ff4bd ==============================
[0m18:21:18.415633 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:21:18.419363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models bitcoin.pairs_recently_created', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:21:19.455270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ca266fd-adca-40ba-919b-6b52a73ff4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2ac23b80>]}
[0m18:21:19.865356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ca266fd-adca-40ba-919b-6b52a73ff4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb28514e80>]}
[0m18:21:19.869699 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m18:21:19.927213 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:21:20.134234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:21:20.153098 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/schema.yml
[0m18:21:20.158246 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/pairs_recently_created.sql
[0m18:21:22.750741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ca266fd-adca-40ba-919b-6b52a73ff4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb26456df0>]}
[0m18:21:22.829084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ca266fd-adca-40ba-919b-6b52a73ff4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb264d49a0>]}
[0m18:21:22.832022 [info ] [MainThread]: Found 9 models, 11 tests, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m18:21:22.834718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ca266fd-adca-40ba-919b-6b52a73ff4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb264602b0>]}
[0m18:21:22.843621 [info ] [MainThread]: 
[0m18:21:22.849565 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:21:22.855592 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:21:22.918189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:24.420246 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:21:24.435080 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:21:24.451765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__bitcoin_default)
[0m18:21:24.498168 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m18:21:24.554718 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m18:21:24.564907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_default, now list__bitcoin)
[0m18:21:24.583062 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m18:21:24.640627 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m18:21:24.666080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ca266fd-adca-40ba-919b-6b52a73ff4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffac75aaf70>]}
[0m18:21:24.669807 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:21:24.672389 [info ] [MainThread]: 
[0m18:21:24.695986 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.pairs_recently_created
[0m18:21:24.699038 [info ] [Thread-1  ]: 1 of 1 START sql view model `bitcoin`.`pairs_recently_created` ................. [RUN]
[0m18:21:24.706354 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin, now model.bitcoin_etl.pairs_recently_created)
[0m18:21:24.709880 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.pairs_recently_created
[0m18:21:24.758011 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.pairs_recently_created"
[0m18:21:24.764145 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pairs_recently_created (compile): 18:21:24.712128 => 18:21:24.761688
[0m18:21:24.767032 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.pairs_recently_created
[0m18:21:24.982694 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.pairs_recently_created"
[0m18:21:24.986170 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */


  create view `bitcoin`.`pairs_recently_created__dbt_backup` 
  
    
    
  as (
    

SELECT
    id as pair_id,  -- Changed from net_id to id
    parseDateTimeBestEffort(created_at_timestamp) as created_at_timestamp,
    created_at_block_number,
    token0_symbol,
    token0_id,
    token1_symbol,
    token1_id,
    reserve_u_s_d as total_liquidity_usd,
    reserve_e_t_h as total_liquidity_eth,
    concat(token0_symbol, '-', token1_symbol) as pair_symbol
FROM `bitcoin`.`pairs_recently_created`
  )...
[0m18:21:25.012274 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:21:25.041577 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */
EXCHANGE TABLES `bitcoin`.`pairs_recently_created__dbt_backup` AND `bitcoin`.`pairs_recently_created` 
  
  ...
[0m18:21:25.060255 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */
EXCHANGE TABLES `bitcoin`.`pairs_recently_created__dbt_backup` AND `bitcoin`.`pairs_recently_created` 
  
  
[0m18:21:25.063285 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pairs_recently_created (execute): 18:21:24.768761 => 18:21:25.062019
[0m18:21:25.073440 [debug] [Thread-1  ]: Database Error in model pairs_recently_created (models/bitcoin/pairs_recently_created.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 269
   Code: 269. DB::Exception: Cannot exchange 'bitcoin.pairs_recently_created__dbt_backup' and 'bitcoin.pairs_recently_created', because it will lead to cyclic dependencies: bitcoin.pairs_recently_created -> [bitcoin.pairs_recently_created]; bitcoin.new_pairs_analysis -> [bitcoin.pairs_recently_created]. (INFINITE_LOOP) (version 25.3.2.39 (official build))
  compiled Code at target/run/bitcoin_etl/models/bitcoin/pairs_recently_created.sql
[0m18:21:25.077477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca266fd-adca-40ba-919b-6b52a73ff4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2c287550>]}
[0m18:21:25.082234 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model `bitcoin`.`pairs_recently_created` ........ [[31mERROR[0m in 0.37s]
[0m18:21:25.087387 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.pairs_recently_created
[0m18:21:25.097340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:21:25.099639 [debug] [MainThread]: Connection 'model.bitcoin_etl.pairs_recently_created' was left open.
[0m18:21:25.101630 [debug] [MainThread]: On model.bitcoin_etl.pairs_recently_created: Close
[0m18:21:25.104302 [info ] [MainThread]: 
[0m18:21:25.108465 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m18:21:25.114502 [debug] [MainThread]: Command end result
[0m18:21:25.172639 [info ] [MainThread]: 
[0m18:21:25.176175 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:21:25.179177 [info ] [MainThread]: 
[0m18:21:25.183271 [error] [MainThread]:   Database Error in model pairs_recently_created (models/bitcoin/pairs_recently_created.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 269
   Code: 269. DB::Exception: Cannot exchange 'bitcoin.pairs_recently_created__dbt_backup' and 'bitcoin.pairs_recently_created', because it will lead to cyclic dependencies: bitcoin.pairs_recently_created -> [bitcoin.pairs_recently_created]; bitcoin.new_pairs_analysis -> [bitcoin.pairs_recently_created]. (INFINITE_LOOP) (version 25.3.2.39 (official build))
  compiled Code at target/run/bitcoin_etl/models/bitcoin/pairs_recently_created.sql
[0m18:21:25.188699 [info ] [MainThread]: 
[0m18:21:25.192202 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:21:25.198490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.051656, "process_user_time": 20.98893, "process_kernel_time": 1.606092, "process_mem_max_rss": "191516", "process_in_blocks": "440", "process_out_blocks": "2984", "command_success": false}
[0m18:21:25.206248 [debug] [MainThread]: Command `dbt run` failed at 18:21:25.204257 after 7.06 seconds
[0m18:21:25.210530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb2a6d6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb264d49a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb28514e80>]}
[0m18:21:25.213377 [debug] [MainThread]: Flushing usage events
[0m18:26:23.272995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9820e5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97fef7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97fef70d0>]}


============================== 18:26:23.313912 | bc23c997-c31a-4291-b9ca-427f64cb822a ==============================
[0m18:26:23.313912 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:26:23.317966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m18:26:24.125417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc23c997-c31a-4291-b9ca-427f64cb822a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97fef7280>]}
[0m18:26:24.149094 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 1.1849624, "process_user_time": 14.026048, "process_kernel_time": 0.420181, "process_mem_max_rss": "100452", "process_in_blocks": "128", "process_out_blocks": "8"}
[0m18:26:24.153180 [debug] [MainThread]: Command `dbt clean` succeeded at 18:26:24.152021 after 1.19 seconds
[0m18:26:24.156961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9820e5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97fefcfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97fe08340>]}
[0m18:26:24.160070 [debug] [MainThread]: Flushing usage events
[0m18:26:43.162155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9bdcf340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a99c51f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a99c51550>]}


============================== 18:26:43.196046 | ca420f0a-5274-4450-ba59-505cb22ecf82 ==============================
[0m18:26:43.196046 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:26:43.200426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --models bitcoin.pairs_recently_created', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:26:44.232755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca420f0a-5274-4450-ba59-505cb22ecf82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9e8f9460>]}
[0m18:26:44.655944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca420f0a-5274-4450-ba59-505cb22ecf82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a99c0de80>]}
[0m18:26:44.659279 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m18:26:44.697244 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:26:44.699576 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:26:44.701654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca420f0a-5274-4450-ba59-505cb22ecf82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a99937ee0>]}
[0m18:26:44.736496 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading bitcoin_etl: bitcoin/schema.yml - Runtime Error
    Syntax error near line 87
    ------------------------------
    84 |               min: 0
    85 |               max: 1
    86 | 
    87 |   models:
    88 |   - name: pairs_recently_created
    89 |     description: "New trading pairs created on DEX (derived table)"
    90 |     config:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 68, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 87, column 3
[0m18:26:44.742767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9138689, "process_user_time": 14.201995, "process_kernel_time": 0.550464, "process_mem_max_rss": "103252", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m18:26:44.757151 [debug] [MainThread]: Command `dbt run` failed at 18:26:44.755910 after 1.93 seconds
[0m18:26:44.760420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9bdcf340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a99a96bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9996ea30>]}
[0m18:26:44.763241 [debug] [MainThread]: Flushing usage events
[0m18:29:09.542184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ff9cd9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ffa1dabb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ff7aa45e0>]}


============================== 18:29:09.579427 | 89f6425b-ec43-4b06-98e9-26446f7f26cc ==============================
[0m18:29:09.579427 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:29:09.584821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --models bitcoin.pairs_recently_created', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:29:10.488232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89f6425b-ec43-4b06-98e9-26446f7f26cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ffc877c40>]}
[0m18:29:11.050167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89f6425b-ec43-4b06-98e9-26446f7f26cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ff799a9a0>]}
[0m18:29:11.053989 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m18:29:11.092806 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:29:11.095165 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:29:11.097055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '89f6425b-ec43-4b06-98e9-26446f7f26cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ff77eb3a0>]}
[0m18:29:19.479958 [error] [MainThread]: Encountered an error:
Compilation Error in model pairs_recently_created (models/bitcoin/pairs_recently_created.sql)
  unexpected char '#' at 40
    line 3
      materialized='table',  # Changed from view to table to avoid circular references
[0m18:29:19.485915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.162861, "process_user_time": 22.166975, "process_kernel_time": 0.500157, "process_mem_max_rss": "108044", "process_in_blocks": "96", "process_out_blocks": "8", "command_success": false}
[0m18:29:19.490518 [debug] [MainThread]: Command `dbt run` failed at 18:29:19.489175 after 10.17 seconds
[0m18:29:19.493956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ff9cd9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ff5d82490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ff5d824c0>]}
[0m18:29:19.497235 [debug] [MainThread]: Flushing usage events
[0m18:30:33.911192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d04f2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ce374d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ce3744c0>]}


============================== 18:30:33.936082 | 4106e820-fdd4-4426-9a72-8230f25d842b ==============================
[0m18:30:33.936082 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:30:33.939302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --models bitcoin.pairs_recently_created', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:30:35.623645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4106e820-fdd4-4426-9a72-8230f25d842b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d301c460>]}
[0m18:30:36.217956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4106e820-fdd4-4426-9a72-8230f25d842b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ce1b9160>]}
[0m18:30:36.225233 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m18:30:36.316024 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:30:36.320725 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:30:36.324552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4106e820-fdd4-4426-9a72-8230f25d842b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ce04a880>]}
[0m18:30:49.413840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4106e820-fdd4-4426-9a72-8230f25d842b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30cc32f0d0>]}
[0m18:30:49.506942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4106e820-fdd4-4426-9a72-8230f25d842b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ce0d10a0>]}
[0m18:30:49.510231 [info ] [MainThread]: Found 9 models, 11 tests, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m18:30:49.513216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4106e820-fdd4-4426-9a72-8230f25d842b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ce04a2b0>]}
[0m18:30:49.525731 [info ] [MainThread]: 
[0m18:30:49.537897 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:30:49.546846 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:30:49.640651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:52.281127 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:30:52.293320 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:30:52.305850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__bitcoin_bitcoin_derived)
[0m18:30:52.339004 [debug] [ThreadPool]: Creating schema "schema: "bitcoin_bitcoin_derived"
"
[0m18:30:52.391798 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__bitcoin_bitcoin_derived: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "create__bitcoin_bitcoin_derived"} */
create database if not exists `bitcoin_bitcoin_derived`
        
  
        
  ...
[0m18:30:52.670877 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.28 seconds
[0m18:30:52.688306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__bitcoin_bitcoin_derived, now list__bitcoin_bitcoin_derived)
[0m18:30:52.748940 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_bitcoin_derived: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_bitcoin_derived"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_bitcoin_derived'
      

  ...
[0m18:30:52.813278 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m18:30:52.826292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_bitcoin_derived, now list__bitcoin_default)
[0m18:30:52.847501 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m18:30:52.913071 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m18:30:52.926628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_default, now list__bitcoin)
[0m18:30:52.942953 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m18:30:52.996133 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m18:30:53.052408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4106e820-fdd4-4426-9a72-8230f25d842b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30cc369580>]}
[0m18:30:53.057885 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:53.065266 [info ] [MainThread]: 
[0m18:30:53.117077 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.pairs_recently_created
[0m18:30:53.121068 [info ] [Thread-1  ]: 1 of 1 START sql table model `bitcoin_bitcoin_derived`.`pairs_recently_created`  [RUN]
[0m18:30:53.125956 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin, now model.bitcoin_etl.pairs_recently_created)
[0m18:30:53.130406 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.pairs_recently_created
[0m18:30:53.220977 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.pairs_recently_created"
[0m18:30:53.232054 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pairs_recently_created (compile): 18:30:53.133762 => 18:30:53.229322
[0m18:30:53.235887 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.pairs_recently_created
[0m18:30:53.402178 [debug] [Thread-1  ]: Creating new relation pairs_recently_created
[0m18:30:53.612757 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */

            

    
        create table `bitcoin_bitcoin_derived`.`pairs_recently_created`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

SELECT
    id as pair_id,
    parseDateTimeBestEffort(created_at_timestamp) as created_at_timestamp,
    created_at_block_number,
    token0_symbol,
    token0_id,
    token1_symbol,
    token1_id,
    reserve_u_s_d as total_liquidity_usd,
    reserve_e_t_h as total_liquidity_eth,
    concat(token0_symbol, '-', token1_symbol) as pair_symbol
FROM `bitcoin`.`pairs_recently_created`
          )
        ...
[0m18:30:53.772343 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.16 seconds
[0m18:30:53.832340 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */

    select name, type from system.columns where table = 'pairs_recently_created'
    
      and database = 'bitcoin_bitcoin_derived'
    
    order by position
  ...
[0m18:30:53.849329 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:30:53.874291 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.pairs_recently_created"
[0m18:30:53.882850 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */

  
    
    
    
        
        insert into `bitcoin_bitcoin_derived`.`pairs_recently_created`
        ("pair_id", "created_at_timestamp", "created_at_block_number", "token0_symbol", "token0_id", "token1_symbol", "token1_id", "total_liquidity_usd", "total_liquidity_eth", "pair_symbol")

SELECT
    id as pair_id,
    parseDateTimeBestEffort(created_at_timestamp) as created_at_timestamp,
    created_at_block_number,
    token0_symbol,
    token0_id,
    token1_symbol,
    token1_id,
    reserve_u_s_d as total_liquidity_usd,
    reserve_e_t_h as total_liquidity_eth,
    concat(token0_symbol, '-', token1_symbol) as pair_symbol
FROM `bitcoin`.`pairs_recently_created`
  
  ...
[0m18:30:53.940442 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m18:30:54.058902 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pairs_recently_created (execute): 18:30:53.238190 => 18:30:54.057333
[0m18:30:54.063964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4106e820-fdd4-4426-9a72-8230f25d842b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3071169610>]}
[0m18:30:54.068448 [info ] [Thread-1  ]: 1 of 1 OK created sql table model `bitcoin_bitcoin_derived`.`pairs_recently_created`  [[32mOK[0m in 0.94s]
[0m18:30:54.073190 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.pairs_recently_created
[0m18:30:54.085557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:54.088551 [debug] [MainThread]: Connection 'model.bitcoin_etl.pairs_recently_created' was left open.
[0m18:30:54.091752 [debug] [MainThread]: On model.bitcoin_etl.pairs_recently_created: Close
[0m18:30:54.095670 [info ] [MainThread]: 
[0m18:30:54.098927 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m18:30:54.105458 [debug] [MainThread]: Command end result
[0m18:30:54.157406 [info ] [MainThread]: 
[0m18:30:54.161654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:30:54.166301 [info ] [MainThread]: 
[0m18:30:54.169215 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:30:54.175299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.462564, "process_user_time": 32.81423, "process_kernel_time": 1.562582, "process_mem_max_rss": "214444", "process_in_blocks": "16", "process_out_blocks": "2976"}
[0m18:30:54.179635 [debug] [MainThread]: Command `dbt run` succeeded at 18:30:54.178625 after 20.47 seconds
[0m18:30:54.182662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d04f2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30711d3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ce1b9160>]}
[0m18:30:54.186055 [debug] [MainThread]: Flushing usage events
[0m18:55:13.327645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ea635760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e846b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e846bb50>]}


============================== 18:55:13.356549 | d39ca2e8-3284-484f-b131-ca7a8e994421 ==============================
[0m18:55:13.356549 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:55:13.359656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --models bitcoin.swaps_latest_for_pair', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:55:14.436709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd39ca2e8-3284-484f-b131-ca7a8e994421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e839df10>]}
[0m18:55:14.897920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd39ca2e8-3284-484f-b131-ca7a8e994421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e8147c10>]}
[0m18:55:14.900699 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m18:55:14.945363 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:55:15.151059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:55:15.154141 [debug] [MainThread]: Partial parsing: added file: bitcoin_etl://models/bitcoin/swaps_latest_for_pair.sql
[0m18:55:15.159589 [debug] [MainThread]: Partial parsing: updated file: bitcoin_etl://models/bitcoin/schema.yml
[0m18:55:16.759478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd39ca2e8-3284-484f-b131-ca7a8e994421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e6317940>]}
[0m18:55:16.811254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd39ca2e8-3284-484f-b131-ca7a8e994421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e805db50>]}
[0m18:55:16.812670 [info ] [MainThread]: Found 10 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m18:55:16.813786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd39ca2e8-3284-484f-b131-ca7a8e994421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e8400ac0>]}
[0m18:55:16.817218 [info ] [MainThread]: 
[0m18:55:16.819391 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:55:16.823621 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:55:16.849726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:18.934522 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:55:18.940647 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:55:18.947889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__bitcoin_default)
[0m18:55:18.964804 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m18:55:19.029225 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m18:55:19.033530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_default, now list__bitcoin_bitcoin_derived)
[0m18:55:19.041673 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_bitcoin_derived: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_bitcoin_derived"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_bitcoin_derived'
      

  ...
[0m18:55:19.071082 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:55:19.076589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_bitcoin_derived, now list__bitcoin)
[0m18:55:19.084624 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m18:55:19.115915 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:55:19.133198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd39ca2e8-3284-484f-b131-ca7a8e994421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e61c73d0>]}
[0m18:55:19.136400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:19.138302 [info ] [MainThread]: 
[0m18:55:19.156611 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.swaps_latest_for_pair
[0m18:55:19.159601 [info ] [Thread-1  ]: 1 of 1 START sql view model `bitcoin_bitcoin_derived`.`swaps_latest_for_pair` .. [RUN]
[0m18:55:19.163722 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin, now model.bitcoin_etl.swaps_latest_for_pair)
[0m18:55:19.167260 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.swaps_latest_for_pair
[0m18:55:19.209147 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.swaps_latest_for_pair"
[0m18:55:19.212030 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.swaps_latest_for_pair (compile): 18:55:19.168415 => 18:55:19.211119
[0m18:55:19.213729 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.swaps_latest_for_pair
[0m18:55:19.292390 [debug] [Thread-1  ]: Creating new relation swaps_latest_for_pair
[0m18:55:19.333302 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.swaps_latest_for_pair"
[0m18:55:19.336300 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.swaps_latest_for_pair: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.swaps_latest_for_pair"} */


  create view `bitcoin_bitcoin_derived`.`swaps_latest_for_pair` 
  
    
    
  as (
    

SELECT
    id as swap_id,
    transaction_id,
    parseDateTimeBestEffort(transaction_timestamp) as transaction_timestamp,
    pair_token0_symbol,
    pair_token1_symbol,
    amount0_in,
    amount1_in,
    amount0_out,
    amount1_out,
    amount_u_s_d as amount_usd,
    -- Calculate derived metrics
    concat(pair_token0_symbol, '-', pair_token1_symbol) as pair_symbol,
    CASE 
        WHEN amount0_in > 0 THEN pair_token0_symbol
        WHEN amount1_in > 0 THEN pair_token1_symbol
        ELSE NULL
    END as token_in_symbol,
    CASE 
        WHEN amount0_out > 0 THEN pair_token0_symbol
        WHEN amount1_out > 0 THEN pair_token1_symbol
        ELSE NULL
    END as token_out_symbol,
    -- Calculate absolute amounts
    greatest(amount0_in, amount1_in) as amount_in,
    greatest(amount0_out, amount1_out) as amount_out,
    -- Calculate swap direction
    CASE
        WHEN amount0_in > 0 AND amount1_out > 0 THEN 'token0_to_token1'
        WHEN amount1_in > 0 AND amount0_out > 0 THEN 'token1_to_token0'
        ELSE 'complex'
    END as swap_direction
FROM `bitcoin`.`swaps_latest_for_pair`
  )...
[0m18:55:19.376348 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m18:55:19.478089 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.swaps_latest_for_pair (execute): 18:55:19.214701 => 18:55:19.477213
[0m18:55:19.480789 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ca2e8-3284-484f-b131-ca7a8e994421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6887200e20>]}
[0m18:55:19.483199 [info ] [Thread-1  ]: 1 of 1 OK created sql view model `bitcoin_bitcoin_derived`.`swaps_latest_for_pair`  [[32mOK[0m in 0.32s]
[0m18:55:19.485935 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.swaps_latest_for_pair
[0m18:55:19.492154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:19.495347 [debug] [MainThread]: Connection 'model.bitcoin_etl.swaps_latest_for_pair' was left open.
[0m18:55:19.498494 [debug] [MainThread]: On model.bitcoin_etl.swaps_latest_for_pair: Close
[0m18:55:19.502240 [info ] [MainThread]: 
[0m18:55:19.506042 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m18:55:19.510349 [debug] [MainThread]: Command end result
[0m18:55:19.553127 [info ] [MainThread]: 
[0m18:55:19.557440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:19.560382 [info ] [MainThread]: 
[0m18:55:19.563678 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:55:19.570951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4121137, "process_user_time": 14.099487, "process_kernel_time": 3.128902, "process_mem_max_rss": "217900", "process_in_blocks": "72", "process_out_blocks": "3152"}
[0m18:55:19.574979 [debug] [MainThread]: Command `dbt run` succeeded at 18:55:19.573962 after 6.42 seconds
[0m18:55:19.577686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ea635760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e81ec910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688720b0a0>]}
[0m18:55:19.580243 [debug] [MainThread]: Flushing usage events
[0m16:36:07.746280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3df1b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3bb021f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3bb02940>]}


============================== 16:36:07.807796 | 83b6fc98-fc58-4f35-bb11-5a031c8d2b4b ==============================
[0m16:36:07.807796 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:36:07.809670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:36:07.811375 [info ] [MainThread]: dbt version: 1.7.11
[0m16:36:07.812698 [info ] [MainThread]: python version: 3.9.18
[0m16:36:07.813826 [info ] [MainThread]: python path: /usr/local/bin/python
[0m16:36:07.815179 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m16:36:08.145834 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m16:36:08.147796 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m16:36:08.149754 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m16:36:08.155465 [info ] [MainThread]: adapter type: clickhouse
[0m16:36:08.157230 [info ] [MainThread]: adapter version: 1.7.0
[0m16:36:08.454242 [info ] [MainThread]: Configuration:
[0m16:36:08.455595 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:36:08.456715 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:36:08.457856 [info ] [MainThread]: Required dependencies:
[0m16:36:08.459066 [debug] [MainThread]: Executing "git --help"
[0m16:36:08.515994 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:36:08.520795 [debug] [MainThread]: STDERR: "b''"
[0m16:36:08.522615 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:36:08.524338 [info ] [MainThread]: Connection:
[0m16:36:08.526087 [info ] [MainThread]:   driver: None
[0m16:36:08.527541 [info ] [MainThread]:   host: clickhouse
[0m16:36:08.528872 [info ] [MainThread]:   port: 8123
[0m16:36:08.530083 [info ] [MainThread]:   user: admin
[0m16:36:08.532257 [info ] [MainThread]:   schema: bitcoin
[0m16:36:08.533995 [info ] [MainThread]:   retries: 1
[0m16:36:08.535610 [info ] [MainThread]:   database_engine: None
[0m16:36:08.537174 [info ] [MainThread]:   cluster_mode: False
[0m16:36:08.538875 [info ] [MainThread]:   secure: False
[0m16:36:08.540464 [info ] [MainThread]:   verify: True
[0m16:36:08.542031 [info ] [MainThread]:   connect_timeout: 10
[0m16:36:08.543563 [info ] [MainThread]:   send_receive_timeout: 300
[0m16:36:08.545063 [info ] [MainThread]:   sync_request_timeout: 5
[0m16:36:08.546935 [info ] [MainThread]:   compress_block_size: 1048576
[0m16:36:08.549857 [info ] [MainThread]:   compression: 
[0m16:36:08.552242 [info ] [MainThread]:   check_exchange: True
[0m16:36:08.553921 [info ] [MainThread]:   custom_settings: None
[0m16:36:08.555853 [info ] [MainThread]:   use_lw_deletes: False
[0m16:36:08.557933 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m16:36:08.559687 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m16:36:08.562638 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m16:36:08.564050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:09.917332 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m16:36:09.925496 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:36:09.928740 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:36:09.930293 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:36:09.934177 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.4568355, "process_user_time": 11.626314, "process_kernel_time": 5.919043, "process_mem_max_rss": "219348", "process_in_blocks": "2120", "process_out_blocks": "3088"}
[0m16:36:09.936472 [debug] [MainThread]: Command `dbt debug` succeeded at 16:36:09.935909 after 2.46 seconds
[0m16:36:09.938379 [debug] [MainThread]: Connection 'debug' was left open.
[0m16:36:09.939719 [debug] [MainThread]: On debug: Close
[0m16:36:09.941328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3df1b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3b9d9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3b9d9e20>]}
[0m16:36:09.942917 [debug] [MainThread]: Flushing usage events
[0m16:36:21.683393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94ee1a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94cc9cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94cc9cc40>]}


============================== 16:36:21.699675 | 0d3b0406-674e-471e-a7a1-0efa375c53a6 ==============================
[0m16:36:21.699675 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:36:21.701616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:25.461733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94f368b80>]}
[0m16:36:25.758068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94cc55e80>]}
[0m16:36:25.760103 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m16:36:26.120018 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:36:28.505753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:28.507060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:28.531787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94c73a0d0>]}
[0m16:36:28.607318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94c834100>]}
[0m16:36:28.608760 [info ] [MainThread]: Found 10 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m16:36:28.610069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94cb129a0>]}
[0m16:36:28.616794 [info ] [MainThread]: 
[0m16:36:28.619256 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:36:28.623237 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:36:28.654079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:31.281413 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:36:31.399860 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.12 seconds
[0m16:36:31.415791 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:36:31.422888 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:36:31.436257 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:36:31.588374 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.15 seconds
[0m16:36:31.600259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__bitcoin_bitcoin_derived)
[0m16:36:31.632901 [debug] [ThreadPool]: Creating schema "schema: "bitcoin_bitcoin_derived"
"
[0m16:36:31.659016 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__bitcoin_bitcoin_derived: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "create__bitcoin_bitcoin_derived"} */
create database if not exists `bitcoin_bitcoin_derived`
        
  
        
  ...
[0m16:36:32.540300 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.83 seconds
[0m16:36:32.546238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__bitcoin_bitcoin_derived, now create__bitcoin_default)
[0m16:36:32.549644 [debug] [ThreadPool]: Creating schema "schema: "bitcoin_default"
"
[0m16:36:32.561412 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "create__bitcoin_default"} */
create database if not exists `bitcoin_default`
        
  
        
  ...
[0m16:36:33.037222 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.47 seconds
[0m16:36:33.050749 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__bitcoin_bitcoin_derived'
[0m16:36:33.073905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:34.161290 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_bitcoin_derived: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_bitcoin_derived"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_bitcoin_derived'
      

  ...
[0m16:36:35.040014 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.88 seconds
[0m16:36:35.047111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_bitcoin_derived, now list__bitcoin_default)
[0m16:36:35.058307 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m16:36:35.110060 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m16:36:35.117416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_default, now list__bitcoin)
[0m16:36:35.127107 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m16:36:35.430992 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.30 seconds
[0m16:36:35.443485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92154ee50>]}
[0m16:36:35.446319 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:36:35.447927 [info ] [MainThread]: 
[0m16:36:35.727721 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.example
[0m16:36:35.730727 [info ] [Thread-1  ]: 1 of 10 START sql view model `bitcoin`.`example` ............................... [RUN]
[0m16:36:35.733346 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin, now model.bitcoin_etl.example)
[0m16:36:35.734919 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.example
[0m16:36:35.762524 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.example"
[0m16:36:35.880206 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.example (compile): 16:36:35.736018 => 16:36:35.879380
[0m16:36:35.881747 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.example
[0m16:36:35.948464 [debug] [Thread-1  ]: Creating new relation example
[0m16:36:35.972236 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.example"
[0m16:36:36.140522 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.example: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.example"} */


  create view `bitcoin`.`example` 
  
    
    
  as (
    

SELECT 
    transaction_id AS tx_hash,
    transaction_timestamp AS timestamp,
    pair_token0_symbol,
    pair_token1_symbol,
    amount_u_s_d AS value_usd,
    amount0_in,
    amount1_in,
    amount0_out,
    amount1_out
FROM `bitcoin`.`swaps_latest`
  )...
[0m16:36:36.766726 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.62 seconds
[0m16:36:36.853974 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.example (execute): 16:36:35.882636 => 16:36:36.853264
[0m16:36:36.856387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9215c8760>]}
[0m16:36:36.858787 [info ] [Thread-1  ]: 1 of 10 OK created sql view model `bitcoin`.`example` .......................... [[32mOK[0m in 1.12s]
[0m16:36:36.860903 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.example
[0m16:36:36.863098 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.new_pairs_analysis
[0m16:36:36.865488 [info ] [Thread-1  ]: 2 of 10 START sql view model `bitcoin`.`new_pairs_analysis` .................... [RUN]
[0m16:36:36.868260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.example, now model.bitcoin_etl.new_pairs_analysis)
[0m16:36:36.869991 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.new_pairs_analysis
[0m16:36:36.884372 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.new_pairs_analysis"
[0m16:36:36.888688 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.new_pairs_analysis (compile): 16:36:36.871220 => 16:36:36.887131
[0m16:36:36.890437 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.new_pairs_analysis
[0m16:36:36.900302 [debug] [Thread-1  ]: Creating new relation new_pairs_analysis
[0m16:36:36.904422 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.new_pairs_analysis"
[0m16:36:36.906411 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.new_pairs_analysis: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.new_pairs_analysis"} */


  create view `bitcoin`.`new_pairs_analysis` 
  
    
    
  as (
    

WITH pair_metrics AS (
  SELECT
    id AS pair_address,
    token0_symbol || '-' || token1_symbol AS pair_name,
    parseDateTimeBestEffort(created_at_timestamp) AS creation_time,
    created_at_block_number,
    token0_id,
    token1_id,
    reserve_u_s_d,
    reserve_e_t_h,
    reserve_u_s_d / NULLIF(reserve_e_t_h, 0) AS usd_per_eth_price,
    -- Calculate hourly age of the pair
    dateDiff('hour', creation_time, now()) AS hours_since_creation
  FROM `bitcoin`.`pairs_recently_created`
)

SELECT
  pair_address,
  pair_name,
  creation_time,
  hours_since_creation,
  reserve_u_s_d AS total_liquidity_usd,
  reserve_e_t_h AS total_liquidity_eth,
  usd_per_eth_price,
  CASE
    WHEN reserve_u_s_d > 1000000 THEN 'Large'
    WHEN reserve_u_s_d > 100000 THEN 'Medium'
    ELSE 'Small'
  END AS liquidity_size,
  -- Normalize by pair age
  reserve_u_s_d / NULLIF(hours_since_creation, 0) AS hourly_liquidity_growth_usd
FROM pair_metrics
ORDER BY creation_time DESC
  )...
[0m16:36:36.956341 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m16:36:36.963463 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.new_pairs_analysis (execute): 16:36:36.891797 => 16:36:36.962717
[0m16:36:36.965723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9215660d0>]}
[0m16:36:36.967772 [info ] [Thread-1  ]: 2 of 10 OK created sql view model `bitcoin`.`new_pairs_analysis` ............... [[32mOK[0m in 0.10s]
[0m16:36:36.971062 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.new_pairs_analysis
[0m16:36:36.973351 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.pairs_recently_created
[0m16:36:36.975750 [info ] [Thread-1  ]: 3 of 10 START sql table model `bitcoin_bitcoin_derived`.`pairs_recently_created`  [RUN]
[0m16:36:36.978340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.new_pairs_analysis, now model.bitcoin_etl.pairs_recently_created)
[0m16:36:36.979852 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.pairs_recently_created
[0m16:36:36.995372 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.pairs_recently_created"
[0m16:36:36.998327 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pairs_recently_created (compile): 16:36:36.980845 => 16:36:36.997173
[0m16:36:37.000497 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.pairs_recently_created
[0m16:36:37.057273 [debug] [Thread-1  ]: Creating new relation pairs_recently_created
[0m16:36:37.147901 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */

            

    
        create table `bitcoin_bitcoin_derived`.`pairs_recently_created`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

SELECT
    id as pair_id,
    parseDateTimeBestEffort(created_at_timestamp) as created_at_timestamp,
    created_at_block_number,
    token0_symbol,
    token0_id,
    token1_symbol,
    token1_id,
    reserve_u_s_d as total_liquidity_usd,
    reserve_e_t_h as total_liquidity_eth,
    concat(token0_symbol, '-', token1_symbol) as pair_symbol
FROM `bitcoin`.`pairs_recently_created`
          )
        ...
[0m16:36:37.203094 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m16:36:37.231627 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */

    select name, type from system.columns where table = 'pairs_recently_created'
    
      and database = 'bitcoin_bitcoin_derived'
    
    order by position
  ...
[0m16:36:37.250736 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m16:36:37.262075 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.pairs_recently_created"
[0m16:36:37.265425 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */

  
    
    
    
        
        insert into `bitcoin_bitcoin_derived`.`pairs_recently_created`
        ("pair_id", "created_at_timestamp", "created_at_block_number", "token0_symbol", "token0_id", "token1_symbol", "token1_id", "total_liquidity_usd", "total_liquidity_eth", "pair_symbol")

SELECT
    id as pair_id,
    parseDateTimeBestEffort(created_at_timestamp) as created_at_timestamp,
    created_at_block_number,
    token0_symbol,
    token0_id,
    token1_symbol,
    token1_id,
    reserve_u_s_d as total_liquidity_usd,
    reserve_e_t_h as total_liquidity_eth,
    concat(token0_symbol, '-', token1_symbol) as pair_symbol
FROM `bitcoin`.`pairs_recently_created`
  
  ...
[0m16:36:37.307618 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m16:36:37.317944 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pairs_recently_created (execute): 16:36:37.001986 => 16:36:37.316979
[0m16:36:37.320985 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92046a0d0>]}
[0m16:36:37.323635 [info ] [Thread-1  ]: 3 of 10 OK created sql table model `bitcoin_bitcoin_derived`.`pairs_recently_created`  [[32mOK[0m in 0.34s]
[0m16:36:37.326873 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.pairs_recently_created
[0m16:36:37.329492 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.pool_concentration
[0m16:36:37.331783 [info ] [Thread-1  ]: 4 of 10 START sql view model `bitcoin`.`pool_concentration` .................... [RUN]
[0m16:36:37.333968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.pairs_recently_created, now model.bitcoin_etl.pool_concentration)
[0m16:36:37.335312 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.pool_concentration
[0m16:36:37.345845 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.pool_concentration"
[0m16:36:37.348702 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pool_concentration (compile): 16:36:37.336169 => 16:36:37.347922
[0m16:36:37.350202 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.pool_concentration
[0m16:36:37.362449 [debug] [Thread-1  ]: Creating new relation pool_concentration
[0m16:36:37.367998 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.pool_concentration"
[0m16:36:37.371672 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pool_concentration: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pool_concentration"} */


  create view `bitcoin`.`pool_concentration` 
  
    
    
  as (
    

SELECT
  pair_token0_symbol || '-' || pair_token1_symbol AS pair_name,
  liquidity_token_balance,
  liquidity_token_balance / SUM(liquidity_token_balance) OVER () AS overall_share_pct,
  CASE
    WHEN liquidity_token_balance > 1000 THEN 'Whale'
    WHEN liquidity_token_balance > 100 THEN 'Dolphin'
    ELSE 'Minnow'
  END AS provider_size
FROM `bitcoin`.`liquidity_positions_largest`
ORDER BY liquidity_token_balance DESC
  )...
[0m16:36:37.402466 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m16:36:37.410096 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pool_concentration (execute): 16:36:37.351047 => 16:36:37.409384
[0m16:36:37.412499 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92046a0d0>]}
[0m16:36:37.414480 [info ] [Thread-1  ]: 4 of 10 OK created sql view model `bitcoin`.`pool_concentration` ............... [[32mOK[0m in 0.08s]
[0m16:36:37.416820 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.pool_concentration
[0m16:36:37.418523 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.raw_transactions
[0m16:36:37.420269 [info ] [Thread-1  ]: 5 of 10 START sql view model `bitcoin`.`raw_transactions` ...................... [RUN]
[0m16:36:37.423350 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.pool_concentration, now model.bitcoin_etl.raw_transactions)
[0m16:36:37.425565 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.raw_transactions
[0m16:36:37.437397 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.raw_transactions"
[0m16:36:37.441834 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.raw_transactions (compile): 16:36:37.426943 => 16:36:37.440710
[0m16:36:37.443824 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.raw_transactions
[0m16:36:37.455473 [debug] [Thread-1  ]: Creating new relation raw_transactions
[0m16:36:37.464843 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.raw_transactions"
[0m16:36:37.469939 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.raw_transactions: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.raw_transactions"} */


  create view `bitcoin`.`raw_transactions` 
  
    
    
  as (
    

SELECT 
    transaction_id AS tx_hash,
    transaction_timestamp AS timestamp,
    amount_u_s_d AS value_usd,
    pair_token0_symbol || '/' || pair_token1_symbol AS trading_pair
FROM `bitcoin`.`swaps_latest`
LIMIT 1000
  )...
[0m16:36:37.489352 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m16:36:37.496516 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.raw_transactions (execute): 16:36:37.445002 => 16:36:37.495859
[0m16:36:37.498919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff921553640>]}
[0m16:36:37.501103 [info ] [Thread-1  ]: 5 of 10 OK created sql view model `bitcoin`.`raw_transactions` ................. [[32mOK[0m in 0.08s]
[0m16:36:37.503665 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.raw_transactions
[0m16:36:37.505592 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.swaps_latest_for_pair
[0m16:36:37.508944 [info ] [Thread-1  ]: 6 of 10 START sql view model `bitcoin_bitcoin_derived`.`swaps_latest_for_pair` . [RUN]
[0m16:36:37.513245 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.raw_transactions, now model.bitcoin_etl.swaps_latest_for_pair)
[0m16:36:37.516017 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.swaps_latest_for_pair
[0m16:36:37.530238 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.swaps_latest_for_pair"
[0m16:36:37.535784 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.swaps_latest_for_pair (compile): 16:36:37.517555 => 16:36:37.534433
[0m16:36:37.537428 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.swaps_latest_for_pair
[0m16:36:37.547310 [debug] [Thread-1  ]: Creating new relation swaps_latest_for_pair
[0m16:36:37.555591 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.swaps_latest_for_pair"
[0m16:36:37.559794 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.swaps_latest_for_pair: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.swaps_latest_for_pair"} */


  create view `bitcoin_bitcoin_derived`.`swaps_latest_for_pair` 
  
    
    
  as (
    

SELECT
    id as swap_id,
    transaction_id,
    parseDateTimeBestEffort(transaction_timestamp) as transaction_timestamp,
    pair_token0_symbol,
    pair_token1_symbol,
    amount0_in,
    amount1_in,
    amount0_out,
    amount1_out,
    amount_u_s_d as amount_usd,
    -- Calculate derived metrics
    concat(pair_token0_symbol, '-', pair_token1_symbol) as pair_symbol,
    CASE 
        WHEN amount0_in > 0 THEN pair_token0_symbol
        WHEN amount1_in > 0 THEN pair_token1_symbol
        ELSE NULL
    END as token_in_symbol,
    CASE 
        WHEN amount0_out > 0 THEN pair_token0_symbol
        WHEN amount1_out > 0 THEN pair_token1_symbol
        ELSE NULL
    END as token_out_symbol,
    -- Calculate absolute amounts
    greatest(amount0_in, amount1_in) as amount_in,
    greatest(amount0_out, amount1_out) as amount_out,
    -- Calculate swap direction
    CASE
        WHEN amount0_in > 0 AND amount1_out > 0 THEN 'token0_to_token1'
        WHEN amount1_in > 0 AND amount0_out > 0 THEN 'token1_to_token0'
        ELSE 'complex'
    END as swap_direction
FROM `bitcoin`.`swaps_latest_for_pair`
  )...
[0m16:36:37.593745 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m16:36:37.601695 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.swaps_latest_for_pair (execute): 16:36:37.538466 => 16:36:37.601058
[0m16:36:37.603977 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff920cb8730>]}
[0m16:36:37.605907 [info ] [Thread-1  ]: 6 of 10 OK created sql view model `bitcoin_bitcoin_derived`.`swaps_latest_for_pair`  [[32mOK[0m in 0.09s]
[0m16:36:37.608042 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.swaps_latest_for_pair
[0m16:36:37.609853 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.test
[0m16:36:37.612345 [info ] [Thread-1  ]: 7 of 10 START sql view model `bitcoin`.`test` .................................. [RUN]
[0m16:36:37.616048 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.swaps_latest_for_pair, now model.bitcoin_etl.test)
[0m16:36:37.618477 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.test
[0m16:36:37.628849 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.test"
[0m16:36:37.633986 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test (compile): 16:36:37.619996 => 16:36:37.633176
[0m16:36:37.635417 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.test
[0m16:36:37.643810 [debug] [Thread-1  ]: Creating new relation test
[0m16:36:37.648109 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.test"
[0m16:36:37.652047 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */


  create view `bitcoin`.`test` 
  
    
    
  as (
    SELECT 1 as test_value
  )...
[0m16:36:37.668479 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:36:37.676626 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test (execute): 16:36:37.636301 => 16:36:37.675592
[0m16:36:37.679888 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92154e850>]}
[0m16:36:37.682210 [info ] [Thread-1  ]: 7 of 10 OK created sql view model `bitcoin`.`test` ............................. [[32mOK[0m in 0.07s]
[0m16:36:37.684542 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.test
[0m16:36:37.686417 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.test_connection
[0m16:36:37.688837 [info ] [Thread-1  ]: 8 of 10 START sql view model `bitcoin_default`.`test_connection` ............... [RUN]
[0m16:36:37.692052 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.test, now model.bitcoin_etl.test_connection)
[0m16:36:37.693566 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.test_connection
[0m16:36:37.704682 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.test_connection"
[0m16:36:37.708851 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test_connection (compile): 16:36:37.694493 => 16:36:37.707709
[0m16:36:37.710827 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.test_connection
[0m16:36:37.719712 [debug] [Thread-1  ]: Creating new relation test_connection
[0m16:36:37.724737 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.test_connection"
[0m16:36:37.727628 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */


  create view `bitcoin_default`.`test_connection` 
  
    
    
  as (
    -- models/test_connection.sql


SELECT 'swaps_latest' AS table_name, 
       count() AS row_count 
FROM bitcoin.swaps_latest
  )...
[0m16:36:37.752253 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m16:36:37.760856 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test_connection (execute): 16:36:37.711953 => 16:36:37.760088
[0m16:36:37.763402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92044a610>]}
[0m16:36:37.765403 [info ] [Thread-1  ]: 8 of 10 OK created sql view model `bitcoin_default`.`test_connection` .......... [[32mOK[0m in 0.07s]
[0m16:36:37.767732 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.test_connection
[0m16:36:37.769797 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.top_10_movers_by_volume
[0m16:36:37.772409 [info ] [Thread-1  ]: 9 of 10 START sql view model `bitcoin`.`top_10_movers_by_volume` ............... [RUN]
[0m16:36:37.775334 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.test_connection, now model.bitcoin_etl.top_10_movers_by_volume)
[0m16:36:37.777069 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.top_10_movers_by_volume
[0m16:36:37.793192 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.top_10_movers_by_volume"
[0m16:36:37.798149 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_10_movers_by_volume (compile): 16:36:37.778137 => 16:36:37.797049
[0m16:36:37.800332 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.top_10_movers_by_volume
[0m16:36:37.811993 [debug] [Thread-1  ]: Creating new relation top_10_movers_by_volume
[0m16:36:37.817922 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.top_10_movers_by_volume"
[0m16:36:37.823444 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */


  create view `bitcoin`.`top_10_movers_by_volume` 
  
    
    
  as (
    

WITH volume_calculations AS (
  SELECT
    from_address AS address,
    -wbtc_amount AS volume -- Negative for outflows
  FROM `bitcoin`.`erc20_transfers_wbtc`
  
  UNION ALL
  
  SELECT
    to_address AS address,
    wbtc_amount AS volume -- Positive for inflows
  FROM `bitcoin`.`erc20_transfers_wbtc`
),

net_volume AS (
  SELECT
    address,
    SUM(volume) AS net_volume,
    SUM(CASE WHEN volume > 0 THEN volume ELSE 0 END) AS total_inflow,
    SUM(CASE WHEN volume < 0 THEN ABS(volume) ELSE 0 END) AS total_outflow,
    COUNT(*) AS transaction_count
  FROM volume_calculations
  GROUP BY address
),

ranked_volumes AS (
  SELECT
    address,
    net_volume,
    total_inflow,
    total_outflow,
    transaction_count,
    RANK() OVER (ORDER BY ABS(net_volume) DESC) AS volume_rank
  FROM net_volume
)

SELECT
  address,
  net_volume,
  total_inflow,
  total_outflow,
  transaction_count,
  volume_rank
FROM ranked_volumes
WHERE volume_rank <= 10
ORDER BY volume_rank
  )...
[0m16:36:37.861628 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m16:36:37.869462 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_10_movers_by_volume (execute): 16:36:37.802655 => 16:36:37.868716
[0m16:36:37.872272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92046a040>]}
[0m16:36:37.874490 [info ] [Thread-1  ]: 9 of 10 OK created sql view model `bitcoin`.`top_10_movers_by_volume` .......... [[32mOK[0m in 0.10s]
[0m16:36:37.876707 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.top_10_movers_by_volume
[0m16:36:37.878510 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.top_liquidity_providers
[0m16:36:37.881173 [info ] [Thread-1  ]: 10 of 10 START sql view model `bitcoin`.`top_liquidity_providers` .............. [RUN]
[0m16:36:37.883784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.top_10_movers_by_volume, now model.bitcoin_etl.top_liquidity_providers)
[0m16:36:37.885284 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.top_liquidity_providers
[0m16:36:37.897526 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.top_liquidity_providers"
[0m16:36:37.900064 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_liquidity_providers (compile): 16:36:37.886141 => 16:36:37.899268
[0m16:36:37.901691 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.top_liquidity_providers
[0m16:36:37.910962 [debug] [Thread-1  ]: Creating new relation top_liquidity_providers
[0m16:36:37.916513 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.top_liquidity_providers"
[0m16:36:37.920951 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_liquidity_providers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_liquidity_providers"} */


  create view `bitcoin`.`top_liquidity_providers` 
  
    
    
  as (
    

WITH pool_stats AS (
  SELECT
    pair_id,
    pair_token0_symbol || '-' || pair_token1_symbol AS pair_name,
    COUNT(DISTINCT user_id) AS unique_providers,
    SUM(liquidity_token_balance) AS total_liquidity
  FROM `bitcoin`.`liquidity_positions_largest`
  GROUP BY 1, 2
),

provider_rankings AS (
  SELECT
    user_id,
    pair_id,
    pair_token0_symbol || '-' || pair_token1_symbol AS pair_name,
    liquidity_token_balance,
    liquidity_token_balance / SUM(liquidity_token_balance) OVER (PARTITION BY pair_id) AS pool_share_pct,
    RANK() OVER (PARTITION BY pair_id ORDER BY liquidity_token_balance DESC) AS provider_rank
  FROM `bitcoin`.`liquidity_positions_largest`
)

SELECT
  p.user_id,
  p.pair_id,
  p.pair_name,
  p.liquidity_token_balance,
  p.pool_share_pct,
  p.provider_rank,
  s.total_liquidity,
  s.unique_providers
FROM provider_rankings p
JOIN pool_stats s ON p.pair_id = s.pair_id
WHERE p.provider_rank <= 10  -- Top 10 providers per pool
ORDER BY p.pair_id, p.provider_rank
  )...
[0m16:36:37.943800 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m16:36:37.950714 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_liquidity_providers (execute): 16:36:37.902678 => 16:36:37.950042
[0m16:36:37.952889 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3b0406-674e-471e-a7a1-0efa375c53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9215c89a0>]}
[0m16:36:37.954759 [info ] [Thread-1  ]: 10 of 10 OK created sql view model `bitcoin`.`top_liquidity_providers` ......... [[32mOK[0m in 0.07s]
[0m16:36:37.956760 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.top_liquidity_providers
[0m16:36:37.962662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:37.964214 [debug] [MainThread]: Connection 'create__bitcoin_default' was left open.
[0m16:36:37.965785 [debug] [MainThread]: On create__bitcoin_default: Close
[0m16:36:37.967194 [debug] [MainThread]: Connection 'model.bitcoin_etl.top_liquidity_providers' was left open.
[0m16:36:37.968548 [debug] [MainThread]: On model.bitcoin_etl.top_liquidity_providers: Close
[0m16:36:37.970056 [info ] [MainThread]: 
[0m16:36:37.971364 [info ] [MainThread]: Finished running 9 view models, 1 table model in 0 hours 0 minutes and 9.35 seconds (9.35s).
[0m16:36:37.977875 [debug] [MainThread]: Command end result
[0m16:36:38.014929 [info ] [MainThread]: 
[0m16:36:38.016517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:38.018173 [info ] [MainThread]: 
[0m16:36:38.020018 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:36:38.024036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.94099, "process_user_time": 16.317408, "process_kernel_time": 4.421161, "process_mem_max_rss": "219372", "process_in_blocks": "984", "process_out_blocks": "2424"}
[0m16:36:38.026773 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:38.026180 after 16.94 seconds
[0m16:36:38.028660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94ee1a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94ca48070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94c9b8100>]}
[0m16:36:38.030453 [debug] [MainThread]: Flushing usage events
[0m11:09:35.294144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e8550b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e8a51c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e63864c0>]}


============================== 11:09:35.321217 | eb5cacbd-71e2-47c6-949b-35e7826a4705 ==============================
[0m11:09:35.321217 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:09:35.323241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:09:35.325428 [info ] [MainThread]: dbt version: 1.7.11
[0m11:09:35.327008 [info ] [MainThread]: python version: 3.9.18
[0m11:09:35.328321 [info ] [MainThread]: python path: /usr/local/bin/python
[0m11:09:35.329937 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m11:09:35.727119 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m11:09:35.728736 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m11:09:35.730099 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m11:09:35.732573 [info ] [MainThread]: adapter type: clickhouse
[0m11:09:35.734773 [info ] [MainThread]: adapter version: 1.7.0
[0m11:09:35.988610 [info ] [MainThread]: Configuration:
[0m11:09:35.991524 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:09:35.994485 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:09:35.996933 [info ] [MainThread]: Required dependencies:
[0m11:09:35.999393 [debug] [MainThread]: Executing "git --help"
[0m11:09:36.060501 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:09:36.064435 [debug] [MainThread]: STDERR: "b''"
[0m11:09:36.066925 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:09:36.069273 [info ] [MainThread]: Connection:
[0m11:09:36.072822 [info ] [MainThread]:   driver: None
[0m11:09:36.074604 [info ] [MainThread]:   host: clickhouse
[0m11:09:36.077018 [info ] [MainThread]:   port: 8123
[0m11:09:36.079229 [info ] [MainThread]:   user: admin
[0m11:09:36.081765 [info ] [MainThread]:   schema: bitcoin
[0m11:09:36.083889 [info ] [MainThread]:   retries: 1
[0m11:09:36.086064 [info ] [MainThread]:   database_engine: None
[0m11:09:36.088018 [info ] [MainThread]:   cluster_mode: False
[0m11:09:36.090448 [info ] [MainThread]:   secure: False
[0m11:09:36.092715 [info ] [MainThread]:   verify: True
[0m11:09:36.094725 [info ] [MainThread]:   connect_timeout: 10
[0m11:09:36.096703 [info ] [MainThread]:   send_receive_timeout: 300
[0m11:09:36.098609 [info ] [MainThread]:   sync_request_timeout: 5
[0m11:09:36.100580 [info ] [MainThread]:   compress_block_size: 1048576
[0m11:09:36.102961 [info ] [MainThread]:   compression: 
[0m11:09:36.104754 [info ] [MainThread]:   check_exchange: True
[0m11:09:36.106246 [info ] [MainThread]:   custom_settings: None
[0m11:09:36.107814 [info ] [MainThread]:   use_lw_deletes: False
[0m11:09:36.109585 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m11:09:36.112576 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m11:09:36.116234 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m11:09:36.118487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:09:38.386297 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m11:09:38.398394 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:09:38.401967 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:09:38.403877 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:09:38.410543 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.2774925, "process_user_time": 13.681629, "process_kernel_time": 6.832587, "process_mem_max_rss": "219400", "process_in_blocks": "736", "process_out_blocks": "24"}
[0m11:09:38.413923 [debug] [MainThread]: Command `dbt debug` succeeded at 11:09:38.412898 after 3.28 seconds
[0m11:09:38.416433 [debug] [MainThread]: Connection 'debug' was left open.
[0m11:09:38.418436 [debug] [MainThread]: On debug: Close
[0m11:09:38.420576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e8550b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e600c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7ea0b45b0>]}
[0m11:09:38.422576 [debug] [MainThread]: Flushing usage events
[0m11:09:52.832118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491b342b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4919178fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4919178340>]}


============================== 11:09:52.862042 | 92cde274-d953-4a99-9e32-008e8c26068c ==============================
[0m11:09:52.862042 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:09:52.864533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:09:54.303205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49190a9f10>]}
[0m11:09:54.648142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4919004b20>]}
[0m11:09:54.651399 [info ] [MainThread]: Registered adapter: clickhouse=1.7.0
[0m11:09:54.688378 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m11:09:54.774620 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:09:54.776919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4919065040>]}
[0m11:10:03.881083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490b1130d0>]}
[0m11:10:04.076985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4918f90e80>]}
[0m11:10:04.079753 [info ] [MainThread]: Found 10 models, 20 tests, 5 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m11:10:04.081858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4918e4de50>]}
[0m11:10:04.095831 [info ] [MainThread]: 
[0m11:10:04.102142 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:10:04.122903 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m11:10:04.207542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:06.181763 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:10:06.195973 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:06.214190 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:10:06.227443 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:06.251118 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:10:06.267288 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:06.280420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__bitcoin_bitcoin_derived)
[0m11:10:06.314244 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_bitcoin_derived: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_bitcoin_derived"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_bitcoin_derived'
      

  ...
[0m11:10:06.546138 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.23 seconds
[0m11:10:06.557257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_bitcoin_derived, now list__bitcoin_default)
[0m11:10:06.575298 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin_default: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin_default"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin_default'
      

  ...
[0m11:10:06.641731 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:10:06.651820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__bitcoin_default, now list__bitcoin)
[0m11:10:06.670656 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bitcoin: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "connection_name": "list__bitcoin"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bitcoin'
      

  ...
[0m11:10:06.738147 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:10:06.777120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4918e4deb0>]}
[0m11:10:06.781254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:10:06.783421 [info ] [MainThread]: 
[0m11:10:06.819547 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.example
[0m11:10:06.822635 [info ] [Thread-1  ]: 1 of 10 START sql view model `bitcoin`.`example` ............................... [RUN]
[0m11:10:06.826233 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__bitcoin, now model.bitcoin_etl.example)
[0m11:10:06.828771 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.example
[0m11:10:06.873382 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.example"
[0m11:10:06.881988 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.example (compile): 11:10:06.830137 => 11:10:06.880119
[0m11:10:06.885551 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.example
[0m11:10:07.152016 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.example"
[0m11:10:07.160497 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.example: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.example"} */


  create view `bitcoin`.`example__dbt_tmp` 
  
    
    
  as (
    

SELECT 
    transaction_id AS tx_hash,
    transaction_timestamp AS timestamp,
    pair_token0_symbol,
    pair_token1_symbol,
    amount_u_s_d AS value_usd,
    amount0_in,
    amount1_in,
    amount0_out,
    amount1_out
FROM `bitcoin`.`swaps_latest`
  )...
[0m11:10:07.199073 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:10:07.235509 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.example: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.example"} */

    drop table if exists `bitcoin`.`example__dbt_backup` 
  
  ...
[0m11:10:07.243919 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:07.250003 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.example: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.example"} */

    rename table `bitcoin`.`example` to `bitcoin`.`example__dbt_backup` 
  
  ...
[0m11:10:07.260775 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:07.278610 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.example: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.example"} */

    drop table if exists `bitcoin`.`example` 
  
  ...
[0m11:10:07.286414 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:07.293324 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.example: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.example"} */

    rename table `bitcoin`.`example__dbt_tmp` to `bitcoin`.`example` 
  
  ...
[0m11:10:07.303628 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:07.451513 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.example: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.example"} */

    drop table if exists `bitcoin`.`example__dbt_backup` 
  ...
[0m11:10:07.463966 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:07.471433 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.example (execute): 11:10:06.887598 => 11:10:07.470179
[0m11:10:07.474974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b7f6e580>]}
[0m11:10:07.479856 [info ] [Thread-1  ]: 1 of 10 OK created sql view model `bitcoin`.`example` .......................... [[32mOK[0m in 0.65s]
[0m11:10:07.484026 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.example
[0m11:10:07.487355 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.new_pairs_analysis
[0m11:10:07.491310 [info ] [Thread-1  ]: 2 of 10 START sql view model `bitcoin`.`new_pairs_analysis` .................... [RUN]
[0m11:10:07.495631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.example, now model.bitcoin_etl.new_pairs_analysis)
[0m11:10:07.498000 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.new_pairs_analysis
[0m11:10:07.519585 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.new_pairs_analysis"
[0m11:10:07.527009 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.new_pairs_analysis (compile): 11:10:07.499884 => 11:10:07.525321
[0m11:10:07.530529 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.new_pairs_analysis
[0m11:10:07.554727 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.new_pairs_analysis"
[0m11:10:07.559849 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.new_pairs_analysis: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.new_pairs_analysis"} */


  create view `bitcoin`.`new_pairs_analysis__dbt_tmp` 
  
    
    
  as (
    

WITH pair_metrics AS (
  SELECT
    id AS pair_address,
    token0_symbol || '-' || token1_symbol AS pair_name,
    parseDateTimeBestEffort(created_at_timestamp) AS creation_time,
    created_at_block_number,
    token0_id,
    token1_id,
    reserve_u_s_d,
    reserve_e_t_h,
    reserve_u_s_d / NULLIF(reserve_e_t_h, 0) AS usd_per_eth_price,
    -- Calculate hourly age of the pair
    dateDiff('hour', creation_time, now()) AS hours_since_creation
  FROM `bitcoin`.`pairs_recently_created`
)

SELECT
  pair_address,
  pair_name,
  creation_time,
  hours_since_creation,
  reserve_u_s_d AS total_liquidity_usd,
  reserve_e_t_h AS total_liquidity_eth,
  usd_per_eth_price,
  CASE
    WHEN reserve_u_s_d > 1000000 THEN 'Large'
    WHEN reserve_u_s_d > 100000 THEN 'Medium'
    ELSE 'Small'
  END AS liquidity_size,
  -- Normalize by pair age
  reserve_u_s_d / NULLIF(hours_since_creation, 0) AS hourly_liquidity_growth_usd
FROM pair_metrics
ORDER BY creation_time DESC
  )...
[0m11:10:07.604350 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:10:07.624950 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.new_pairs_analysis: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.new_pairs_analysis"} */

    drop table if exists `bitcoin`.`new_pairs_analysis__dbt_backup` 
  
  ...
[0m11:10:07.634480 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:07.640014 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.new_pairs_analysis: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.new_pairs_analysis"} */

    rename table `bitcoin`.`new_pairs_analysis` to `bitcoin`.`new_pairs_analysis__dbt_backup` 
  
  ...
[0m11:10:07.649492 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:07.667017 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.new_pairs_analysis: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.new_pairs_analysis"} */

    drop table if exists `bitcoin`.`new_pairs_analysis` 
  
  ...
[0m11:10:07.678057 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:07.684965 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.new_pairs_analysis: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.new_pairs_analysis"} */

    rename table `bitcoin`.`new_pairs_analysis__dbt_tmp` to `bitcoin`.`new_pairs_analysis` 
  
  ...
[0m11:10:07.694564 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:07.722739 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.new_pairs_analysis: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.new_pairs_analysis"} */

    drop table if exists `bitcoin`.`new_pairs_analysis__dbt_backup` 
  ...
[0m11:10:07.732011 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:07.741605 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.new_pairs_analysis (execute): 11:10:07.532157 => 11:10:07.739842
[0m11:10:07.745646 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b7f6e6a0>]}
[0m11:10:07.748604 [info ] [Thread-1  ]: 2 of 10 OK created sql view model `bitcoin`.`new_pairs_analysis` ............... [[32mOK[0m in 0.25s]
[0m11:10:07.752303 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.new_pairs_analysis
[0m11:10:07.755778 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.pairs_recently_created
[0m11:10:07.759937 [info ] [Thread-1  ]: 3 of 10 START sql table model `bitcoin_bitcoin_derived`.`pairs_recently_created`  [RUN]
[0m11:10:07.764521 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.new_pairs_analysis, now model.bitcoin_etl.pairs_recently_created)
[0m11:10:07.767706 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.pairs_recently_created
[0m11:10:07.789636 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.pairs_recently_created"
[0m11:10:07.799514 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pairs_recently_created (compile): 11:10:07.769683 => 11:10:07.796969
[0m11:10:07.803547 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.pairs_recently_created
[0m11:10:08.114845 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */

            

    
        create table `bitcoin_bitcoin_derived`.`pairs_recently_created__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

SELECT
    id as pair_id,
    parseDateTimeBestEffort(created_at_timestamp) as created_at_timestamp,
    created_at_block_number,
    token0_symbol,
    token0_id,
    token1_symbol,
    token1_id,
    reserve_u_s_d as total_liquidity_usd,
    reserve_e_t_h as total_liquidity_eth,
    concat(token0_symbol, '-', token1_symbol) as pair_symbol
FROM `bitcoin`.`pairs_recently_created`
          )
        ...
[0m11:10:08.207614 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.09 seconds
[0m11:10:08.267273 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */

    select name, type from system.columns where table = 'pairs_recently_created__dbt_backup'
    
      and database = 'bitcoin_bitcoin_derived'
    
    order by position
  ...
[0m11:10:08.293741 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:10:08.312940 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.pairs_recently_created"
[0m11:10:08.319549 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */

  
    
    
    
        
        insert into `bitcoin_bitcoin_derived`.`pairs_recently_created__dbt_backup`
        ("pair_id", "created_at_timestamp", "created_at_block_number", "token0_symbol", "token0_id", "token1_symbol", "token1_id", "total_liquidity_usd", "total_liquidity_eth", "pair_symbol")

SELECT
    id as pair_id,
    parseDateTimeBestEffort(created_at_timestamp) as created_at_timestamp,
    created_at_block_number,
    token0_symbol,
    token0_id,
    token1_symbol,
    token1_id,
    reserve_u_s_d as total_liquidity_usd,
    reserve_e_t_h as total_liquidity_eth,
    concat(token0_symbol, '-', token1_symbol) as pair_symbol
FROM `bitcoin`.`pairs_recently_created`
  
  ...
[0m11:10:08.363613 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:10:08.396095 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */
EXCHANGE TABLES `bitcoin_bitcoin_derived`.`pairs_recently_created__dbt_backup` AND `bitcoin_bitcoin_derived`.`pairs_recently_created` 
  
  ...
[0m11:10:08.412583 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:08.447394 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pairs_recently_created: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pairs_recently_created"} */

    drop table if exists `bitcoin_bitcoin_derived`.`pairs_recently_created__dbt_backup` 
  ...
[0m11:10:08.509698 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:10:08.529076 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pairs_recently_created (execute): 11:10:07.806817 => 11:10:08.527483
[0m11:10:08.544720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b7eaa910>]}
[0m11:10:08.551011 [info ] [Thread-1  ]: 3 of 10 OK created sql table model `bitcoin_bitcoin_derived`.`pairs_recently_created`  [[32mOK[0m in 0.78s]
[0m11:10:08.556816 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.pairs_recently_created
[0m11:10:08.560991 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.pool_concentration
[0m11:10:08.566499 [info ] [Thread-1  ]: 4 of 10 START sql view model `bitcoin`.`pool_concentration` .................... [RUN]
[0m11:10:08.577959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.pairs_recently_created, now model.bitcoin_etl.pool_concentration)
[0m11:10:08.581266 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.pool_concentration
[0m11:10:08.621151 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.pool_concentration"
[0m11:10:08.626899 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pool_concentration (compile): 11:10:08.583391 => 11:10:08.624996
[0m11:10:08.632404 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.pool_concentration
[0m11:10:08.671774 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.pool_concentration"
[0m11:10:08.680187 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pool_concentration: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pool_concentration"} */


  create view `bitcoin`.`pool_concentration__dbt_tmp` 
  
    
    
  as (
    

SELECT
  pair_token0_symbol || '-' || pair_token1_symbol AS pair_name,
  liquidity_token_balance,
  liquidity_token_balance / SUM(liquidity_token_balance) OVER () AS overall_share_pct,
  CASE
    WHEN liquidity_token_balance > 1000 THEN 'Whale'
    WHEN liquidity_token_balance > 100 THEN 'Dolphin'
    ELSE 'Minnow'
  END AS provider_size
FROM `bitcoin`.`liquidity_positions_largest`
ORDER BY liquidity_token_balance DESC
  )...
[0m11:10:08.757467 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:10:08.783288 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pool_concentration: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pool_concentration"} */

    drop table if exists `bitcoin`.`pool_concentration__dbt_backup` 
  
  ...
[0m11:10:08.794153 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:08.799712 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pool_concentration: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pool_concentration"} */

    rename table `bitcoin`.`pool_concentration` to `bitcoin`.`pool_concentration__dbt_backup` 
  
  ...
[0m11:10:08.809776 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:08.831900 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pool_concentration: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pool_concentration"} */

    drop table if exists `bitcoin`.`pool_concentration` 
  
  ...
[0m11:10:08.840936 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:08.846543 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pool_concentration: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pool_concentration"} */

    rename table `bitcoin`.`pool_concentration__dbt_tmp` to `bitcoin`.`pool_concentration` 
  
  ...
[0m11:10:08.856554 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:08.881403 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.pool_concentration: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.pool_concentration"} */

    drop table if exists `bitcoin`.`pool_concentration__dbt_backup` 
  ...
[0m11:10:08.891827 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:08.900436 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.pool_concentration (execute): 11:10:08.637855 => 11:10:08.899030
[0m11:10:08.908921 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b7eb3f40>]}
[0m11:10:08.914667 [info ] [Thread-1  ]: 4 of 10 OK created sql view model `bitcoin`.`pool_concentration` ............... [[32mOK[0m in 0.33s]
[0m11:10:08.921094 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.pool_concentration
[0m11:10:08.928372 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.raw_transactions
[0m11:10:08.932351 [info ] [Thread-1  ]: 5 of 10 START sql view model `bitcoin`.`raw_transactions` ...................... [RUN]
[0m11:10:08.938567 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.pool_concentration, now model.bitcoin_etl.raw_transactions)
[0m11:10:08.942866 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.raw_transactions
[0m11:10:08.962547 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.raw_transactions"
[0m11:10:08.971913 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.raw_transactions (compile): 11:10:08.945362 => 11:10:08.968792
[0m11:10:08.976140 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.raw_transactions
[0m11:10:09.041338 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.raw_transactions"
[0m11:10:09.052698 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.raw_transactions: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.raw_transactions"} */


  create view `bitcoin`.`raw_transactions__dbt_tmp` 
  
    
    
  as (
    

SELECT 
    transaction_id AS tx_hash,
    transaction_timestamp AS timestamp,
    amount_u_s_d AS value_usd,
    pair_token0_symbol || '/' || pair_token1_symbol AS trading_pair
FROM `bitcoin`.`swaps_latest`
LIMIT 1000
  )...
[0m11:10:09.094299 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:10:09.134742 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.raw_transactions: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.raw_transactions"} */

    drop table if exists `bitcoin`.`raw_transactions__dbt_backup` 
  
  ...
[0m11:10:09.149777 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:09.161022 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.raw_transactions: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.raw_transactions"} */

    rename table `bitcoin`.`raw_transactions` to `bitcoin`.`raw_transactions__dbt_backup` 
  
  ...
[0m11:10:09.175820 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:09.201358 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.raw_transactions: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.raw_transactions"} */

    drop table if exists `bitcoin`.`raw_transactions` 
  
  ...
[0m11:10:09.214821 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:09.224894 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.raw_transactions: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.raw_transactions"} */

    rename table `bitcoin`.`raw_transactions__dbt_tmp` to `bitcoin`.`raw_transactions` 
  
  ...
[0m11:10:09.238307 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:09.282546 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.raw_transactions: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.raw_transactions"} */

    drop table if exists `bitcoin`.`raw_transactions__dbt_backup` 
  ...
[0m11:10:09.296031 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:09.313142 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.raw_transactions (execute): 11:10:08.978843 => 11:10:09.311309
[0m11:10:09.319635 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b7f4ebe0>]}
[0m11:10:09.324731 [info ] [Thread-1  ]: 5 of 10 OK created sql view model `bitcoin`.`raw_transactions` ................. [[32mOK[0m in 0.38s]
[0m11:10:09.331499 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.raw_transactions
[0m11:10:09.336033 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.swaps_latest_for_pair
[0m11:10:09.340882 [info ] [Thread-1  ]: 6 of 10 START sql view model `bitcoin_bitcoin_derived`.`swaps_latest_for_pair` . [RUN]
[0m11:10:09.347429 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.raw_transactions, now model.bitcoin_etl.swaps_latest_for_pair)
[0m11:10:09.351257 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.swaps_latest_for_pair
[0m11:10:09.386399 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.swaps_latest_for_pair"
[0m11:10:09.397423 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.swaps_latest_for_pair (compile): 11:10:09.353085 => 11:10:09.394914
[0m11:10:09.402261 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.swaps_latest_for_pair
[0m11:10:09.446913 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.swaps_latest_for_pair"
[0m11:10:09.453437 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.swaps_latest_for_pair: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.swaps_latest_for_pair"} */


  create view `bitcoin_bitcoin_derived`.`swaps_latest_for_pair__dbt_tmp` 
  
    
    
  as (
    

SELECT
    id as swap_id,
    transaction_id,
    parseDateTimeBestEffort(transaction_timestamp) as transaction_timestamp,
    pair_token0_symbol,
    pair_token1_symbol,
    amount0_in,
    amount1_in,
    amount0_out,
    amount1_out,
    amount_u_s_d as amount_usd,
    -- Calculate derived metrics
    concat(pair_token0_symbol, '-', pair_token1_symbol) as pair_symbol,
    CASE 
        WHEN amount0_in > 0 THEN pair_token0_symbol
        WHEN amount1_in > 0 THEN pair_token1_symbol
        ELSE NULL
    END as token_in_symbol,
    CASE 
        WHEN amount0_out > 0 THEN pair_token0_symbol
        WHEN amount1_out > 0 THEN pair_token1_symbol
        ELSE NULL
    END as token_out_symbol,
    -- Calculate absolute amounts
    greatest(amount0_in, amount1_in) as amount_in,
    greatest(amount0_out, amount1_out) as amount_out,
    -- Calculate swap direction
    CASE
        WHEN amount0_in > 0 AND amount1_out > 0 THEN 'token0_to_token1'
        WHEN amount1_in > 0 AND amount0_out > 0 THEN 'token1_to_token0'
        ELSE 'complex'
    END as swap_direction
FROM `bitcoin`.`swaps_latest_for_pair`
  )...
[0m11:10:09.518691 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:10:09.549489 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.swaps_latest_for_pair: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.swaps_latest_for_pair"} */

    drop table if exists `bitcoin_bitcoin_derived`.`swaps_latest_for_pair__dbt_backup` 
  
  ...
[0m11:10:09.572357 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:10:09.588622 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.swaps_latest_for_pair: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.swaps_latest_for_pair"} */

    rename table `bitcoin_bitcoin_derived`.`swaps_latest_for_pair` to `bitcoin_bitcoin_derived`.`swaps_latest_for_pair__dbt_backup` 
  
  ...
[0m11:10:09.614198 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:09.648800 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.swaps_latest_for_pair: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.swaps_latest_for_pair"} */

    drop table if exists `bitcoin_bitcoin_derived`.`swaps_latest_for_pair` 
  
  ...
[0m11:10:09.665532 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:09.683932 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.swaps_latest_for_pair: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.swaps_latest_for_pair"} */

    rename table `bitcoin_bitcoin_derived`.`swaps_latest_for_pair__dbt_tmp` to `bitcoin_bitcoin_derived`.`swaps_latest_for_pair` 
  
  ...
[0m11:10:09.705187 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:10:09.748117 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.swaps_latest_for_pair: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.swaps_latest_for_pair"} */

    drop table if exists `bitcoin_bitcoin_derived`.`swaps_latest_for_pair__dbt_backup` 
  ...
[0m11:10:09.764257 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:09.778883 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.swaps_latest_for_pair (execute): 11:10:09.405575 => 11:10:09.775984
[0m11:10:09.786801 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b6616fd0>]}
[0m11:10:09.794318 [info ] [Thread-1  ]: 6 of 10 OK created sql view model `bitcoin_bitcoin_derived`.`swaps_latest_for_pair`  [[32mOK[0m in 0.44s]
[0m11:10:09.801712 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.swaps_latest_for_pair
[0m11:10:09.805967 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.test
[0m11:10:09.812897 [info ] [Thread-1  ]: 7 of 10 START sql view model `bitcoin`.`test` .................................. [RUN]
[0m11:10:09.821425 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.swaps_latest_for_pair, now model.bitcoin_etl.test)
[0m11:10:09.826224 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.test
[0m11:10:09.846793 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.test"
[0m11:10:09.853844 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test (compile): 11:10:09.828522 => 11:10:09.852456
[0m11:10:09.856708 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.test
[0m11:10:09.895594 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.test"
[0m11:10:09.901890 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */


  create view `bitcoin`.`test__dbt_tmp` 
  
    
    
  as (
    SELECT 1 as test_value
  )...
[0m11:10:09.930660 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:10:09.958426 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */

    drop table if exists `bitcoin`.`test__dbt_backup` 
  
  ...
[0m11:10:09.974084 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:09.994512 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */

    rename table `bitcoin`.`test` to `bitcoin`.`test__dbt_backup` 
  
  ...
[0m11:10:10.035214 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.076696 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */

    drop table if exists `bitcoin`.`test` 
  
  ...
[0m11:10:10.091381 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.106688 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */

    rename table `bitcoin`.`test__dbt_tmp` to `bitcoin`.`test` 
  
  ...
[0m11:10:10.119321 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.161863 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test"} */

    drop table if exists `bitcoin`.`test__dbt_backup` 
  ...
[0m11:10:10.176518 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.189875 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test (execute): 11:10:09.858934 => 11:10:10.187121
[0m11:10:10.197199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b7e85c40>]}
[0m11:10:10.201943 [info ] [Thread-1  ]: 7 of 10 OK created sql view model `bitcoin`.`test` ............................. [[32mOK[0m in 0.38s]
[0m11:10:10.207982 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.test
[0m11:10:10.211495 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.test_connection
[0m11:10:10.215570 [info ] [Thread-1  ]: 8 of 10 START sql view model `bitcoin_default`.`test_connection` ............... [RUN]
[0m11:10:10.220290 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.test, now model.bitcoin_etl.test_connection)
[0m11:10:10.223716 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.test_connection
[0m11:10:10.242227 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.test_connection"
[0m11:10:10.247863 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test_connection (compile): 11:10:10.225518 => 11:10:10.246324
[0m11:10:10.250804 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.test_connection
[0m11:10:10.278409 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.test_connection"
[0m11:10:10.282586 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */


  create view `bitcoin_default`.`test_connection__dbt_tmp` 
  
    
    
  as (
    -- models/test_connection.sql


SELECT 'swaps_latest' AS table_name, 
       count() AS row_count 
FROM bitcoin.swaps_latest
  )...
[0m11:10:10.310394 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:10:10.332135 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */

    drop table if exists `bitcoin_default`.`test_connection__dbt_backup` 
  
  ...
[0m11:10:10.342694 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.351908 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */

    rename table `bitcoin_default`.`test_connection` to `bitcoin_default`.`test_connection__dbt_backup` 
  
  ...
[0m11:10:10.367571 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.388562 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */

    drop table if exists `bitcoin_default`.`test_connection` 
  
  ...
[0m11:10:10.397875 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.405603 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */

    rename table `bitcoin_default`.`test_connection__dbt_tmp` to `bitcoin_default`.`test_connection` 
  
  ...
[0m11:10:10.417292 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.451156 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.test_connection: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.test_connection"} */

    drop table if exists `bitcoin_default`.`test_connection__dbt_backup` 
  ...
[0m11:10:10.462712 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.469751 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.test_connection (execute): 11:10:10.253499 => 11:10:10.468667
[0m11:10:10.474833 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b7f3a040>]}
[0m11:10:10.478206 [info ] [Thread-1  ]: 8 of 10 OK created sql view model `bitcoin_default`.`test_connection` .......... [[32mOK[0m in 0.26s]
[0m11:10:10.481427 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.test_connection
[0m11:10:10.484249 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.top_10_movers_by_volume
[0m11:10:10.488245 [info ] [Thread-1  ]: 9 of 10 START sql view model `bitcoin`.`top_10_movers_by_volume` ............... [RUN]
[0m11:10:10.491897 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.test_connection, now model.bitcoin_etl.top_10_movers_by_volume)
[0m11:10:10.494647 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.top_10_movers_by_volume
[0m11:10:10.521036 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.top_10_movers_by_volume"
[0m11:10:10.526068 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_10_movers_by_volume (compile): 11:10:10.496118 => 11:10:10.524659
[0m11:10:10.528423 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.top_10_movers_by_volume
[0m11:10:10.552955 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.top_10_movers_by_volume"
[0m11:10:10.557434 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */


  create view `bitcoin`.`top_10_movers_by_volume__dbt_tmp` 
  
    
    
  as (
    

WITH volume_calculations AS (
  SELECT
    from_address AS address,
    -wbtc_amount AS volume -- Negative for outflows
  FROM `bitcoin`.`erc20_transfers_wbtc`
  
  UNION ALL
  
  SELECT
    to_address AS address,
    wbtc_amount AS volume -- Positive for inflows
  FROM `bitcoin`.`erc20_transfers_wbtc`
),

net_volume AS (
  SELECT
    address,
    SUM(volume) AS net_volume,
    SUM(CASE WHEN volume > 0 THEN volume ELSE 0 END) AS total_inflow,
    SUM(CASE WHEN volume < 0 THEN ABS(volume) ELSE 0 END) AS total_outflow,
    COUNT(*) AS transaction_count
  FROM volume_calculations
  GROUP BY address
),

ranked_volumes AS (
  SELECT
    address,
    net_volume,
    total_inflow,
    total_outflow,
    transaction_count,
    RANK() OVER (ORDER BY ABS(net_volume) DESC) AS volume_rank
  FROM net_volume
)

SELECT
  address,
  net_volume,
  total_inflow,
  total_outflow,
  transaction_count,
  volume_rank
FROM ranked_volumes
WHERE volume_rank <= 10
ORDER BY volume_rank
  )...
[0m11:10:10.592471 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m11:10:10.609191 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */

    drop table if exists `bitcoin`.`top_10_movers_by_volume__dbt_backup` 
  
  ...
[0m11:10:10.617481 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.622646 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */

    rename table `bitcoin`.`top_10_movers_by_volume` to `bitcoin`.`top_10_movers_by_volume__dbt_backup` 
  
  ...
[0m11:10:10.632829 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.655919 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */

    drop table if exists `bitcoin`.`top_10_movers_by_volume` 
  
  ...
[0m11:10:10.666096 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.672182 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */

    rename table `bitcoin`.`top_10_movers_by_volume__dbt_tmp` to `bitcoin`.`top_10_movers_by_volume` 
  
  ...
[0m11:10:10.683370 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.712209 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_10_movers_by_volume: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_10_movers_by_volume"} */

    drop table if exists `bitcoin`.`top_10_movers_by_volume__dbt_backup` 
  ...
[0m11:10:10.722363 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.731805 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_10_movers_by_volume (execute): 11:10:10.529819 => 11:10:10.730759
[0m11:10:10.736276 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b6580d90>]}
[0m11:10:10.740857 [info ] [Thread-1  ]: 9 of 10 OK created sql view model `bitcoin`.`top_10_movers_by_volume` .......... [[32mOK[0m in 0.25s]
[0m11:10:10.745104 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.top_10_movers_by_volume
[0m11:10:10.748432 [debug] [Thread-1  ]: Began running node model.bitcoin_etl.top_liquidity_providers
[0m11:10:10.752262 [info ] [Thread-1  ]: 10 of 10 START sql view model `bitcoin`.`top_liquidity_providers` .............. [RUN]
[0m11:10:10.757330 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bitcoin_etl.top_10_movers_by_volume, now model.bitcoin_etl.top_liquidity_providers)
[0m11:10:10.760623 [debug] [Thread-1  ]: Began compiling node model.bitcoin_etl.top_liquidity_providers
[0m11:10:10.778674 [debug] [Thread-1  ]: Writing injected SQL for node "model.bitcoin_etl.top_liquidity_providers"
[0m11:10:10.783962 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_liquidity_providers (compile): 11:10:10.762318 => 11:10:10.782367
[0m11:10:10.786586 [debug] [Thread-1  ]: Began executing node model.bitcoin_etl.top_liquidity_providers
[0m11:10:10.815649 [debug] [Thread-1  ]: Writing runtime sql for node "model.bitcoin_etl.top_liquidity_providers"
[0m11:10:10.821611 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_liquidity_providers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_liquidity_providers"} */


  create view `bitcoin`.`top_liquidity_providers__dbt_tmp` 
  
    
    
  as (
    

WITH pool_stats AS (
  SELECT
    pair_id,
    pair_token0_symbol || '-' || pair_token1_symbol AS pair_name,
    COUNT(DISTINCT user_id) AS unique_providers,
    SUM(liquidity_token_balance) AS total_liquidity
  FROM `bitcoin`.`liquidity_positions_largest`
  GROUP BY 1, 2
),

provider_rankings AS (
  SELECT
    user_id,
    pair_id,
    pair_token0_symbol || '-' || pair_token1_symbol AS pair_name,
    liquidity_token_balance,
    liquidity_token_balance / SUM(liquidity_token_balance) OVER (PARTITION BY pair_id) AS pool_share_pct,
    RANK() OVER (PARTITION BY pair_id ORDER BY liquidity_token_balance DESC) AS provider_rank
  FROM `bitcoin`.`liquidity_positions_largest`
)

SELECT
  p.user_id,
  p.pair_id,
  p.pair_name,
  p.liquidity_token_balance,
  p.pool_share_pct,
  p.provider_rank,
  s.total_liquidity,
  s.unique_providers
FROM provider_rankings p
JOIN pool_stats s ON p.pair_id = s.pair_id
WHERE p.provider_rank <= 10  -- Top 10 providers per pool
ORDER BY p.pair_id, p.provider_rank
  )...
[0m11:10:10.854093 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m11:10:10.877633 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_liquidity_providers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_liquidity_providers"} */

    drop table if exists `bitcoin`.`top_liquidity_providers__dbt_backup` 
  
  ...
[0m11:10:10.886697 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.894703 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_liquidity_providers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_liquidity_providers"} */

    rename table `bitcoin`.`top_liquidity_providers` to `bitcoin`.`top_liquidity_providers__dbt_backup` 
  
  ...
[0m11:10:10.905313 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.922643 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_liquidity_providers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_liquidity_providers"} */

    drop table if exists `bitcoin`.`top_liquidity_providers` 
  
  ...
[0m11:10:10.932636 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.940462 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_liquidity_providers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_liquidity_providers"} */

    rename table `bitcoin`.`top_liquidity_providers__dbt_tmp` to `bitcoin`.`top_liquidity_providers` 
  
  ...
[0m11:10:10.951174 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:10:10.984916 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.bitcoin_etl.top_liquidity_providers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "bitcoin_etl", "target_name": "dev", "node_id": "model.bitcoin_etl.top_liquidity_providers"} */

    drop table if exists `bitcoin`.`top_liquidity_providers__dbt_backup` 
  ...
[0m11:10:11.004958 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:10:11.025261 [debug] [Thread-1  ]: Timing info for model.bitcoin_etl.top_liquidity_providers (execute): 11:10:10.788691 => 11:10:11.023417
[0m11:10:11.038941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cde274-d953-4a99-9e32-008e8c26068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b7e85c40>]}
[0m11:10:11.043556 [info ] [Thread-1  ]: 10 of 10 OK created sql view model `bitcoin`.`top_liquidity_providers` ......... [[32mOK[0m in 0.28s]
[0m11:10:11.053487 [debug] [Thread-1  ]: Finished running node model.bitcoin_etl.top_liquidity_providers
[0m11:10:11.064179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:11.067596 [debug] [MainThread]: Connection 'model.bitcoin_etl.top_liquidity_providers' was left open.
[0m11:10:11.070753 [debug] [MainThread]: On model.bitcoin_etl.top_liquidity_providers: Close
[0m11:10:11.074673 [info ] [MainThread]: 
[0m11:10:11.078610 [info ] [MainThread]: Finished running 9 view models, 1 table model in 0 hours 0 minutes and 6.97 seconds (6.97s).
[0m11:10:11.089552 [debug] [MainThread]: Command end result
[0m11:10:11.145067 [info ] [MainThread]: 
[0m11:10:11.147601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:11.149910 [info ] [MainThread]: 
[0m11:10:11.152081 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m11:10:11.156164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.508331, "process_user_time": 28.603565, "process_kernel_time": 2.516794, "process_mem_max_rss": "222548", "process_in_blocks": "416", "process_out_blocks": "3424"}
[0m11:10:11.159018 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:11.158338 after 18.51 seconds
[0m11:10:11.161738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491b342b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b6622bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b6627d90>]}
[0m11:10:11.164555 [debug] [MainThread]: Flushing usage events
