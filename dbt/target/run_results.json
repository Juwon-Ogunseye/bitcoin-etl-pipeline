{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.11", "generated_at": "2025-04-18T16:36:37.972356Z", "invocation_id": "0d3b0406-674e-471e-a7a1-0efa375c53a6", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T16:36:35.736018Z", "completed_at": "2025-04-18T16:36:35.879380Z"}, {"name": "execute", "started_at": "2025-04-18T16:36:35.882636Z", "completed_at": "2025-04-18T16:36:36.853264Z"}], "thread_id": "Thread-1", "execution_time": 1.1237883567810059, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.bitcoin_etl.example", "compiled": true, "compiled_code": "\n\nSELECT \n    transaction_id AS tx_hash,\n    transaction_timestamp AS timestamp,\n    pair_token0_symbol,\n    pair_token1_symbol,\n    amount_u_s_d AS value_usd,\n    amount0_in,\n    amount1_in,\n    amount0_out,\n    amount1_out\nFROM `bitcoin`.`swaps_latest`", "relation_name": "`bitcoin`.`example`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T16:36:36.871220Z", "completed_at": "2025-04-18T16:36:36.887131Z"}, {"name": "execute", "started_at": "2025-04-18T16:36:36.891797Z", "completed_at": "2025-04-18T16:36:36.962717Z"}], "thread_id": "Thread-1", "execution_time": 0.09823846817016602, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.bitcoin_etl.new_pairs_analysis", "compiled": true, "compiled_code": "\n\nWITH pair_metrics AS (\n  SELECT\n    id AS pair_address,\n    token0_symbol || '-' || token1_symbol AS pair_name,\n    parseDateTimeBestEffort(created_at_timestamp) AS creation_time,\n    created_at_block_number,\n    token0_id,\n    token1_id,\n    reserve_u_s_d,\n    reserve_e_t_h,\n    reserve_u_s_d / NULLIF(reserve_e_t_h, 0) AS usd_per_eth_price,\n    -- Calculate hourly age of the pair\n    dateDiff('hour', creation_time, now()) AS hours_since_creation\n  FROM `bitcoin`.`pairs_recently_created`\n)\n\nSELECT\n  pair_address,\n  pair_name,\n  creation_time,\n  hours_since_creation,\n  reserve_u_s_d AS total_liquidity_usd,\n  reserve_e_t_h AS total_liquidity_eth,\n  usd_per_eth_price,\n  CASE\n    WHEN reserve_u_s_d > 1000000 THEN 'Large'\n    WHEN reserve_u_s_d > 100000 THEN 'Medium'\n    ELSE 'Small'\n  END AS liquidity_size,\n  -- Normalize by pair age\n  reserve_u_s_d / NULLIF(hours_since_creation, 0) AS hourly_liquidity_growth_usd\nFROM pair_metrics\nORDER BY creation_time DESC", "relation_name": "`bitcoin`.`new_pairs_analysis`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T16:36:36.980845Z", "completed_at": "2025-04-18T16:36:36.997173Z"}, {"name": "execute", "started_at": "2025-04-18T16:36:37.001986Z", "completed_at": "2025-04-18T16:36:37.316979Z"}], "thread_id": "Thread-1", "execution_time": 0.34346818923950195, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.bitcoin_etl.pairs_recently_created", "compiled": true, "compiled_code": "\n\nSELECT\n    id as pair_id,\n    parseDateTimeBestEffort(created_at_timestamp) as created_at_timestamp,\n    created_at_block_number,\n    token0_symbol,\n    token0_id,\n    token1_symbol,\n    token1_id,\n    reserve_u_s_d as total_liquidity_usd,\n    reserve_e_t_h as total_liquidity_eth,\n    concat(token0_symbol, '-', token1_symbol) as pair_symbol\nFROM `bitcoin`.`pairs_recently_created`", "relation_name": "`bitcoin_bitcoin_derived`.`pairs_recently_created`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T16:36:37.336169Z", "completed_at": "2025-04-18T16:36:37.347922Z"}, {"name": "execute", "started_at": "2025-04-18T16:36:37.351047Z", "completed_at": "2025-04-18T16:36:37.409384Z"}], "thread_id": "Thread-1", "execution_time": 0.07907819747924805, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.bitcoin_etl.pool_concentration", "compiled": true, "compiled_code": "\n\nSELECT\n  pair_token0_symbol || '-' || pair_token1_symbol AS pair_name,\n  liquidity_token_balance,\n  liquidity_token_balance / SUM(liquidity_token_balance) OVER () AS overall_share_pct,\n  CASE\n    WHEN liquidity_token_balance > 1000 THEN 'Whale'\n    WHEN liquidity_token_balance > 100 THEN 'Dolphin'\n    ELSE 'Minnow'\n  END AS provider_size\nFROM `bitcoin`.`liquidity_positions_largest`\nORDER BY liquidity_token_balance DESC", "relation_name": "`bitcoin`.`pool_concentration`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T16:36:37.426943Z", "completed_at": "2025-04-18T16:36:37.440710Z"}, {"name": "execute", "started_at": "2025-04-18T16:36:37.445002Z", "completed_at": "2025-04-18T16:36:37.495859Z"}], "thread_id": "Thread-1", "execution_time": 0.07678842544555664, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.bitcoin_etl.raw_transactions", "compiled": true, "compiled_code": "\n\nSELECT \n    transaction_id AS tx_hash,\n    transaction_timestamp AS timestamp,\n    amount_u_s_d AS value_usd,\n    pair_token0_symbol || '/' || pair_token1_symbol AS trading_pair\nFROM `bitcoin`.`swaps_latest`\nLIMIT 1000", "relation_name": "`bitcoin`.`raw_transactions`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T16:36:37.517555Z", "completed_at": "2025-04-18T16:36:37.534433Z"}, {"name": "execute", "started_at": "2025-04-18T16:36:37.538466Z", "completed_at": "2025-04-18T16:36:37.601058Z"}], "thread_id": "Thread-1", "execution_time": 0.09232521057128906, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.bitcoin_etl.swaps_latest_for_pair", "compiled": true, "compiled_code": "\n\nSELECT\n    id as swap_id,\n    transaction_id,\n    parseDateTimeBestEffort(transaction_timestamp) as transaction_timestamp,\n    pair_token0_symbol,\n    pair_token1_symbol,\n    amount0_in,\n    amount1_in,\n    amount0_out,\n    amount1_out,\n    amount_u_s_d as amount_usd,\n    -- Calculate derived metrics\n    concat(pair_token0_symbol, '-', pair_token1_symbol) as pair_symbol,\n    CASE \n        WHEN amount0_in > 0 THEN pair_token0_symbol\n        WHEN amount1_in > 0 THEN pair_token1_symbol\n        ELSE NULL\n    END as token_in_symbol,\n    CASE \n        WHEN amount0_out > 0 THEN pair_token0_symbol\n        WHEN amount1_out > 0 THEN pair_token1_symbol\n        ELSE NULL\n    END as token_out_symbol,\n    -- Calculate absolute amounts\n    greatest(amount0_in, amount1_in) as amount_in,\n    greatest(amount0_out, amount1_out) as amount_out,\n    -- Calculate swap direction\n    CASE\n        WHEN amount0_in > 0 AND amount1_out > 0 THEN 'token0_to_token1'\n        WHEN amount1_in > 0 AND amount0_out > 0 THEN 'token1_to_token0'\n        ELSE 'complex'\n    END as swap_direction\nFROM `bitcoin`.`swaps_latest_for_pair`", "relation_name": "`bitcoin_bitcoin_derived`.`swaps_latest_for_pair`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T16:36:37.619996Z", "completed_at": "2025-04-18T16:36:37.633176Z"}, {"name": "execute", "started_at": "2025-04-18T16:36:37.636301Z", "completed_at": "2025-04-18T16:36:37.675592Z"}], "thread_id": "Thread-1", "execution_time": 0.0651097297668457, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.bitcoin_etl.test", "compiled": true, "compiled_code": "SELECT 1 as test_value", "relation_name": "`bitcoin`.`test`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T16:36:37.694493Z", "completed_at": "2025-04-18T16:36:37.707709Z"}, {"name": "execute", "started_at": "2025-04-18T16:36:37.711953Z", "completed_at": "2025-04-18T16:36:37.760088Z"}], "thread_id": "Thread-1", "execution_time": 0.07248830795288086, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.bitcoin_etl.test_connection", "compiled": true, "compiled_code": "-- models/test_connection.sql\n\n\nSELECT 'swaps_latest' AS table_name, \n       count() AS row_count \nFROM bitcoin.swaps_latest", "relation_name": "`bitcoin_default`.`test_connection`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T16:36:37.778137Z", "completed_at": "2025-04-18T16:36:37.797049Z"}, {"name": "execute", "started_at": "2025-04-18T16:36:37.802655Z", "completed_at": "2025-04-18T16:36:37.868716Z"}], "thread_id": "Thread-1", "execution_time": 0.09782147407531738, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.bitcoin_etl.top_10_movers_by_volume", "compiled": true, "compiled_code": "\n\nWITH volume_calculations AS (\n  SELECT\n    from_address AS address,\n    -wbtc_amount AS volume -- Negative for outflows\n  FROM `bitcoin`.`erc20_transfers_wbtc`\n  \n  UNION ALL\n  \n  SELECT\n    to_address AS address,\n    wbtc_amount AS volume -- Positive for inflows\n  FROM `bitcoin`.`erc20_transfers_wbtc`\n),\n\nnet_volume AS (\n  SELECT\n    address,\n    SUM(volume) AS net_volume,\n    SUM(CASE WHEN volume > 0 THEN volume ELSE 0 END) AS total_inflow,\n    SUM(CASE WHEN volume < 0 THEN ABS(volume) ELSE 0 END) AS total_outflow,\n    COUNT(*) AS transaction_count\n  FROM volume_calculations\n  GROUP BY address\n),\n\nranked_volumes AS (\n  SELECT\n    address,\n    net_volume,\n    total_inflow,\n    total_outflow,\n    transaction_count,\n    RANK() OVER (ORDER BY ABS(net_volume) DESC) AS volume_rank\n  FROM net_volume\n)\n\nSELECT\n  address,\n  net_volume,\n  total_inflow,\n  total_outflow,\n  transaction_count,\n  volume_rank\nFROM ranked_volumes\nWHERE volume_rank <= 10\nORDER BY volume_rank", "relation_name": "`bitcoin`.`top_10_movers_by_volume`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T16:36:37.886141Z", "completed_at": "2025-04-18T16:36:37.899268Z"}, {"name": "execute", "started_at": "2025-04-18T16:36:37.902678Z", "completed_at": "2025-04-18T16:36:37.950042Z"}], "thread_id": "Thread-1", "execution_time": 0.06978654861450195, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.bitcoin_etl.top_liquidity_providers", "compiled": true, "compiled_code": "\n\nWITH pool_stats AS (\n  SELECT\n    pair_id,\n    pair_token0_symbol || '-' || pair_token1_symbol AS pair_name,\n    COUNT(DISTINCT user_id) AS unique_providers,\n    SUM(liquidity_token_balance) AS total_liquidity\n  FROM `bitcoin`.`liquidity_positions_largest`\n  GROUP BY 1, 2\n),\n\nprovider_rankings AS (\n  SELECT\n    user_id,\n    pair_id,\n    pair_token0_symbol || '-' || pair_token1_symbol AS pair_name,\n    liquidity_token_balance,\n    liquidity_token_balance / SUM(liquidity_token_balance) OVER (PARTITION BY pair_id) AS pool_share_pct,\n    RANK() OVER (PARTITION BY pair_id ORDER BY liquidity_token_balance DESC) AS provider_rank\n  FROM `bitcoin`.`liquidity_positions_largest`\n)\n\nSELECT\n  p.user_id,\n  p.pair_id,\n  p.pair_name,\n  p.liquidity_token_balance,\n  p.pool_share_pct,\n  p.provider_rank,\n  s.total_liquidity,\n  s.unique_providers\nFROM provider_rankings p\nJOIN pool_stats s ON p.pair_id = s.pair_id\nWHERE p.provider_rank <= 10  -- Top 10 providers per pool\nORDER BY p.pair_id, p.provider_rank", "relation_name": "`bitcoin`.`top_liquidity_providers`"}], "elapsed_time": 9.35180115699768, "args": {"log_format_file": "debug", "show_resource_report": false, "indirect_selection": "eager", "partial_parse_file_diff": true, "which": "run", "log_file_max_bytes": 10485760, "cache_selected_only": false, "enable_legacy_logger": false, "favor_state": false, "log_level_file": "debug", "populate_cache": true, "project_dir": "/opt/airflow/dbt", "write_json": true, "log_format": "default", "log_level": "info", "partial_parse": true, "warn_error_options": {"include": [], "exclude": []}, "send_anonymous_usage_stats": true, "select": [], "use_colors_file": true, "vars": {}, "exclude": [], "version_check": true, "invocation_command": "dbt run --project-dir /opt/airflow/dbt", "introspect": true, "printer_width": 80, "static_parser": true, "quiet": false, "print": true, "use_colors": true, "macro_debugging": false, "strict_mode": false, "log_path": "/opt/airflow/dbt/logs", "profiles_dir": "/opt/airflow/dbt", "defer": false}}